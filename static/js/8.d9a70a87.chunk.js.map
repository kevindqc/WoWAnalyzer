{"version":3,"sources":["parser/warlock/shared/modules/talents/normalizers/GrimoireOfSacrificeNormalizer.js","parser/warlock/shared/modules/talents/GrimoireOfSacrifice.js","interface/statistics/components/BoringSpellValueText/index.tsx","parser/core/calculateEffectiveDamage.js","parser/shared/modules/resources/resourcetracker/ResourceTracker.ts","parser/shared/modules/resources/resourcetracker/ResourceBreakdown.tsx","../node_modules/react-animate-height/lib/AnimateHeight.js","interface/others/charts/OneVariableBinomialChart.js","parser/shared/modules/helpers/Probability.tsx","interface/statistics/components/Gauge.js","interface/statistics/components/UptimeBar/index.js"],"names":["GrimoireOfSacrificeNormalizer","events","firstEventIndex","this","getFightStartIndex","i","length","event","ability","guid","SPELLS","GRIMOIRE_OF_SACRIFICE_BUFF","EventType","ApplyBuff","RemoveBuff","includes","type","GRIMOIRE_OF_SACRIFICE_DAMAGE","id","Damage","fabricatedEvent","timestamp","sourceID","targetID","sourceIsFriendly","targetIsFriendly","name","abilityIcon","icon","__fabricated","unshift","EventsNormalizer","GrimoireOfSacrifice","args","active","selectedCombatant","hasTalent","GRIMOIRE_OF_SACRIFICE_TALENT","getBuffUptime","owner","fightDuration","actual","uptime","isLessThan","minor","average","major","style","when","suggestionThresholds","addSuggestion","suggest","recommended","i18n","_","formatPercentage","spell","abilityTracker","getAbility","damage","damageEffective","damageAbsorbed","dps","position","STATISTIC_ORDER","OPTIONAL","size","tooltip","formatThousands","formatNumber","getPercentageOfTotalDamageDone","Analyzer","dependencies","AbilityTracker","BoringSpellValueText","children","className","calculateEffectiveDamage","increase","raw","amount","absorbed","ResourceTracker","options","eventEmitter","current","resourceUpdates","buildersObj","spendersObj","resource","maxResource","addEventListener","Events","energize","to","SELECTED_PLAYER","onEnergize","cast","by","onCast","spellId","generated","wasted","casts","spent","spentByCast","resourceChangeType","waste","gain","resourceChange","_applyBuilder","getResource","maxGain","undefined","Math","min","max","initBuilderAbility","push","used","shouldProcessCastEvent","eventResource","cost","getReducedCost","initSpenderAbility","triggerSpendEvent","resourceCost","classResources","find","r","SpendResource","fabricateEvent","Boolean","Object","values","reduce","acc","EventEmitter","ResourceBreakdown","keys","map","abilityId","Number","sort","a","b","filter","props","tracker","showSpenders","resourceName","prepareGenerated","prepareSpent","totalGenerated","totalWasted","totalSpent","totalCasts","spendersCasts","colSpan","content","key","width","paddingRight","textAlign","toFixed","React","Component","defineProperty","exports","value","_typeof","Symbol","iterator","obj","constructor","prototype","_extends","assign","target","arguments","source","hasOwnProperty","call","_createClass","defineProperties","descriptor","enumerable","configurable","writable","Constructor","protoProps","staticProps","_react2","_interopRequireDefault","require","_propTypes2","_classnames2","__esModule","default","_defineProperty","ANIMATION_STATE_CLASSES","animating","animatingUp","animatingDown","animatingToHeightZero","animatingToHeightAuto","animatingToHeightSpecific","static","staticHeightZero","staticHeightAuto","staticHeightSpecific","PROPS_TO_OMIT","omit","_len","Array","_key","res","objectKeys","indexOf","cancelAnimationFrames","requestAnimationFrameIDs","forEach","cancelAnimationFrame","isNumber","n","isNaN","parseFloat","isFinite","isPercentage","height","search","substr","runCallback","callback","params","AnimateHeight","_React$Component","instance","TypeError","_classCallCheck","_this","self","ReferenceError","_possibleConstructorReturn","__proto__","getPrototypeOf","animationFrameIDs","overflow","animationStateClasses","getStaticStateClasses","state","shouldUseTransitions","subClass","superClass","create","setPrototypeOf","_inherits","contentElement","hideContent","prevProps","prevState","_this2","_props","delay","duration","onAnimationEnd","onAnimationStart","_cx","showContent","contentHeight","offsetHeight","totalDuration","newHeight","timeoutState","isCurrentHeightAuto","timeoutAnimationStateClasses","setState","clearTimeout","timeoutID","animationClassesTimeoutID","requestAnimationFrame","startAnimationHelper","setTimeout","display","_cx2","_cx3","_this3","_props2","animateOpacity","applyInlineTransitions","contentClassName","easing","_state","componentStyle","transition","WebkitTransition","contentStyle","opacity","componentClasses","ariaHidden","createElement","apply","concat","ref","el","propTypes","bool","object","any","isRequired","string","number","propName","componentName","func","defaultProps","OneVariableBinomialChart","hover","probabilities","actualEvent","xAxis","yAxis","yDomain","data","spec","encoding","x","field","title","axis","grid","format","tickFormat","y","scale","domain","layer","mark","color","line","strokeWidth","filled","disableHeight","BaseChart","expectedProcCount","procChance","procAttempts","binomialPMF","k","p","numerator","denominator","binomialDistribution","pow","binomialCDF","probability","findMax","pmf","maxP","resetProbabilityArray","actualProcs","from","_x","poissonBinomialPMF","setMinMaxProbabilities","threshold","procProbabilities","rangeMin","findIndex","rangeMax","slice","Ekj","j","lookup","Error","fill","plotOneVariableBinomChart","trackedName","tooltipText","actualEventY","Gauge","marginTop","render","paddingTop","fontSize","viewBox","xmlns","d","stroke","strokeLinecap","fillRule","clipRule","top","left","transform","margin","transformOrigin","paddingLeft","UptimeBar","uptimeHistory","fightStart","start","fightEnd","end","others","buff"],"mappings":"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","file":"static/js/8.d9a70a87.chunk.js","sourcesContent":["import EventsNormalizer from 'parser/core/EventsNormalizer';\r\nimport SPELLS from 'common/SPELLS';\r\nimport { EventType } from 'parser/core/Events';\r\n\r\nclass GrimoireOfSacrificeNormalizer extends EventsNormalizer {\r\n  // Grimoire of Sacrifice is an ability that you can cast before combat, and it sacrifices your pet\r\n  // You gain its active ability and gain a buff that lasts for 1 hour or until pet is summoned (or obviously when player dies)\r\n  // It's easily possible to pre-cast this before combat, and never let it drop, so the only GoSac related events are \"damage\" events, which screws up uptime calculations\r\n\r\n  // Iterate through events, when the FIRST GoSac thing we encounter is a \"damage\" event, we can assume it was precasted, so insert a fabricated \"applybuff\" event in the beginning\r\n  normalize(events) {\r\n    const firstEventIndex = this.getFightStartIndex(events);\r\n\r\n    for (let i = 0; i < events.length; i += 1) {\r\n      const event = events[i];\r\n      if (event.ability && event.ability.guid === SPELLS.GRIMOIRE_OF_SACRIFICE_BUFF && [EventType.ApplyBuff, EventType.RemoveBuff].includes(event.type)) {\r\n        // first GoSac event is applybuff or removebuff, ignore the rest, return events as they are\r\n        break;\r\n      }\r\n      if (event.ability && event.ability.guid === SPELLS.GRIMOIRE_OF_SACRIFICE_DAMAGE.id && event.type === EventType.Damage) {\r\n        // first GoSac event is damage, add the fabricated applybuff and return\r\n        const fabricatedEvent = {\r\n          timestamp: events[firstEventIndex].timestamp,\r\n          type: EventType.ApplyBuff,\r\n          sourceID: event.sourceID,\r\n          targetID: event.sourceID,\r\n          sourceIsFriendly: true,\r\n          targetIsFriendly: true,\r\n          ability: {\r\n            guid: SPELLS.GRIMOIRE_OF_SACRIFICE_BUFF.id,\r\n            name: SPELLS.GRIMOIRE_OF_SACRIFICE_BUFF.name,\r\n            abilityIcon: SPELLS.GRIMOIRE_OF_SACRIFICE_BUFF.icon,\r\n          },\r\n          __fabricated: true,\r\n        };\r\n        events.unshift(fabricatedEvent);\r\n        break;\r\n      }\r\n    }\r\n    return events;\r\n  }\r\n}\r\n\r\nexport default GrimoireOfSacrificeNormalizer;\r\n","import React from 'react';\r\n\r\nimport Analyzer from 'parser/core/Analyzer';\r\nimport AbilityTracker from 'parser/shared/modules/AbilityTracker';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport { formatPercentage, formatThousands, formatNumber } from 'common/format';\r\nimport SpellLink from 'common/SpellLink';\r\n\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport BoringSpellValueText from 'interface/statistics/components/BoringSpellValueText';\r\n\r\nimport { i18n } from '@lingui/core';\r\nimport { t } from '@lingui/macro';\r\n\r\nclass GrimoireOfSacrifice extends Analyzer {\r\n  get uptime() {\r\n    return this.selectedCombatant.getBuffUptime(SPELLS.GRIMOIRE_OF_SACRIFICE_BUFF.id) / this.owner.fightDuration;\r\n  }\r\n\r\n  get suggestionThresholds() {\r\n    return {\r\n      actual: this.uptime,\r\n      isLessThan: {\r\n        minor: 0.95,\r\n        average: 0.9,\r\n        major: 0.85,\r\n      },\r\n      style: 'percentage',\r\n    };\r\n  }\r\n\r\n  static dependencies = {\r\n    abilityTracker: AbilityTracker,\r\n  };\r\n\r\n  constructor(...args) {\r\n    super(...args);\r\n    this.active = this.selectedCombatant.hasTalent(SPELLS.GRIMOIRE_OF_SACRIFICE_TALENT.id);\r\n  }\r\n\r\n  suggestions(when) {\r\n    when(this.suggestionThresholds)\r\n      .addSuggestion((suggest, actual, recommended) => suggest(<>Your uptime on <SpellLink id={SPELLS.GRIMOIRE_OF_SACRIFICE_TALENT.id} /> is too low. If you picked this talent, you should always have your pet sacrificed. If you died or summoned your pet, make sure to sacrifice it again to gain this buff.</>)\r\n        .icon(SPELLS.GRIMOIRE_OF_SACRIFICE_TALENT.icon)\r\n        .actual(i18n._(t('warlock.shared.suggestions.grimoireOfSacrifice.uptime')`${formatPercentage(actual)} % Grimoire of Sacrifice uptime.`))\r\n        .recommended(`>= ${formatPercentage(recommended)} % is recommended`));\r\n  }\r\n\r\n  statistic() {\r\n    const spell = this.abilityTracker.getAbility(SPELLS.GRIMOIRE_OF_SACRIFICE_DAMAGE.id);\r\n    const damage = spell.damageEffective + spell.damageAbsorbed;\r\n    const dps = damage / this.owner.fightDuration * 1000;\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(4)}\r\n        size=\"small\"\r\n        tooltip={(\r\n          <>\r\n            {formatThousands(damage)} damage<br />\r\n            Buff uptime: {formatPercentage(this.uptime)} %\r\n          </>\r\n        )}\r\n      >\r\n        <BoringSpellValueText spell={SPELLS.GRIMOIRE_OF_SACRIFICE_TALENT}>\r\n          {formatNumber(dps)} DPS <small>{formatPercentage(this.owner.getPercentageOfTotalDamageDone(damage))} % of total</small>\r\n        </BoringSpellValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default GrimoireOfSacrifice;\r\n","/**\r\n * A simple component that shows the spell value in the most plain way possible.\r\n * Use this only as the very last resort.\r\n */\r\nimport React from 'react';\r\n\r\nimport SpellIcon from 'common/SpellIcon';\r\nimport SpellLink from 'common/SpellLink';\r\nimport Spell from 'common/SPELLS/Spell';\r\n\r\ntype Props = {\r\n  spell: Spell;\r\n  children: React.ReactNode;\r\n  className?: string;\r\n}\r\n\r\nconst BoringSpellValueText = ({ spell, children, className }: Props) => (\r\n  <div className={`pad boring-text ${className || ''}`}>\r\n    <label>\r\n      <SpellIcon id={spell.id} /> <SpellLink id={spell.id} icon={false} />\r\n    </label>\r\n    <div className=\"value\">\r\n      {children}\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport default BoringSpellValueText;\r\n","export default function calculateEffectiveDamage(event, increase) {\r\n  const raw = (event.amount || 0) + (event.absorbed || 0);\r\n  return raw - (raw / (1 + increase));\r\n}\r\n","import Analyzer, { SELECTED_PLAYER, Options } from 'parser/core/Analyzer';\r\nimport EventEmitter from 'parser/core/modules/EventEmitter';\r\nimport Events, { EventType, ClassResources, EnergizeEvent, CastEvent, HealEvent, SpendResourceEvent } from 'parser/core/Events';\r\nimport { Resource } from 'game/RESOURCE_TYPES';\r\n\r\nexport type BuilderObj = {\r\n  generated: number,\r\n  wasted: number,\r\n  casts: number,\r\n}\r\n\r\nexport type SpenderObj = {\r\n  spent: number,\r\n  spentByCast: number[],\r\n  casts: number,\r\n}\r\n\r\ntype ResourceUpdate = {\r\n  timestamp: number | undefined,\r\n  current: number,\r\n  waste: number,\r\n  generated: number,\r\n  used: number,\r\n}\r\n\r\n/**\r\n * This is an 'abstract' implementation of a framework for tracking resource generating/spending.\r\n * Extend it by following the instructions in the TODO comments below\r\n */\r\nclass ResourceTracker extends Analyzer {\r\n  static dependencies = {\r\n    eventEmitter: EventEmitter,\r\n    // Optional dependency for the `resourceCost` prop of events\r\n    // spellResourceCost: SpellResourceCost,\r\n  };\r\n\r\n  protected eventEmitter!: EventEmitter;\r\n\r\n  current = 0;\r\n  resourceUpdates: ResourceUpdate[] = [];\r\n\r\n  // stores resource gained/spent/wasted by ability ID\r\n  buildersObj: {[index: number]: BuilderObj} = {};\r\n  spendersObj: {[index: number]: SpenderObj} = {};\r\n\r\n  // TODO set this to the resource you wish to track constructor.. see the appropriate objects in game/RESOURCE_TYPES\r\n  resource!: Resource;\r\n\r\n  // TODO a classes 'main' resource passes the max along with events, but for other resources this may need to be defined\r\n  maxResource!: number;\r\n\r\n  constructor(options: Options){\r\n    super(options);\r\n    this.addEventListener(Events.energize.to(SELECTED_PLAYER), this.onEnergize);\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER), this.onCast);\r\n  }\r\n\r\n  // FIXME implement natural regen\r\n  // TODO if the tracked resource naturally regenerates (like Energy), set this to true and set the parameters of the regeneration in the below fields\r\n  // naturallyRegenerates = false;\r\n  // baseRegenRate; // TODO resource's base regeneration rate in points per second\r\n  // isRegenHasted; // TODO iff true, regeneration rate will be scaled with haste\r\n\r\n  // TODO if you wish an ability to show in results even if it wasn't used, add it using these functions constructor\r\n  initBuilderAbility(spellId: number) {\r\n    this.buildersObj[spellId] = { generated: 0, wasted: 0, casts: 0 };\r\n  }\r\n  initSpenderAbility(spellId: number) {\r\n    this.spendersObj[spellId] = { spent: 0, spentByCast: [], casts: 0 };\r\n  }\r\n\r\n  // BUILDERS - Handled on energize, using the 'resourceChange' field\r\n  onEnergize(event: EnergizeEvent) {\r\n    const spellId = event.ability.guid;\r\n\r\n    if(event.resourceChangeType !== this.resource.id) {\r\n        return;\r\n    }\r\n\r\n    const waste = event.waste;\r\n    const gain = event.resourceChange - waste;\r\n    this._applyBuilder(spellId, gain, waste, this.getResource(event), event.timestamp);\r\n  }\r\n\r\n  // FIXME Track resource drains too, so that the 'current' value can be more accurate\r\n\r\n  // TODO if a resource gain isn't showing as an energize in events, handle it manually by calling this\r\n  /**\r\n   * FIXME solve with a normalizer instead?\r\n   * Applies an energize of the tracked resource type.\r\n   * @param {number} spellId - The spellId to attribute the resource gain to\r\n   * @param {number} amount - The raw amount of resources to gain\r\n   */\r\n  processInvisibleEnergize(spellId: number, amount: number) {\r\n    const maxGain = this.maxResource !== undefined ? this.maxResource - this.current : amount;\r\n    const gain = Math.min(amount, maxGain);\r\n    const waste = Math.max(amount - maxGain, 0);\r\n    this._applyBuilder(spellId, gain, waste);\r\n  }\r\n\r\n  _applyBuilder(spellId: number, gain: number, waste: number,  resource?: ClassResources, timestamp?: number) {\r\n    if (!this.buildersObj[spellId]) {\r\n        this.initBuilderAbility(spellId);\r\n    }\r\n\r\n    this.buildersObj[spellId].wasted += waste;\r\n    this.buildersObj[spellId].generated += gain;\r\n    this.buildersObj[spellId].casts += 1;\r\n\r\n    // resource.amount for an energize is the amount AFTER the energize\r\n    if (resource !== null && resource !== undefined && resource.amount !== undefined) {\r\n      this.current = resource.amount;\r\n      if (resource.max !== undefined) {\r\n        this.maxResource = resource.max; // track changes in max resource, which can happen due to procs / casts\r\n      }\r\n    } else {\r\n      this.current += gain;\r\n    }\r\n\r\n    this.resourceUpdates.push({\r\n      timestamp: timestamp,\r\n      current: this.current,\r\n      waste: waste,\r\n      generated: gain,\r\n      used: 0,\r\n    });\r\n  }\r\n\r\n  // SPENDERS - Handled on cast, using the 'classResources' field\r\n  onCast(event: CastEvent) {\r\n    const spellId = event.ability.guid;\r\n\r\n    if(!this.shouldProcessCastEvent(event)) {\r\n        return;\r\n    }\r\n    const eventResource = this.getResource(event);\r\n\r\n    if(!eventResource){\r\n      return;\r\n    }\r\n\r\n    if (eventResource.max) {\r\n      this.maxResource = eventResource.max; // track changes in max resource, which can happen due to procs / casts\r\n    }\r\n    const cost = this.getReducedCost(event);\r\n\r\n    if (!this.spendersObj[spellId]) {\r\n      this.initSpenderAbility(spellId);\r\n    }\r\n\r\n    if (!cost || cost === 0) {\r\n      return;\r\n    }\r\n\r\n    this.spendersObj[spellId].casts += 1;\r\n    this.spendersObj[spellId].spentByCast.push(cost);\r\n    if(cost > 0) {\r\n      this.spendersObj[spellId].spent += cost;\r\n    }\r\n\r\n    //Re-sync current amount, to update not-tracked gains.\r\n    this.current = eventResource.amount - cost;\r\n\r\n    this.resourceUpdates.push({\r\n      timestamp: event.timestamp,\r\n      current: this.current,\r\n      waste: 0,\r\n      generated: 0,\r\n      used: eventResource.amount,\r\n    });\r\n\r\n    this.triggerSpendEvent(cost, event);\r\n  }\r\n\r\n  // TODO if your spec has an ability cost reduction that doesn't show in events, handle it manually by overriding here. Or extend SpellResourceCost and apply the discount there.\r\n  getReducedCost(event: CastEvent) {\r\n    if (event.resourceCost && event.resourceCost[this.resource.id] !== undefined) {\r\n      return event.resourceCost[this.resource.id];\r\n    }\r\n    return this.getResource(event)?.cost;\r\n  }\r\n\r\n  getResource(event: CastEvent | HealEvent | EnergizeEvent ) {\r\n    if(!event.classResources) {\r\n      return undefined;\r\n    } else {\r\n      return event.classResources.find(r => r.type === this.resource.id);\r\n    }\r\n  }  \r\n\r\n  triggerSpendEvent(spent: number, event: CastEvent) {\r\n\r\n    const fabricatedEvent: SpendResourceEvent = {\r\n      type: EventType.SpendResource,\r\n      timestamp: event.timestamp,\r\n      sourceID: event.sourceID,\r\n      targetID: event.targetID,\r\n      resourceChange: spent,\r\n      resourceChangeType: this.resource.id,\r\n      ability: event.ability,\r\n      __fabricated: true,\r\n    };\r\n\r\n    this.eventEmitter.fabricateEvent(fabricatedEvent, event);\r\n  }\r\n\r\n  shouldProcessCastEvent(event: CastEvent) {\r\n    return Boolean(this.getResource(event));\r\n  }\r\n\r\n  getGeneratedBySpell(spellId: number) {\r\n    return (this.buildersObj[spellId] && this.buildersObj[spellId].generated) || 0;\r\n  }\r\n\r\n  getWastedBySpell(spellId: number) {\r\n    return (this.buildersObj[spellId] && this.buildersObj[spellId].wasted) || 0;\r\n  }\r\n\r\n  getBuilderCastsBySpell(spellId: number) {\r\n    return (this.buildersObj[spellId] && this.buildersObj[spellId].casts) || 0;\r\n  }\r\n\r\n  get generated() {\r\n    return Object.values(this.buildersObj).reduce((acc, spell) => acc + spell.generated, 0);\r\n  }\r\n\r\n  get wasted() {\r\n    return Object.values(this.buildersObj).reduce((acc, spell) => acc + spell.wasted, 0);\r\n  }\r\n\r\n  get spent() {\r\n    return Object.values(this.spendersObj).reduce((acc, spell) => acc + spell.spent, 0);\r\n  }\r\n\r\n  get spendersCasts() {\r\n    return Object.values(this.spendersObj).reduce((acc, spell) => acc + spell.casts, 0);\r\n  }\r\n}\r\n\r\nexport default ResourceTracker;\r\n","import React from 'react';\r\n\r\nimport SpellLink from 'common/SpellLink';\r\nimport { formatPercentage } from 'common/format';\r\nimport { TooltipElement } from 'common/Tooltip';\r\n\r\nimport ResourceTracker, { BuilderObj, SpenderObj } from './ResourceTracker';\r\n\r\ninterface Props {\r\n  tracker: ResourceTracker,\r\n  showSpenders: boolean,\r\n}\r\n\r\nclass ResourceBreakdown extends React.Component<Props> {\r\n\r\n  prepareGenerated(buildersObj: {[index: number]: BuilderObj}) {\r\n    return Object.keys(buildersObj)\r\n      .map(abilityId => ({\r\n        abilityId: Number(abilityId),\r\n        generated: buildersObj[Number(abilityId)].generated,\r\n        wasted: buildersObj[Number(abilityId)].wasted,\r\n      }))\r\n      .sort((a, b) => b.generated - a.generated)\r\n      .filter(ability => ability.generated > 0 || ability.wasted);\r\n  }\r\n\r\n  prepareSpent(spendersObj: {[index: number]: SpenderObj}) {\r\n    return Object.keys(spendersObj)\r\n      .map(abilityId => ({\r\n        abilityId: Number(abilityId),\r\n        spent: spendersObj[Number(abilityId)].spent,\r\n        casts: spendersObj[Number(abilityId)].casts,\r\n      }))\r\n      .sort((a, b) => b.spent - a.spent)\r\n      .filter(ability => ability.spent > 0);\r\n  }\r\n\r\n  render() {\r\n    const { tracker, showSpenders } = this.props;\r\n    const resourceName = tracker.resource.name;\r\n\r\n    const generated = this.prepareGenerated(tracker.buildersObj);\r\n    const spent = this.prepareSpent(tracker.spendersObj);\r\n\r\n    let totalGenerated = tracker.generated;\r\n    let totalWasted = tracker.wasted;\r\n\r\n    let totalSpent = tracker.spent;\r\n    let totalCasts = tracker.spendersCasts;\r\n\r\n    // looks wrong but totals are only for the purpose of percentage, and if nothing was wasted, then 0/1 gives correct result 0% wasted, if it's not 0 it retains its original value\r\n    totalGenerated = (totalGenerated === 0) ? 1 : totalGenerated;\r\n    totalWasted = (totalWasted === 0) ? 1 : totalWasted;\r\n\r\n    totalSpent = (totalSpent === 0) ? 1 : totalSpent;\r\n    totalCasts = (totalCasts === 0) ? 1 : totalCasts;\r\n\r\n    return (\r\n      <>\r\n        <table className=\"data-table\">\r\n          <thead>\r\n            <tr>\r\n              <th>Ability</th>\r\n              <th colSpan={2}>{resourceName} generated</th>\r\n              <th colSpan={2}><TooltipElement content=\"This is the amount of resources that were generated while you were already at cap.\">{resourceName} wasted</TooltipElement></th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {generated && generated\r\n              .map(ability => (\r\n                <tr key={ability.abilityId}>\r\n                  <td style={{ width: '30%' }}>\r\n                    <SpellLink id={ability.abilityId} />\r\n                  </td>\r\n                  <td style={{ width: 50, paddingRight: 5, textAlign: 'center' }}>\r\n                    <TooltipElement content={`${formatPercentage(ability.generated / totalGenerated)} %`}>{ability.generated.toFixed(0)}</TooltipElement>\r\n                  </td>\r\n                  <td style={{ width: '40%' }}>\r\n                    <div\r\n                      className=\"performance-bar\"\r\n                      style={{ width: `${(ability.generated / totalGenerated) * 100}%` }}\r\n                    />\r\n                  </td>\r\n                  <td style={{ width: 50, paddingRight: 5, textAlign: 'center' }}>\r\n                    <TooltipElement content={`${formatPercentage(ability.wasted / totalWasted)} %`}>{ability.wasted.toFixed(0)}</TooltipElement>\r\n                  </td>\r\n                  <td style={{ width: '30%' }}>\r\n                    <div\r\n                      className=\"performance-bar\"\r\n                      style={{ width: `${(ability.wasted / totalWasted) * 100}%` }}\r\n                    />\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n          </tbody>\r\n        </table>\r\n        {showSpenders && (\r\n          <table className=\"data-table\">\r\n            <thead>\r\n              <tr>\r\n                <th>Ability</th>\r\n                <th colSpan={2}>{resourceName} spent</th>\r\n                <th colSpan={2}>Casts</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {spent && spent\r\n                .map(ability => (\r\n                  <tr key={ability.abilityId}>\r\n                    <td style={{ width: '30%' }}>\r\n                      <SpellLink id={ability.abilityId} />\r\n                    </td>\r\n                    <td style={{ width: 50, paddingRight: 5, textAlign: 'center' }}>\r\n                      <TooltipElement content={`${formatPercentage(ability.spent / totalSpent)} %`}>{ability.spent.toFixed(0)}</TooltipElement>\r\n                    </td>\r\n                    <td style={{ width: '40%' }}>\r\n                      <div\r\n                        className=\"performance-bar\"\r\n                        style={{ width: `${(ability.spent / totalSpent) * 100}%` }}\r\n                      />\r\n                    </td>\r\n                    <td style={{ width: 50, paddingRight: 5, textAlign: 'center' }}>\r\n                      <TooltipElement content={`${formatPercentage(ability.casts / totalCasts)} %`}>{ability.casts}</TooltipElement>\r\n                    </td>\r\n                    <td style={{ width: '30%' }}>\r\n                      <div\r\n                        className=\"performance-bar\"\r\n                        style={{ width: `${(ability.casts / totalCasts) * 100}%` }}\r\n                      />\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n            </tbody>\r\n          </table>\r\n        )}\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ResourceBreakdown;\r\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar ANIMATION_STATE_CLASSES = {\n  animating: 'rah-animating',\n  animatingUp: 'rah-animating--up',\n  animatingDown: 'rah-animating--down',\n  animatingToHeightZero: 'rah-animating--to-height-zero',\n  animatingToHeightAuto: 'rah-animating--to-height-auto',\n  animatingToHeightSpecific: 'rah-animating--to-height-specific',\n  static: 'rah-static',\n  staticHeightZero: 'rah-static--height-zero',\n  staticHeightAuto: 'rah-static--height-auto',\n  staticHeightSpecific: 'rah-static--height-specific'\n};\n\nvar PROPS_TO_OMIT = ['animateOpacity', 'animationStateClasses', 'applyInlineTransitions', 'children', 'contentClassName', 'delay', 'duration', 'easing', 'height', 'onAnimationEnd', 'onAnimationStart'];\n\nfunction omit(obj) {\n  for (var _len = arguments.length, keys = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    keys[_key - 1] = arguments[_key];\n  }\n\n  if (!keys.length) {\n    return obj;\n  }\n\n  var res = {};\n  var objectKeys = Object.keys(obj);\n\n  for (var i = 0; i < objectKeys.length; i++) {\n    var key = objectKeys[i];\n\n    if (keys.indexOf(key) === -1) {\n      res[key] = obj[key];\n    }\n  }\n\n  return res;\n}\n\n// Start animation helper using nested requestAnimationFrames\nfunction startAnimationHelper(callback) {\n  var requestAnimationFrameIDs = [];\n\n  requestAnimationFrameIDs[0] = requestAnimationFrame(function () {\n    requestAnimationFrameIDs[1] = requestAnimationFrame(function () {\n      callback();\n    });\n  });\n\n  return requestAnimationFrameIDs;\n}\n\nfunction cancelAnimationFrames(requestAnimationFrameIDs) {\n  requestAnimationFrameIDs.forEach(function (id) {\n    return cancelAnimationFrame(id);\n  });\n}\n\nfunction isNumber(n) {\n  return !isNaN(parseFloat(n)) && isFinite(n);\n}\n\nfunction isPercentage(height) {\n  // Percentage height\n  return typeof height === 'string' && height.search('%') === height.length - 1 && isNumber(height.substr(0, height.length - 1));\n}\n\nfunction runCallback(callback, params) {\n  if (callback && typeof callback === 'function') {\n    callback(params);\n  }\n}\n\nvar AnimateHeight = function (_React$Component) {\n  _inherits(AnimateHeight, _React$Component);\n\n  function AnimateHeight(props) {\n    _classCallCheck(this, AnimateHeight);\n\n    var _this = _possibleConstructorReturn(this, (AnimateHeight.__proto__ || Object.getPrototypeOf(AnimateHeight)).call(this, props));\n\n    _this.animationFrameIDs = [];\n\n    var height = 'auto';\n    var overflow = 'visible';\n\n    if (isNumber(props.height)) {\n      // If value is string \"0\" make sure we convert it to number 0\n      height = props.height < 0 || props.height === '0' ? 0 : props.height;\n      overflow = 'hidden';\n    } else if (isPercentage(props.height)) {\n      // If value is string \"0%\" make sure we convert it to number 0\n      height = props.height === '0%' ? 0 : props.height;\n      overflow = 'hidden';\n    }\n\n    _this.animationStateClasses = _extends({}, ANIMATION_STATE_CLASSES, props.animationStateClasses);\n\n    var animationStateClasses = _this.getStaticStateClasses(height);\n\n    _this.state = {\n      animationStateClasses: animationStateClasses,\n      height: height,\n      overflow: overflow,\n      shouldUseTransitions: false\n    };\n    return _this;\n  }\n\n  _createClass(AnimateHeight, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var height = this.state.height;\n\n      // Hide content if height is 0 (to prevent tabbing into it)\n      // Check for contentElement is added cause this would fail in tests (react-test-renderer)\n      // Read more here: https://github.com/Stanko/react-animate-height/issues/17\n\n      if (this.contentElement && this.contentElement.style) {\n        this.hideContent(height);\n      }\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      var _this2 = this;\n\n      var _props = this.props,\n          delay = _props.delay,\n          duration = _props.duration,\n          height = _props.height,\n          onAnimationEnd = _props.onAnimationEnd,\n          onAnimationStart = _props.onAnimationStart;\n\n      // Check if 'height' prop has changed\n\n      if (this.contentElement && height !== prevProps.height) {\n        var _cx;\n\n        // Remove display: none from the content div\n        // if it was hidden to prevent tabbing into it\n        this.showContent(prevState.height);\n\n        // Cache content height\n        this.contentElement.style.overflow = 'hidden';\n        var contentHeight = this.contentElement.offsetHeight;\n        this.contentElement.style.overflow = '';\n\n        // set total animation time\n        var totalDuration = duration + delay;\n\n        var newHeight = null;\n        var timeoutState = {\n          height: null, // it will be always set to either 'auto' or specific number\n          overflow: 'hidden'\n        };\n        var isCurrentHeightAuto = prevState.height === 'auto';\n\n        if (isNumber(height)) {\n          // If value is string \"0\" make sure we convert it to number 0\n          newHeight = height < 0 || height === '0' ? 0 : height;\n          timeoutState.height = newHeight;\n        } else if (isPercentage(height)) {\n          // If value is string \"0%\" make sure we convert it to number 0\n          newHeight = height === '0%' ? 0 : height;\n          timeoutState.height = newHeight;\n        } else {\n          // If not, animate to content height\n          // and then reset to auto\n          newHeight = contentHeight; // TODO solve contentHeight = 0\n          timeoutState.height = 'auto';\n          timeoutState.overflow = null;\n        }\n\n        if (isCurrentHeightAuto) {\n          // This is the height to be animated to\n          timeoutState.height = newHeight;\n\n          // If previous height was 'auto'\n          // set starting height explicitly to be able to use transition\n          newHeight = contentHeight;\n        }\n\n        // Animation classes\n        var animationStateClasses = (0, _classnames2.default)((_cx = {}, _defineProperty(_cx, this.animationStateClasses.animating, true), _defineProperty(_cx, this.animationStateClasses.animatingUp, prevProps.height === 'auto' || height < prevProps.height), _defineProperty(_cx, this.animationStateClasses.animatingDown, height === 'auto' || height > prevProps.height), _defineProperty(_cx, this.animationStateClasses.animatingToHeightZero, timeoutState.height === 0), _defineProperty(_cx, this.animationStateClasses.animatingToHeightAuto, timeoutState.height === 'auto'), _defineProperty(_cx, this.animationStateClasses.animatingToHeightSpecific, timeoutState.height > 0), _cx));\n\n        // Animation classes to be put after animation is complete\n        var timeoutAnimationStateClasses = this.getStaticStateClasses(timeoutState.height);\n\n        // Set starting height and animating classes\n        // We are safe to call set state as it will not trigger infinite loop\n        // because of the \"height !== prevProps.height\" check\n        this.setState({ // eslint-disable-line react/no-did-update-set-state\n          animationStateClasses: animationStateClasses,\n          height: newHeight,\n          overflow: 'hidden',\n          // When animating from 'auto' we first need to set fixed height\n          // that change should be animated\n          shouldUseTransitions: !isCurrentHeightAuto\n        });\n\n        // Clear timeouts\n        clearTimeout(this.timeoutID);\n        clearTimeout(this.animationClassesTimeoutID);\n\n        if (isCurrentHeightAuto) {\n          // When animating from 'auto' we use a short timeout to start animation\n          // after setting fixed height above\n          timeoutState.shouldUseTransitions = true;\n\n          cancelAnimationFrames(this.animationFrameIDs);\n          this.animationFrameIDs = startAnimationHelper(function () {\n            _this2.setState(timeoutState);\n\n            // ANIMATION STARTS, run a callback if it exists\n            runCallback(onAnimationStart, { newHeight: timeoutState.height });\n          });\n\n          // Set static classes and remove transitions when animation ends\n          this.animationClassesTimeoutID = setTimeout(function () {\n            _this2.setState({\n              animationStateClasses: timeoutAnimationStateClasses,\n              shouldUseTransitions: false\n            });\n\n            // ANIMATION ENDS\n            // Hide content if height is 0 (to prevent tabbing into it)\n            _this2.hideContent(timeoutState.height);\n            // Run a callback if it exists\n            runCallback(onAnimationEnd, { newHeight: timeoutState.height });\n          }, totalDuration);\n        } else {\n          // ANIMATION STARTS, run a callback if it exists\n          runCallback(onAnimationStart, { newHeight: newHeight });\n\n          // Set end height, classes and remove transitions when animation is complete\n          this.timeoutID = setTimeout(function () {\n            timeoutState.animationStateClasses = timeoutAnimationStateClasses;\n            timeoutState.shouldUseTransitions = false;\n\n            _this2.setState(timeoutState);\n\n            // ANIMATION ENDS\n            // If height is auto, don't hide the content\n            // (case when element is empty, therefore height is 0)\n            if (height !== 'auto') {\n              // Hide content if height is 0 (to prevent tabbing into it)\n              _this2.hideContent(newHeight); // TODO solve newHeight = 0\n            }\n            // Run a callback if it exists\n            runCallback(onAnimationEnd, { newHeight: newHeight });\n          }, totalDuration);\n        }\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      cancelAnimationFrames(this.animationFrameIDs);\n\n      clearTimeout(this.timeoutID);\n      clearTimeout(this.animationClassesTimeoutID);\n\n      this.timeoutID = null;\n      this.animationClassesTimeoutID = null;\n      this.animationStateClasses = null;\n    }\n  }, {\n    key: 'showContent',\n    value: function showContent(height) {\n      if (height === 0) {\n        this.contentElement.style.display = '';\n      }\n    }\n  }, {\n    key: 'hideContent',\n    value: function hideContent(newHeight) {\n      if (newHeight === 0) {\n        this.contentElement.style.display = 'none';\n      }\n    }\n  }, {\n    key: 'getStaticStateClasses',\n    value: function getStaticStateClasses(height) {\n      var _cx2;\n\n      return (0, _classnames2.default)((_cx2 = {}, _defineProperty(_cx2, this.animationStateClasses.static, true), _defineProperty(_cx2, this.animationStateClasses.staticHeightZero, height === 0), _defineProperty(_cx2, this.animationStateClasses.staticHeightSpecific, height > 0), _defineProperty(_cx2, this.animationStateClasses.staticHeightAuto, height === 'auto'), _cx2));\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _cx3,\n          _this3 = this;\n\n      var _props2 = this.props,\n          animateOpacity = _props2.animateOpacity,\n          applyInlineTransitions = _props2.applyInlineTransitions,\n          children = _props2.children,\n          className = _props2.className,\n          contentClassName = _props2.contentClassName,\n          delay = _props2.delay,\n          duration = _props2.duration,\n          easing = _props2.easing,\n          id = _props2.id,\n          style = _props2.style;\n      var _state = this.state,\n          height = _state.height,\n          overflow = _state.overflow,\n          animationStateClasses = _state.animationStateClasses,\n          shouldUseTransitions = _state.shouldUseTransitions;\n\n\n      var componentStyle = _extends({}, style, {\n        height: height,\n        overflow: overflow || style.overflow\n      });\n\n      if (shouldUseTransitions && applyInlineTransitions) {\n        componentStyle.transition = 'height ' + duration + 'ms ' + easing + ' ' + delay + 'ms';\n\n        // Include transition passed through styles\n        if (style.transition) {\n          componentStyle.transition = style.transition + ', ' + componentStyle.transition;\n        }\n\n        // Add webkit vendor prefix still used by opera, blackberry...\n        componentStyle.WebkitTransition = componentStyle.transition;\n      }\n\n      var contentStyle = {};\n\n      if (animateOpacity) {\n        contentStyle.transition = 'opacity ' + duration + 'ms ' + easing + ' ' + delay + 'ms';\n        // Add webkit vendor prefix still used by opera, blackberry...\n        contentStyle.WebkitTransition = contentStyle.transition;\n\n        if (height === 0) {\n          contentStyle.opacity = 0;\n        }\n      }\n\n      var componentClasses = (0, _classnames2.default)((_cx3 = {}, _defineProperty(_cx3, animationStateClasses, true), _defineProperty(_cx3, className, className), _cx3));\n\n      // Check if user passed aria-hidden prop\n      var hasAriaHiddenProp = typeof this.props['aria-hidden'] !== 'undefined';\n      var ariaHidden = hasAriaHiddenProp ? this.props['aria-hidden'] : height === 0;\n\n      return _react2.default.createElement(\n        'div',\n        _extends({}, omit.apply(undefined, [this.props].concat(PROPS_TO_OMIT)), {\n          'aria-hidden': ariaHidden,\n          className: componentClasses,\n          id: id,\n          style: componentStyle\n        }),\n        _react2.default.createElement(\n          'div',\n          {\n            className: contentClassName,\n            style: contentStyle,\n            ref: function ref(el) {\n              return _this3.contentElement = el;\n            }\n          },\n          children\n        )\n      );\n    }\n  }]);\n\n  return AnimateHeight;\n}(_react2.default.Component);\n\nvar heightPropType = function heightPropType(props, propName, componentName) {\n  var value = props[propName];\n\n  if (typeof value === 'number' && value >= 0 || isPercentage(value) || value === 'auto') {\n    return null;\n  }\n\n  return new TypeError('value \"' + value + '\" of type \"' + (typeof value === 'undefined' ? 'undefined' : _typeof(value)) + '\" is invalid type for ' + propName + ' in ' + componentName + '. ' + 'It needs to be a positive number, string \"auto\" or percentage string (e.g. \"15%\").');\n};\n\nAnimateHeight.propTypes = {\n  'aria-hidden': _propTypes2.default.bool,\n  animateOpacity: _propTypes2.default.bool,\n  animationStateClasses: _propTypes2.default.object,\n  applyInlineTransitions: _propTypes2.default.bool,\n  children: _propTypes2.default.any.isRequired,\n  className: _propTypes2.default.string,\n  contentClassName: _propTypes2.default.string,\n  delay: _propTypes2.default.number,\n  duration: _propTypes2.default.number,\n  easing: _propTypes2.default.string,\n  height: heightPropType,\n  id: _propTypes2.default.string,\n  onAnimationEnd: _propTypes2.default.func,\n  onAnimationStart: _propTypes2.default.func,\n  style: _propTypes2.default.object\n};\n\nAnimateHeight.defaultProps = {\n  animateOpacity: false,\n  animationStateClasses: ANIMATION_STATE_CLASSES,\n  applyInlineTransitions: true,\n  duration: 250,\n  delay: 0,\n  easing: 'ease',\n  style: {}\n};\n\nexports.default = AnimateHeight;","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { AutoSizer } from 'react-virtualized';\r\nimport BaseChart from 'interface/others/BaseChart';\r\n\r\nclass OneVariableBinomialChart extends React.Component {\r\n  static propTypes = {\r\n    probabilities: PropTypes.arrayOf(\r\n      PropTypes.shape({\r\n        x: PropTypes.number.isRequired,\r\n        y: PropTypes.number.isRequired,\r\n      }),\r\n    ).isRequired,\r\n    actualEvent: PropTypes.shape({\r\n      x: PropTypes.number.isRequired,\r\n      y: PropTypes.number.isRequired,\r\n    }).isRequired,\r\n    xAxis: PropTypes.shape({\r\n      title: PropTypes.string.isRequired,\r\n      tickFormat: PropTypes.string.isRequired,\r\n    }).isRequired,\r\n    yAxis: PropTypes.shape({\r\n      title: PropTypes.string.isRequired,\r\n    }),\r\n    yDomain: PropTypes.arrayOf(PropTypes.number),\r\n    tooltip: PropTypes.string.isRequired,\r\n  };\r\n\r\n  state = {\r\n    hover: null,\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      probabilities,\r\n      actualEvent,\r\n      xAxis,\r\n      yAxis,\r\n      yDomain,\r\n      tooltip,\r\n    } = this.props;\r\n\r\n    const data = {\r\n      probabilities,\r\n      actual: actualEvent,\r\n    };\r\n\r\n    const spec = {\r\n      encoding: {\r\n        x: {\r\n          field: 'x',\r\n          type: 'quantitative',\r\n          title: xAxis.title,\r\n          axis: {\r\n            grid: false,\r\n            format: xAxis.tickFormat,\r\n          },\r\n        },\r\n        y: {\r\n          field: 'y',\r\n          type: 'quantitative',\r\n          title: yAxis.title,\r\n          axis: {\r\n            grid: false,\r\n            format: '.0%',\r\n          },\r\n          scale: {\r\n            domain: yDomain,\r\n          },\r\n        },\r\n      },\r\n      layer: [\r\n        {\r\n          data: {\r\n            name: 'probabilities',\r\n          },\r\n          mark: {\r\n            type: 'area',\r\n            color: 'rgba(250, 183, 0, 0.15)',\r\n            line: {\r\n              color: '#fab700',\r\n              strokeWidth: 1,\r\n            },\r\n          },\r\n        },\r\n        {\r\n          data: {\r\n            name: 'actual',\r\n          },\r\n          mark: {\r\n            type: 'point',\r\n            filled: true,\r\n            color: '#00ff96',\r\n            size: 60,\r\n          },\r\n          encoding: {\r\n            tooltip: [\r\n              { field: 'x', title: tooltip },\r\n            ],\r\n          },\r\n        },\r\n      ],\r\n    };\r\n\r\n\r\n    return (\r\n      <AutoSizer disableHeight>\r\n        {({width}) => (\r\n          <BaseChart\r\n            height={150}\r\n            width={width}\r\n            spec={spec}\r\n            data={data}\r\n          />\r\n        )}\r\n      </AutoSizer>\r\n    );\r\n  }\r\n}\r\n\r\nexport default OneVariableBinomialChart;\r\n","import OneVariableBinomialChart from 'interface/others/charts/OneVariableBinomialChart';\r\nimport React from 'react';\r\n\r\n/**\r\n * pn is the mean value of procs\r\n * @param procChance\r\n * @param procAttempts\r\n */\r\nexport function expectedProcCount(procChance: number, procAttempts: number) {\r\n  return procChance * procAttempts;\r\n}\r\n\r\n/**\r\n * Calculates the probability that out of n tries with probability p, we get exactly k positive outcomes\r\n * @param k {Number} Number of desired positive outcomes\r\n * @param n {Number} Number of tries\r\n * @param p {Number} Probability of positive outcome\r\n */\r\nexport function binomialPMF(k: number, n: number, p: number) {\r\n  return binomialDistribution(n, k) * Math.pow(p, k) * Math.pow(1 - p, n - k);\r\n}\r\n\r\n/**\r\n * Calculates the probability that out of n tries with probability p, we get k or less positive outcomes\r\n * @param k {Number} Number of desired positive outcomes\r\n * @param n {Number} Number of tries\r\n * @param p {Number} Probability of positive outcome\r\n */\r\nexport function binomialCDF(k: number, n: number, p: number) {\r\n  let probability = 0;\r\n  for (let i = 0; i <= k; i += 1) {\r\n    probability += binomialPMF(i, n, p);\r\n  }\r\n  return probability;\r\n}\r\n\r\n/**\r\n * Finds the maximum of PMF of given distribution.\r\n * @param n {Number} Maximum number of tries for given event\r\n * @param {Function} pmf Callback that returns probability of exactly K events happening in N tries. Parameters - K, N\r\n * @returns {{ max: Number, p: Number }} Maximum of given PMF function - argument and probability itself\r\n */\r\nexport function findMax(n: number, pmf: (i: number, n: any) => any) {\r\n  let max = -1;\r\n  let maxP = 0;\r\n  for (let i = 0; i <= n; i += 1) {\r\n    const probability = pmf(i, n);\r\n    if (probability > maxP) {\r\n      max = i;\r\n      maxP = probability;\r\n    }\r\n  }\r\n  return {\r\n    max,\r\n    p: maxP,\r\n  };\r\n}\r\n\r\nfunction binomialDistribution(n: number, k: number) {\r\n  // n! / (k! * (n - k)!)\r\n  // factorials are awful, let's simplify a bit\r\n  // we know k < n:\r\n  // numerator: n! = 1 * 2 * ... * (n - k) * (n - k + 1) * (n - k + 2 ) * ... * n\r\n  // denominator: k! * (n - k)! = k! * 1 * 2 * ... * (n - k)\r\n  // cancelling out 1 * 2 * ... * (n - k) from both we get:\r\n  // (n - k + 1) * (n - k + 2) * ... n / k!\r\n  let numerator = 1;\r\n  let denominator = 1;\r\n  for (let i = n - k + 1; i <= n; i += 1) {\r\n    numerator *= i;\r\n  }\r\n  for (let i = 1; i <= k; i += 1) {\r\n    denominator *= i;\r\n  }\r\n  return numerator / denominator;\r\n}\r\n\r\nfunction resetProbabilityArray(actualProcs: number, procAttempts: number, procChance: number | number[]) {\r\n  const procProbabilities: Array<{ x: number; y: number; }> = Array.from({ length: procAttempts }, (_x, i: number) => {\r\n    if (typeof procChance === 'number') {\r\n      return { x: i, y: binomialPMF(i, procAttempts, procChance) };\r\n    } else {\r\n      return { x: i, y: poissonBinomialPMF(i, procAttempts, procChance) };\r\n    }\r\n  });\r\n\r\n  return procProbabilities;\r\n}\r\n\r\nfunction setMinMaxProbabilities(actualProcs: number, procAttempts: number, procChance: number | number[], threshold: number = 0.001) {\r\n  const procProbabilities = resetProbabilityArray(actualProcs, procAttempts, procChance);\r\n  const rangeMin = procProbabilities.findIndex(({ y }) => y >= threshold);\r\n  const rangeMax = rangeMin + procProbabilities.slice(rangeMin).findIndex(({ y }) => y < threshold);\r\n\r\n  return {\r\n    procProbabilities,\r\n    rangeMin,\r\n    rangeMax,\r\n  };\r\n}\r\n\r\n/**\r\n * Recursive formula for calculating the PMF (probability mass function) of Poisson's Binomial Distribution\r\n * @param k {Number} Number of desired positive outcomes\r\n * @param j {Number} Number of total tries\r\n * @param p {[Number]} Probability vector\r\n * @param lookup {Array} Lookup table\r\n * @returns {Number} Probability\r\n */\r\nfunction Ekj(k: number, j: number, p: number[], lookup: any[][]) {\r\n  if (k === -1) {\r\n    return 0;\r\n  }\r\n  if (k === j + 1) {\r\n    return 0;\r\n  }\r\n  if (k === 0 && j === 0) {\r\n    return 1;\r\n  }\r\n  if (lookup[k][j] !== null) {\r\n    return lookup[k][j];\r\n  }\r\n  // literature uses 1-based indices for probabilities, as we're using an array, we have to use 0 based\r\n  const value: number = (1 - p[j - 1]) * Ekj(k, j - 1, p, lookup) + p[j - 1] * Ekj(k - 1, j - 1, p, lookup);\r\n  lookup[k][j] = value;\r\n  return value;\r\n}\r\n\r\n// Poisson's Binomial Distribution\r\n// Methods based on Wikipedia page and this research paper:\r\n// https://www.researchgate.net/publication/257017356_On_computing_the_distribution_function_for_the_Poisson_binomial_distribution\r\n\r\n/**\r\n * Calculates the probability that out of n tries with p probabilities, we get exactly k positive outcomes\r\n * @param k {Number} Number of desired positive outcomes\r\n * @param n {Number} Number of total tries\r\n * @param p {[Number]} Probability vector\r\n */\r\nexport function poissonBinomialPMF(k: number, n: number, p: any[]) {\r\n  // denoted in the paper as k, I'll call it Ek for simplicity\r\n  // using the recursive formula in chapter 2.5\r\n  if (p.length !== n) {\r\n    throw new Error('You must supply a probability vector with the same length as the number of total tries into Poisson Binomial PMF');\r\n  }\r\n  // Using a lookup table to simplify recursion a little bit\r\n  // construct an (n+1) x (n+1) lookup table (because Ek,j uses indexes from 0 to n INCLUSIVE, with this we don't have to subtract indexes all the time)\r\n  // intentionally set tu nulls so we know which values are computed or not\r\n  const lookup = [...Array(n + 1)].map(_ => Array(n + 1).fill(null));\r\n  return Ekj(k, n, p, lookup);\r\n}\r\n\r\n/**\r\n * Calculates the probability that out of n tries with p probabilities, we get less than or equal k positive outcomes\r\n * @param k {Number} Number of desired positive outcomes\r\n * @param n {Number} Number of total tries\r\n * @param p {[Number]} Probability vector\r\n */\r\nexport function poissonBinomialCDF(k: number, n: number, p: number[]) {\r\n  // While technically equal to summing Ei from i = 0 to k, since we use recursion, a better solution is a lookup table\r\n  if (p.length !== n) {\r\n    throw new Error('You must supply a probability vector with the same length as the number of total tries into Poisson Binomial CDF');\r\n  }\r\n  // see comments in poissonBinomialPMF\r\n  const lookup = [...Array(n + 1)].map(_ => Array(n + 1).fill(null));\r\n  let probability = 0;\r\n  // since Ekj uses the values from \"previous row\" (Ekj(k - 1, j - 1, ...)), it's better to iterate from 0\r\n  // this way, it produces the least necessary amount of calculations with the lookup table (only the Ekj(k, j - 1) parts)\r\n  for (let i = 0; i <= k; i += 1) {\r\n    probability += Ekj(i, n, p, lookup);\r\n  }\r\n  return probability;\r\n}\r\n\r\nexport function plotOneVariableBinomChart(\r\n  actualProcs: number,\r\n  procAttempts: number,\r\n  procChance: number | number[],\r\n  trackedName: string = 'Procs',\r\n  tooltipText: string = trackedName,\r\n  yDomain: number[] = [0, 0.4],\r\n  xAxis: any = {\r\n    title: trackedName,\r\n    tickFormat: '~k',\r\n  },\r\n  yAxis: any = {\r\n    title: 'Likelihood',\r\n  },\r\n) {\r\n\r\n  const { procProbabilities, rangeMin, rangeMax } = setMinMaxProbabilities(actualProcs, procAttempts, procChance);\r\n  const actualEventY = typeof procChance === 'number' ? binomialPMF(actualProcs, procAttempts, procChance) : poissonBinomialPMF(actualProcs, procAttempts, procChance);\r\n  return (\r\n    <OneVariableBinomialChart\r\n      probabilities={procProbabilities.slice(rangeMin, rangeMax + 1)}\r\n      actualEvent={{ x: actualProcs, y: actualEventY }}\r\n      yDomain={yDomain}\r\n      xAxis={xAxis}\r\n      yAxis={yAxis}\r\n      tooltip={tooltipText}\r\n    />\r\n  );\r\n}\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport { formatPercentage } from 'common/format';\r\nimport { Trans } from '@lingui/macro';\r\n\r\nconst Gauge = ({ value }) => (\r\n  <div className=\"flex\" style={{ textAlign: 'center', marginTop: 12 }}>\r\n    <Trans id=\"interface.statistics.components.gauge.low\" render=\"div\" className=\"flex-main text-right text-muted\" style={{ paddingTop: 23, paddingRight: 8, fontSize: 12 }}>\r\n      Low\r\n    </Trans>\r\n    <div className=\"flex-sub\" style={{ position: 'relative' }}>\r\n      <svg width=\"98\" height=\"85\" viewBox=\"19 19 101 88\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" style={{ fill: 'none' }}>\r\n          <path d=\"M101.459 101.459C119.033 83.8858 119.033 55.3934 101.459 37.8198C83.8859 20.2462 55.3934 20.2462 37.8198 37.8198C20.2463 55.3934 20.2463 83.8858 37.8198 101.459\" stroke=\"#f8b700\" strokeWidth=\"8\" strokeLinecap=\"round\" />\r\n          <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M68.6396 28.6396H70.6396V32.6396H68.6396V28.6396Z\" fill=\"#f8b700\" />\r\n          <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M87.7656 32.8389L89.5485 33.7451L87.7368 37.3097L85.9539 36.4035L87.7656 32.8389Z\" fill=\"#f8b700\" />\r\n          <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M101.207 50.1829L100.077 48.5324L103.378 46.2732L104.508 47.9236L101.207 50.1829Z\" fill=\"#f8b700\" />\r\n          <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M106.622 67.3762L106.417 65.3868L110.398 64.9765L110.603 66.966L106.622 67.3762Z\" fill=\"#f8b700\" />\r\n          <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M103.658 84.4276L104.376 82.5609L108.11 83.9969L107.392 85.8635L103.658 84.4276Z\" fill=\"#f8b700\" />\r\n          <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M52.0547 32.5298L50.2627 33.4179L52.039 37.0019L53.831 36.1137L52.0547 32.5298Z\" fill=\"#f8b700\" />\r\n          <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M36.1157 45.9784L34.965 47.6142L38.2354 49.9147L39.3861 48.2789L36.1157 45.9784Z\" fill=\"#f8b700\" />\r\n          <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M28.8926 64.968L28.6883 66.9576L32.6626 67.3657L32.8669 65.3761L28.8926 64.968Z\" fill=\"#f8b700\" />\r\n          <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M31.3486 84.3921L32.0806 86.2533L35.8031 84.7895L35.0711 82.9282L31.3486 84.3921Z\" fill=\"#f8b700\" />\r\n      </svg>\r\n\r\n      <div\r\n        style={{\r\n          position: 'absolute',\r\n          top: 49,\r\n          left: '50%',\r\n          width: 32,\r\n          height: 32,\r\n          transform: 'translate(-50%, -50%)',\r\n          marginTop: -13,\r\n        }}\r\n      >\r\n        <svg\r\n          width=\"10\"\r\n          height=\"32\"\r\n          viewBox=\"0 0 10 32\"\r\n          fill=\"none\"\r\n          xmlns=\"http://www.w3.org/2000/svg\"\r\n          style={{\r\n            fill: 'none',\r\n            margin: 0,\r\n            transformOrigin: '5px 27px',\r\n            transform: `rotate(${-140 + 280 * value}deg)`,\r\n          }}\r\n        >\r\n          <path d=\"M9 27C9 29.2091 7.20914 31 5 31C2.79086 31 1 29.2091 1 27C1 24.7909 2.79086 23 5 23C7.20914 23 9 24.7909 9 27Z\" stroke=\"#f8b700\" strokeWidth=\"2\" />\r\n          <path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M6 0L6 23H4L4 0L6 0Z\" fill=\"#f8b700\" />\r\n        </svg>\r\n      </div>\r\n\r\n      <div className=\"value\" style={{ marginTop: -18, fontSize: '1.25em' }}>\r\n        {formatPercentage(value, 0)}%\r\n      </div>\r\n    </div>\r\n    <Trans id=\"interface.statistics.components.gauge.high\" render=\"div\" className=\"flex-main text-left text-muted\" style={{ paddingTop: 23, paddingLeft: 8, fontSize: 12 }}>\r\n      High\r\n    </Trans>\r\n  </div>\r\n);\r\nGauge.propTypes = {\r\n  value: PropTypes.number.isRequired,\r\n};\r\n\r\nexport default Gauge;\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport './UptimeBar.scss';\r\n\r\nconst UptimeBar = props => {\r\n  const { uptimeHistory, start: fightStart, end: fightEnd, ...others } = props;\r\n  const fightDuration = fightEnd - fightStart;\r\n\r\n  return (\r\n    <div className=\"uptime-bar\" {...others}>\r\n      {uptimeHistory.map(buff => {\r\n        const start = buff.start;\r\n        const end = buff.end !== null ? buff.end : fightEnd;\r\n\r\n        return (\r\n          <div\r\n            key={`${start}-${end}`}\r\n            style={{\r\n              left: `${(start - fightStart) / fightDuration * 100}%`,\r\n              width: `${(end - start) / fightDuration * 100}%`,\r\n            }}\r\n          />\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n\r\nUptimeBar.propTypes = {\r\n  uptimeHistory: PropTypes.arrayOf(PropTypes.shape({\r\n    start: PropTypes.number.isRequired,\r\n    end: PropTypes.number, // may be null if lasts until fight end\r\n  })).isRequired,\r\n  start: PropTypes.number.isRequired,\r\n  end: PropTypes.number.isRequired,\r\n};\r\n\r\nexport default UptimeBar;\r\n"],"sourceRoot":""}