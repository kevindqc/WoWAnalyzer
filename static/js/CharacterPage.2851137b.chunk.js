(this.webpackJsonpwowanalyzer=this.webpackJsonpwowanalyzer||[]).push([[18],{1049:function(e,t,a){},1314:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return $}));var r=a(27),n=a(0),c=a.n(n),s=a(90),i=a(219),l=a(7),o=a(26),u=a(16),m=a.n(u),p=a(25),h=a(8),d=a(9),f=a(23),g=a(10),E=a(11),v=a(6),b=a(17),y=a(29),N=a(925),P=a(5),O=a(24),k=a(41),S=a(62),w=a(21),R=a(40),D=a(38),_=a(145),I=a(101),j=a(134),C=a(215),T=a(220),A=a(114),L=a(14),x=(a(1049),a(33)),H=a(53),W=a(61),B=a(28),U=a(36),z=a(892),F=a(30),M=[U.a.TRINKET1,U.a.TRINKET2],Z={icon:{width:"1.8em",height:"1.8em",marginRight:2}},K=function(e){Object(g.a)(a,e);var t=Object(E.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e)).renderItem=r.renderItem.bind(Object(f.a)(r)),r}return Object(d.a)(a,[{key:"iconPath",value:function(e){return"/specs/".concat(this.props.class.replace(" ",""),"-").concat(e.replace(" ",""),".jpg")}},{key:"itemFilter",value:function(e,t){return M.includes(t)||"legendary"===e.quality}},{key:"renderItem",value:function(e){return c.a.createElement(W.a,{key:e.id,id:e.id,className:e.quality,icon:!1},c.a.createElement(B.a,{icon:this.props.trinkets[e.id]?this.props.trinkets[e.id].icon:this.props.trinkets[0].icon,style:Object(l.a)(Object(l.a)({},Z.icon),{},{border:"1px solid"})}))}},{key:"formatPerformance",value:function(e){var t=this.props.metric;return"".concat(Object(x.d)(e.persecondamount)," ").concat(t.toLocaleUpperCase()," (").concat(Object(x.e)(e.historical_percent/100,0),"%)")}},{key:"render",value:function(){var e=this,t=this.props.parses;return c.a.createElement("ul",{className:"list parses-list"},t.map((function(t){var a=Object(F.d)(t.report_code,t.report_fight,t.difficulty+" "+t.name,t.advanced?t.character_name:"");return c.a.createElement("li",{key:a},c.a.createElement(b.b,{to:a},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-md-4",style:{color:"white"}},c.a.createElement("div",null,c.a.createElement("img",{className:"spec-icon",src:e.iconPath(t.spec),alt:t.spec}),c.a.createElement("span",{className:"difficulty"},Object(O.b)(t.difficulty)),c.a.createElement("span",{className:"boss"},t.name))),c.a.createElement("div",{className:"col-md-2 text-right"},c.a.createElement("div",{className:Object(z.a)(t.historical_percent/100)},e.formatPerformance(t))),c.a.createElement("div",{className:"col-md-1 text-right"},t.advanced&&t.gear.filter(e.itemFilter).map(e.renderItem)),c.a.createElement("div",{className:"col-md-3"},t.advanced&&t.talents.map((function(e){return c.a.createElement(H.a,{key:e.id,id:e.id,style:Z.icon})}))),c.a.createElement("div",{className:"col-md-2",style:{color:"white",textAlign:"right"}},new Date(t.start_time).toLocaleDateString(),t.advanced&&c.a.createElement("span",{className:"glyphicon glyphicon-chevron-right","aria-hidden":"true",style:{marginLeft:10}})))))})))}}]),a}(c.a.PureComponent),X=0,q=1,G=2,V=[12,13],J={CHARACTER_NOT_FOUND:{id:"interface.characterParses.characterParses.errors.characterNotFound",defaults:"We couldn't find your character on Warcraft Logs"},NO_PARSES_FOR_TIER:{id:"interface.characterParses.characterParses.errors.noParsesForTier",defaults:"We couldn't find any logs"},CHARACTER_HIDDEN:{id:"interface.characterParses.characterParses.errors.characterHidden",defaults:"We could find your character but he's very shy"},WCL_API_ERROR:{id:"interface.characterParses.characterParses.errors.wclAPIError",defaults:"Something went wrong talking to Warcraft Logs"},UNKNOWN_API_ERROR:{id:"interface.characterParses.characterParses.errors.unknownAPIError",defaults:"Something went wrong talking to the server"},UNEXPECTED:{id:"interface.characterParses.characterParses.errors.unexpected",defaults:"Something went wrong"},NOT_RESPONDING:{id:"interface.characterParses.characterParses.errors.notResponding",defaults:"Request timed out"}},Q=function(e){Object(g.a)(r,e);var t=Object(E.a)(r);function r(e){var a;return Object(h.a)(this,r),(a=t.call(this,e)).state={specs:[],class:"",activeSpec:[],activeDifficultyIds:Object.values(O.a),activeZoneID:26,activeEncounter:0,sortBy:X,metric:"dps",image:null,avatarImage:null,parses:[],isLoading:!0,error:null,errorMessage:null,trinkets:w.a,realmSlug:a.props.realm},a.updateDifficulty=a.updateDifficulty.bind(Object(f.a)(a)),a.updateSpec=a.updateSpec.bind(Object(f.a)(a)),a.load=a.load.bind(Object(f.a)(a)),a.changeParseStructure=a.changeParseStructure.bind(Object(f.a)(a)),a.iconPath=a.iconPath.bind(Object(f.a)(a)),a.updateZoneMetricBoss=a.updateZoneMetricBoss.bind(Object(f.a)(a)),a.appendHistory=a.appendHistory.bind(Object(f.a)(a)),a}return Object(d.a)(r,[{key:"componentDidMount",value:function(){var e=Object(p.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.fetchBattleNetInfo();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"iconPath",value:function(e){return"/specs/".concat(this.state.class.replace(" ",""),"-").concat(e.replace(" ",""),".jpg")}},{key:"appendHistory",value:function(e){this.props.appendReportHistory({code:"".concat(e.name,"-").concat(e.realm,"-").concat(e.region),end:Date.now(),type:A.a.CHARACTER,playerName:e.name,playerRealm:e.realm,playerRegion:e.region,playerClass:e.class})}},{key:"updateZoneMetricBoss",value:function(e,t,a){var r=this;this.setState({activeZoneID:e,metric:t,activeEncounter:a},(function(){r.load()}))}},{key:"updateDifficulty",value:function(e){var t=this.state.activeDifficultyIds;t=t.includes(e)?t.filter((function(t){return t!==e})):[].concat(Object(o.a)(t),[e]),this.setState({activeDifficultyIds:t})}},{key:"updateSpec",value:function(e){var t=this.state.activeSpec;t=t.includes(e)?t.filter((function(t){return t!==e})):[].concat(Object(o.a)(t),[e]),this.setState({activeSpec:t})}},{key:"changeParseStructure",value:function(e){var t=this,a=Object(l.a)({},this.state.trinkets),r=e.map((function(e){return V.forEach((function(t){a[e.gear[t].id]||(a[e.gear[t].id]={name:e.gear[t].name,id:e.gear[t].id,icon:w.a[0].icon,quality:e.gear[t].quality})})),{name:e.encounterName,spec:e.spec.replace(" ",""),difficulty:e.difficulty,report_code:e.reportID,report_fight:e.fightID,historical_percent:100-e.rank/e.outOf*100,persecondamount:e.total,start_time:e.startTime,character_name:e.characterName,talents:e.talents,gear:e.gear,advanced:0===Object.values(e.talents).filter((function(e){return null===e.id})).length}}));return Object.values(a).map((function(e){return e.icon===w.a[0].icon&&0!==e.id?fetch(Object(S.d)(e.id)).then((function(e){return e.json()})).then((function(r){a[e.id].icon=r.icon,t.setState({trinkets:a})})).catch((function(){})):null})),r}},{key:"fetchBattleNetInfo",value:function(){var e=Object(p.a)(m.a.mark((function e(){var t,a,r,n,c,s,i,l,o,u,p,h=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,a=t.region,r=t.realm,n=t.name,"CN"!==a){e.next=4;break}return this.setState({image:"/img/fallback-character.jpg"},(function(){h.load()})),e.abrupt("return");case 4:return e.next=6,fetch(Object(S.b)(null,a,r,n));case 6:if(500!==(c=e.sent).status){e.next=12;break}return this.setState({isLoading:!1,error:J.NOT_RESPONDING}),e.abrupt("return");case 12:if(404!==c.status){e.next=17;break}return this.setState({isLoading:!1,error:J.CHARACTER_NOT_FOUND}),e.abrupt("return");case 17:if(c.ok){e.next=20;break}return this.setState({isLoading:!1,error:J.UNEXPECTED}),e.abrupt("return");case 20:return e.next=22,c.json();case 22:if((s=e.sent).thumbnail){e.next=26;break}return this.setState({isLoading:!1,error:J.UNEXPECTED,errorMessage:"Corrupt Battle.net API response received."}),e.abrupt("return");case 26:i=s.thumbnail.replace("-avatar.jpg",""),l="https://render-".concat(this.props.region,".worldofwarcraft.com/character/").concat(i,"-main.jpg"),o="https://render-".concat(this.props.region,".worldofwarcraft.com/character/").concat(i,"-avatar.jpg"),u=s.role,p="HEALING"===u?"hps":"dps",this.setState({image:l,avatarImage:o,metric:p},(function(){h.load()}));case 32:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"findRealm",value:function(){var e=Object(p.a)(m.a.mark((function e(){var t,r,n,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(D.a)((function(){return Promise.resolve().then(a.bind(null,282)).then((function(e){return e.default}))}));case 2:return t=e.sent,r=t[this.props.region],n=this.props.realm.toLowerCase(),(c=r?r.find((function(e){return e.name.toLowerCase()===n})):null)||console.warn("Realm could not be found: "+this.props.realm+". This generally indicates a bug."),e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRealmSlug",value:function(){var e=Object(p.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findRealm();case 2:return t=e.sent,e.abrupt("return",t?t.slug:this.props.realm);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(p.a)(m.a.mark((function e(){var t,a,r,n,c=this,s=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]&&s[0],this.setState({isLoading:!0}),e.next=4,this.getRealmSlug();case 4:return a=e.sent,this.setState({realmSlug:a}),r=encodeURIComponent(this.props.name),n=encodeURIComponent(a),e.abrupt("return",Object(k.i)("parses/character/".concat(r,"/").concat(n,"/").concat(this.props.region),{includeCombatantInfo:!0,metric:this.state.metric,zone:this.state.activeZoneID,timeframe:"historical",_:t?Number(new Date):void 0}).then((function(e){if(0!==e.length)if(e.hidden)c.setState({isLoading:!1,error:J.CHARACTER_HIDDEN});else if(""===c.state.class){var t=e[0].class,a=Object.values(P.a).filter((function(e){return e.className===t})).filter((function(e,t,a){return a.indexOf(e)===t})).map((function(e){return e.specName})),r=c.changeParseStructure(e,t);c.appendHistory({name:c.props.name,realm:c.props.realm,region:c.props.region,class:t}),c.setState({specs:a,activeSpec:a.map((function(e){return e.replace(" ","")})),class:t,parses:r,isLoading:!1,error:null})}else{var n=c.changeParseStructure(e,c.state.class);c.setState({parses:n,error:null,isLoading:!1})}else c.setState({parses:[],isLoading:!1,error:J.NO_PARSES_FOR_TIER})})).catch((function(e){e instanceof k.b?c.setState({error:J.CHARACTER_NOT_FOUND,isLoading:!1}):(Object(R.a)(e),e instanceof k.h?c.setState({error:J.WCL_API_ERROR,errorMessage:e.message,isLoading:!1}):e instanceof k.g?c.setState({error:J.UNKNOWN_API_ERROR,errorMessage:e.message,isLoading:!1}):c.setState({error:J.UNEXPECTED,errorMessage:e.message,isLoading:!1}))})));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=this;this.state.error===J.CHARACTER_NOT_FOUND?e=c.a.createElement(v.Trans,{id:"interface.characterParses.characterParses.errors.characterNotFoundDetails",components:[c.a.createElement("br",null),c.a.createElement("a",{href:"https://www.warcraftlogs.com/help/start/",target:"_blank",rel:"noopener noreferrer"}),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("a",{href:"https://discord.gg/AxphPxU",target:"_blank",rel:"noopener noreferrer"}),c.a.createElement("a",{href:"https://github.com/WoWAnalyzer/WoWAnalyzer",target:"_blank",rel:"noopener noreferrer"})]}):this.state.error===J.NOT_RESPONDING?e=c.a.createElement(v.Trans,{id:"interface.characterParses.characterParses.errors.notRespondingDetails",components:[c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement(b.b,{to:"/"}),c.a.createElement("br",null),c.a.createElement("br",null)]}):this.state.error===J.CHARACTER_HIDDEN?e=c.a.createElement(v.Trans,{id:"interface.characterParses.characterParses.errors.characterHiddenDetails",components:[c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("a",{href:"https://www.warcraftlogs.com/help/hidingcharacters/",target:"_blank",rel:"noopener noreferrer"})]}):this.state.error===J.WCL_API_ERROR||this.state.error===J.UNKNOWN_API_ERROR||this.state.error===J.UNEXPECTED?e=c.a.createElement(v.Trans,{id:"interface.characterParses.characterParses.errors.details",values:{0:this.state.errorMessage},components:[c.a.createElement("a",{href:"https://discord.gg/AxphPxU",target:"_blank",rel:"noopener noreferrer"}),c.a.createElement("a",{href:"https://github.com/WoWAnalyzer/WoWAnalyzer",target:"_blank",rel:"noopener noreferrer"})]}):this.state.error!==J.NO_PARSES_FOR_TIER&&0!==this.filterParses.length||(e=c.a.createElement(v.Trans,{id:"interface.characterParses.characterParses.errors.noParsesForTierDetails",components:[c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("a",{href:"https://www.warcraftlogs.com/help/start/",target:"_blank",rel:"noopener noreferrer"})]}));var a="https://worldofwarcraft.com/en-".concat(this.props.region,"/character/").concat(this.state.realmSlug,"/").concat(this.props.name);return"CN"===this.props.region&&(a="https://www.wowchina.com/zh-cn/character/".concat(this.state.realmSlug,"/").concat(this.props.name)),c.a.createElement("div",{className:"results"},c.a.createElement("header",null,c.a.createElement("div",{className:"background"},c.a.createElement("div",{className:"img",style:{backgroundImage:"url(".concat(this.state.image,")"),backgroundPosition:"center center"}})),c.a.createElement("div",{className:"info container"},c.a.createElement("div",{className:"boss"},c.a.createElement("a",{href:"https://www.warcraftlogs.com/character/".concat(this.props.region,"/").concat(this.state.realmSlug,"/").concat(this.props.name),target:"_blank",rel:"noopener noreferrer",className:"btn",style:{fontSize:22}},c.a.createElement(C.a,null)," Warcraft Logs"),c.a.createElement("br",null),c.a.createElement("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"btn",style:{fontSize:22}},c.a.createElement(j.a,null)," Armory"),c.a.createElement("br",null),"CN"!==this.props.region&&c.a.createElement("a",{href:"https://www.wipefest.net/character/".concat(this.props.name,"/").concat(this.state.realmSlug,"/").concat(this.props.region),target:"_blank",rel:"noopener noreferrer",className:"btn",style:{fontSize:22}},c.a.createElement(T.a,null)," Wipefest")),c.a.createElement("div",{className:"player"},c.a.createElement("div",{className:"avatar"},c.a.createElement("img",{src:this.state.avatarImage,alt:""})),c.a.createElement("div",{className:"details"},c.a.createElement("h2",null,this.props.region," - ",this.props.realm),c.a.createElement("h1",{className:"name"},this.props.name)))),c.a.createElement("nav",null,c.a.createElement("div",{className:"container"},c.a.createElement("ul",null,c.a.createElement("li",null,"Raid",c.a.createElement("select",{className:"form-control",value:this.state.activeZoneID,onChange:function(e){return t.updateZoneMetricBoss(Number(e.target.value),t.state.metric,0)}},Object.values(N.a).reverse().map((function(e){return c.a.createElement("option",{key:e.id,value:e.id},e.name)})))),c.a.createElement("li",null,"Boss",c.a.createElement("select",{className:"form-control",value:this.state.activeEncounter,onChange:function(e){return t.setState({activeEncounter:e.target.value})}},c.a.createElement("option",{value:0,defaultValue:!0},"All bosses"),this.zoneBosses.map((function(e){return c.a.createElement("option",{key:e.id,value:e.name},e.name)})))),c.a.createElement("li",null,"Metric",c.a.createElement("select",{className:"form-control",value:this.state.metric,onChange:function(e){return t.updateZoneMetricBoss(t.state.activeZoneID,e.target.value,t.state.activeEncounter)}},c.a.createElement("option",{defaultValue:!0,value:"dps"},"DPS"),c.a.createElement("option",{value:"hps"},"HPS"))),c.a.createElement("li",null,"Sort by",c.a.createElement("select",{className:"form-control",value:this.state.sortBy,onChange:function(e){return t.setState({sortBy:Number(e.target.value)})}},c.a.createElement("option",{defaultValue:!0,value:X},"Date"),c.a.createElement("option",{value:q},"DPS / HPS"),c.a.createElement("option",{value:G},"Percentile"))))))),c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-md-12"},c.a.createElement("div",{className:"panel character-filters"},this.state.specs.map((function(e,a){return c.a.createElement("div",{key:a,onClick:function(){return t.updateSpec(e.replace(" ",""))},className:t.state.activeSpec.includes(e.replace(" ",""))?"selected spec-filter character-filter":"spec-filter character-filter",style:{backgroundImage:"url(".concat(t.iconPath(e),")")}},e)})),Object.values(O.a).map((function(e){return c.a.createElement("div",{key:e,onClick:function(){return t.updateDifficulty(e)},className:t.state.activeDifficultyIds.includes(e)?"selected diff-filter character-filter":"diff-filter character-filter"},Object(O.b)(e))}))))),c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-md-12"},this.state.error&&c.a.createElement("span",null,c.a.createElement(b.b,{to:"/"},c.a.createElement(v.Trans,{id:"interface.characterParses.characterParses.home"}))," ",">"," ",c.a.createElement("span",null,this.props.region," > ",this.props.realm," >"," ",this.props.name),c.a.createElement("br",null),c.a.createElement("br",null)),c.a.createElement("div",{className:"panel",style:{overflow:"auto"}},!this.state.isLoading&&c.a.createElement("div",{className:"panel-heading"},c.a.createElement("div",{className:"pull-right"},c.a.createElement(b.b,{to:"",onClick:function(e){e.preventDefault(),t.load(!0)}},c.a.createElement("span",{className:"glyphicon glyphicon-refresh","aria-hidden":"true"})," ",c.a.createElement(v.Trans,{id:"interface.characterParses.characterParses.refresh"}))),c.a.createElement("h1",{style:{display:"inline-block"}},this.state.error?L.b._(this.state.error):c.a.createElement(v.Trans,{id:"interface.characterParses.characterParses.parses"})),c.a.createElement("small",null,c.a.createElement(v.Trans,{id:"interface.characterParses.characterParses.parsesDetails"}))),c.a.createElement("div",{className:"panel-body"},c.a.createElement("div",{className:"flex-main",style:{padding:e?20:0}},this.state.isLoading&&!this.state.error&&c.a.createElement("div",{style:{textAlign:"center",fontSize:"2em",margin:"20px 0"}},c.a.createElement(I.a,{text:c.a.createElement(v.Trans,{id:"interface.characterParses.characterParses.fetchingLogs"})})),!this.state.isLoading&&e,!this.state.isLoading&&c.a.createElement(K,{parses:this.filterParses,class:this.state.class,metric:this.state.metric,trinkets:this.state.trinkets}))))))))}},{key:"filterParses",get:function(){var e=this,t=this.state.parses;return t=t.filter((function(t){return e.state.activeDifficultyIds.includes(t.difficulty)})).filter((function(t){return e.state.activeSpec.includes(t.spec)})).sort((function(t,a){return e.state.sortBy===X?a.start_time-t.start_time:e.state.sortBy===q?a.persecondamount-t.persecondamount:a.historical_percent-t.historical_percent})),0===Number(this.state.activeEncounter)?t.slice(0,100):(t=t.filter((function(t){return t.name===e.state.activeEncounter}))).slice(0,100)}},{key:"zoneBosses",get:function(){var e=this;return N.a.find((function(t){return t.id===e.state.activeZoneID})).encounters}}]),r}(c.a.Component),Y=Object(y.b)(null,{appendReportHistory:_.b})(Q),$=function(e){var t=e.region,a=e.realm,n=e.name,l=Object(r.a)(e,["region","realm","name"]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(s.a,{title:"".concat(n,"-").concat(a," (").concat(t,")")}),c.a.createElement(i.a,null),c.a.createElement(Y,Object.assign({region:t,realm:a,name:n},l)))}},892:function(e,t,a){"use strict";function r(e){return e<.25?"parse-grey":e<.5?"parse-green":e<.75?"parse-blue":e<.95?"parse-purple":e<1?"parse-orange":e>=1?"parse-artifact":"parse-none"}a.d(t,"a",(function(){return r}))},925:function(e,t,a){"use strict";t.a=[{id:26,name:"Castle Nathria",frozen:!1,brackets:{min:173,max:230,bucket:3,type:"Item Level"},encounters:[{id:2398,name:"Shriekwing",npcID:164406},{id:2418,name:"Huntsman Altimor",npcID:165066},{id:2383,name:"Hungering Destroyer",npcID:164261},{id:2402,name:"Sun King's Salvation",npcID:168973},{id:2405,name:"Artificer Xy'mox",npcID:166644},{id:2406,name:"Lady Inerva Darkvein",npcID:165521},{id:2412,name:"The Council of Blood",npcID:166969},{id:2399,name:"Sludgefist",npcID:164407},{id:2417,name:"Stone Legion Generals",npcID:168113},{id:2407,name:"Sire Denathrius",npcID:167406}]}]}}]);
//# sourceMappingURL=CharacterPage.2851137b.chunk.js.map