{"version":3,"sources":["parser/monk/mistweaver/modules/core/GlobalCooldown.tsx","parser/monk/mistweaver/modules/core/Channeling.tsx","parser/monk/mistweaver/modules/core/HotTrackerMW.tsx","parser/monk/mistweaver/normalizers/HotApplicationNormalizer.tsx","parser/monk/mistweaver/normalizers/HotRemovalNormalizer.tsx","parser/monk/mistweaver/modules/features/Abilities.tsx","parser/monk/mistweaver/modules/features/CooldownThroughputTracker.tsx","parser/monk/mistweaver/modules/features/AlwaysBeCasting.tsx","parser/monk/mistweaver/modules/features/EssenceFontMastery.tsx","parser/monk/mistweaver/modules/spells/EssenceFont.tsx","parser/monk/mistweaver/modules/talents/RefreshingJadeWind.tsx","parser/monk/mistweaver/modules/talents/ChiBurst.js","parser/monk/mistweaver/constants.ts","parser/monk/mistweaver/modules/talents/SpiritOfTheCrane.tsx","parser/monk/mistweaver/modules/talents/ManaTea.tsx","parser/monk/mistweaver/modules/talents/Lifecycles.tsx","parser/monk/mistweaver/modules/spells/ThunderFocusTea.tsx","parser/monk/mistweaver/modules/spells/Vivify.tsx","parser/monk/mistweaver/modules/talents/RenewingMistDuringManaTea.tsx","parser/monk/mistweaver/modules/spells/SpinningCraneKick.tsx","parser/monk/mistweaver/modules/talents/JadeSerpentStatue.tsx","parser/monk/mistweaver/modules/talents/Tier45Comparison.tsx","parser/monk/mistweaver/modules/features/Checklist/Component.tsx","parser/monk/mistweaver/modules/spells/SoothingMist.tsx","parser/monk/mistweaver/modules/spells/EnvelopingBreath.tsx","parser/monk/mistweaver/modules/features/Checklist/Module.tsx","parser/monk/mistweaver/modules/features/StatValuesSpellInfo.tsx","parser/monk/mistweaver/modules/features/StatValues.tsx","parser/monk/mistweaver/modules/features/EvmVivCastRatio.tsx","parser/monk/mistweaver/modules/spells/EnvelopingMists.tsx","parser/monk/mistweaver/modules/spells/RenewingMist.tsx","parser/monk/mistweaver/modules/spells/ExpelHarm.tsx","parser/monk/mistweaver/modules/features/MasteryStats.tsx","parser/monk/mistweaver/modules/features/Buffs.tsx","parser/monk/mistweaver/modules/spells/LifeCocoon.tsx","parser/monk/mistweaver/modules/spells/InvokeYulon.tsx","parser/monk/mistweaver/modules/talents/InvokeChiJi.tsx","parser/monk/mistweaver/modules/talents/RisingMist.js","parser/monk/mistweaver/modules/talents/AverageTimeBetweenRSKs.tsx","parser/monk/mistweaver/modules/talents/Upwelling.tsx","parser/monk/mistweaver/modules/features/MistweaverHealingEfficiencyDetails.tsx","parser/monk/mistweaver/modules/features/MistweaverHealingEfficiencyTracker.tsx","parser/monk/mistweaver/modules/features/EssenceFontHealingBreakdown.tsx","parser/monk/shared/modules/conduits/GroundingBreath.js","parser/monk/shared/modules/conduits/HarmDenial.js","parser/monk/shared/modules/conduits/FortifyingIngredients.js","parser/monk/mistweaver/modules/shadowlands/conduits/JadeBond.tsx","parser/monk/mistweaver/modules/shadowlands/conduits/NourishingChi.tsx","parser/monk/mistweaver/modules/shadowlands/conduits/RisingSunRevival.tsx","parser/monk/shared/modules/conduits/ImbuedReflections.js","parser/monk/mistweaver/modules/shadowlands/legendaries/TearofMorning.tsx","parser/monk/mistweaver/modules/shadowlands/legendaries/AncientTeachingsoftheMonastery.tsx","parser/monk/mistweaver/modules/shadowlands/legendaries/CloudedFocus.tsx","parser/monk/mistweaver/CombatLogParser.ts","interface/statistics/components/BoringSpellValueText/index.tsx","parser/core/calculateEffectiveDamage.js","interface/statistics/components/BoringValueText/index.tsx","parser/core/calculateEffectiveHealing.js","parser/shared/modules/resources/resourcetracker/ResourceTracker.ts","common/ResourceIcon.tsx","common/ResourceLink.tsx","../node_modules/react-animate-height/lib/AnimateHeight.js","interface/statistics/components/DonutChart/index.js","interface/others/StatisticsListBox.js","parser/shared/ExecuteHelper.ts","parser/core/healingEfficiency/ManaTracker.ts","parser/core/healingEfficiency/HealingEfficiencyTracker.ts","interface/PerformanceBar.tsx","parser/shared/modules/features/images/QE-Logo-New-Small.png","parser/core/healingEfficiency/HealingEfficiencyBreakdown.tsx","interface/others/StatisticWrapper.js","parser/shared/modules/features/SpellInfo.js","parser/shared/modules/features/BaseHealerStatValues.js","interface/ItemManaGained/ItemManaGained.tsx","parser/core/healingEfficiency/HealingEfficiencyDetails.tsx","parser/monk/shared/modules/spells/TouchOfDeath.js","parser/monk/shared/modules/covenants/FallenOrder.tsx","parser/shared/modules/HotTracker.js"],"names":["GlobalCooldown","event","ability","guid","SPELLS","CRACKLING_JADE_LIGHTNING","id","SOOTHING_MIST","ESSENCE_FONT","CoreGlobalCooldown","Channeling","options","addEventListener","Events","applydebuff","by","SELECTED_PLAYER","spell","onApplyDebuff","removedebuff","onRemoveDebuff","removebuff","onRemoveBuff","this","beginChannel","isChannelingSpell","log","_currentChannel","name","endChannel","CoreChanneling","HotTrackerMW","mistwrapActive","upwellingActive","selectedCombatant","owner","hasTalent","MIST_WRAP_TALENT","UPWELLING_TALENT","spellId","ENVELOPING_MIST","ESSENCE_FONT_BUFF","hasBuff","THUNDER_FOCUS_TEA","RENEWING_MIST_HEAL","REM_BASE_DURATION","duration","tickPeriod","maxDuration","calculateMaxDuration","bouncy","durationConditions","calculateMaxRemDuration","HotTracker","HotApplicationNormalizer","instantTickHotIds","events","fixedEvents","forEach","eventIndex","push","type","EventType","ApplyBuff","includes","castTimestamp","timestamp","targetID","previousEventIndex","previousEvent","Heal","splice","__modified","EventsNormalizer","HotRemovalNormalizer","RemoveBuff","Abilities","combatant","RENEWING_MIST","category","SPELL_CATEGORIES","ROTATIONAL","cooldown","charges","gcd","base","castEfficiency","suggestion","timelineSortIndex","COOLDOWNS","MANA_TEA_TALENT","enabled","CHI_BURST_TALENT","CHI_WAVE_TALENT","LIFE_COCOON","REVIVAL","INVOKE_YULON_THE_JADE_SERPENT","INVOKE_CHIJI_THE_RED_CRANE_TALENT","OTHERS","VIVIFY","REFRESHING_JADE_WIND_TALENT","SUMMON_JADE_SERPENT_STATUE_TALENT","EXPEL_HARM","DIFFUSE_MAGIC_TALENT","buffSpellId","DEFENSIVE","DAMPEN_HARM_TALENT","FORTIFYING_BREW","HEALING_ELIXIR_TALENT","UTILITY","DETOX","PARALYSIS","RING_OF_PEACE_TALENT","LEG_SWEEP","TIGER_TAIL_SWEEP_TALENT","ROLL","CELERITY_TALENT","CHI_TORPEDO_TALENT","TIGERS_LUST_TALENT","static","TRANSCENDENCE","TRANSCENDENCE_TRANSFER","TIGER_PALM","HEALER_DAMAGING_SPELL","BLACKOUT_KICK","haste","RISING_SUN_KICK","RISING_MIST_TALENT","SPINNING_CRANE_KICK","CoreAbilities","CooldownThroughputTracker","CoreCooldownThroughputTracker","cooldownSpells","summary","BUILT_IN_SUMMARY_TYPES","HEALING","OVERHEALING","MANA","ignoredSpells","CHI_BURST_HEAL","REFRESHING_JADE_WIND_HEAL","AlwaysBeCasting","when","nonHealingTimePercentage","isGreaterThan","nonHealingTimeSuggestionThresholds","minor","addSuggestion","suggest","actual","recommended","icon","i18n","_","formatPercentage","regular","average","major","downtimePercentage","downtimeSuggestionThresholds","style","ThresholdStyle","PERCENTAGE","CoreAlwaysBeCastingHealing","HEALING_ABILITIES_ON_GCD","EssenceFontMastery","healEF","healing","castEF","gustHeal","hasUpwelling","secondGustHealing","secondGustOverheal","combatants","heal","GUSTS_OF_MISTS","gustHealing","cast","efCast","targetId","players","sourceID","amount","absorbed","suggestionThresholds","SpellLink","avgMasteryCastsPerEF","toFixed","efMasteryCasts","avgEFMasteryHealing","StatisticBox","position","STATISTIC_ORDER","OPTIONAL","SpellIcon","value","label","Tooltip","content","formatNumber","isLessThan","DECIMAL","Analyzer","dependencies","Combatants","EssenceFont","totalHealing","totalOverhealing","totalAbsorbs","targetsEF","efHotHeal","efHotOverheal","targetOverlap","uniqueTargets","Set","total","castEssenceFont","handleEssenceFont","handleEssenceFontBuff","applybuff","applyEssenceFontBuff","refreshbuff","refreshEssenceFontBuff","size","clear","overheal","tick","add","avgTargetsHitPerEF","averageHits","postion","NUMBER","RefreshingJadeWind","healsRJW","healingRJW","overhealingRJW","castRJW","active","rjwBuff","rjwHeal","avgTargetsHitPerRJWPercentage","ChiBurst","castChiBurst","targetsChiBurst","raidSize","Object","keys","length","onCast","onHeal","fightend","onFightend","avgTargetsHitPerCB","ABILITIES_AFFECTED_BY_HEALING_INCREASES","LEECH","conduitScaling","rankOne","requiredRank","scalingFactor","SpiritOfTheCrane","castsTp","buffTotm","castsBk","lastTotmBuffTimestamp","totmOverCap","totmBuffWasted","totalTotmBuffs","manaReturnSotc","sotcWasted","SPIRIT_OF_THE_CRANE_TALENT","TEACHINGS_OF_THE_MONASTERY","firstStack","applybuffstack","gainStacks","lostStacks","energize","SPIRIT_OF_THE_CRANE_BUFF","stacksToMana","tigerPalm","blackoutKick","resourceChange","waste","manaReturn","Statistic","STATISTIC_CATEGORY","TALENTS","tooltip","BoringValueText","fightDuration","SOTC_MANA_PER_SECOND_RETURN_MINOR","ManaTea","manaSavedMT","manateaCount","casts","Map","effectiveHealing","overhealing","abilityTracker","handleCast","applyBuff","manaEvent","classResources","find","resource","RESOURCE_TYPES","undefined","cost","has","set","get","avgMtSaves","suggestionThresholdsOverhealing","avgOverhealing","arrayOfKeys","Array","from","formatThousands","map","key","parseFloat","AbilityTracker","Lifecycles","manaSaved","manaSavedViv","manaSavedEnm","castsRedEnm","castsRedViv","castsNonRedViv","castsNonRedEnm","LIFECYCLES_TALENT","vivifyCast","envelopingMistCast","INNERVATE","LIFECYCLES_VIVIFY_BUFF","manaCost","LIFECYCLES_ENVELOPING_MIST_BUFF","chijiStacksAtEnvCast","getBuff","INVOKE_CHIJI_THE_RED_CRANE_BUFF","stacks","modifiedManaCost","calculateEnvManaSaved","LC_MANA_PER_SECOND_RETURN_MINOR","ThunderFocusTea","castsTftRsk","castsTftViv","castsTftEnm","castsTftRem","castsTft","castsUnderTft","correctCasts","castBufferTimestamp","ftActive","rmActive","FOCUSED_THUNDER_TALENT","tftCast","buffedCast","items","color","DonutChart","incorrectTftCasts","CORE","className","renderCastRatioChart","Vivify","remVivifyHealCount","remVivifyHealing","gustsHealing","lastCastTarget","remDuringManaTea","numberToCount","vivCast","handleViv","handleMastery","averageRemPerVivify","getAbility","healingEffective","vivifyCasts","RenewingMistDuringManaTea","vivify","manaTea","avgRemDuringMT","SpinningCraneKick","goodSCKcount","goodSCKTimeList","badSCKcount","badSCKTimeList","canceledSCKcount","enemiesHitSCK","currentTime","castSpinningCraneKick","damage","handleSpinningCraneKick","fightEnd","checkSCK","currentTimestamp","fight","start_time","enemy","targetInstance","formatMilliseconds","JadeSerpentStatue","overHealing","soothingMistUptime","lastBuffApplyTimestamp","jssCasting","SELECTED_PLAYER_PET","SOOTHING_MIST_STATUE","jssHeal","jssApplyBuff","jssRemoveBuff","jssRefreshBuff","endFight","end_time","jadeSerpentStatueUptime","Tier45Comparison","manatea","selected","manaFrom","best","requiredPerTea","lifecycles","requiredVivs","requiredEnvs","sotc","requiredTps","talents","returnedFromSelected","manaTracker","spiritOfTheCrane","lifeCycles","generateSotc","generateManaTea","generateLifeCycles","calculateOthers","Math","ceil","maxResource","manaPercRed","fightLength","manaTeasPossible","BLACKOUT_KICK_TOTM","damageHits","manaRet","totalManaSpent","envCasts","vivCasts","manaDiscountOnViv","min","manaSpent","lastMana","resourceUpdates","used","abs","current","dropdown","isEqual","BOOLEAN","ManaTracker","MistweaverMonkChecklist","thresholds","AbilityRequirement","props","GenericCastEfficiencyRequirement","getCastEfficiencyForSpellId","Rule","description","Requirement","href","target","rel","renewingMistDuringManaTea","TOUCH_OF_DEATH","ENVELOPING_BREATH","envelopingBreath","ARCANE_TORRENT_MANA1","essenceFont","refreshingJadeWind","chiBurst","spinningCraneKick","tier45Comparison","manaTeaOverhealing","jadeSerpentStatue","thunderFocusTea","essenceFontMastery","soothingMist","ResourceLink","manaLeft","PreparationRule","SoothingMist","soomTicks","gustProc","lastSoomTickTimestamp","startStamp","endStamp","soomInProgress","castsInSoom","badSooms","totalSoomCasts","assumedGCD","startGCD","channeling","statTracker","castSoothingMist","castDuringSoothingMist","handleSoothingMist","masterySoothingMist","removeBuffSoothingMist","end","checkChannelTiming","hastePercentage","currentHasteRating","max","staticImportance","SUGGESTION_IMPORTANCE","MAJOR","suggestionThresholdsCasting","soomTicksPerDuration","soomThresholds","StatTracker","EnvelopingBreath","envsDuringCelestial","envBreathsApplied","chijiActive","envBIncrease","handleEnvelopingBreathHeal","handleEnvelopingBreathCount","handleEnvelopingMist","death","to","handleChijiDeath","handleChijiSummon","sourceId","calculateEffectiveHealing","averageEnvBPerEnv","GENERAL","BoringSpellValueText","Checklist","manaValues","preparationRuleAnalyzer","alwaysBeCasting","Component","BaseChecklist","CastEfficiency","ManaValues","PreparationRuleAnalyzer","int","crit","hasteHpm","hasteHpct","mastery","vers","ENVELOPING_MIST_TFT","RISING_MIST_HEAL","ANCIENT_TEACHINGS_OF_THE_MONASTERY_HEAL","GUST_OF_MISTS_CHIJI","SOOTHING_BREATH","EXPEL_HARM_TARGET_HEAL","hastHpm","TEAR_OF_MORNING_HEAL","FALLEN_ORDER_ENVELOPING_MIST","FALLEN_ORDER_SOOTHING_MIST","FAELINE_STOMP_HEAL","FAELINE_STOMP_ESSENCE_FONT","WEAPONS_OF_ORDER_BUFF_AND_HEAL","BONEDUST_BREW_HEAL","BONEDUST_BREW_GUST_OF_MIST","StatValues","spellInfo","SPELL_INFO","qeLive","critEffectBonus","healVal","effective","masteryPercentage","currentMasteryRating","STAT","INTELLECT","CRITICAL_STRIKE","stat","HASTE_HPCT","HASTE_HPM","MASTERY","VERSATILITY","VERSATILITY_DR","BaseHealerStatValues","CritEffectBonus","CastRatio","evmCasts","UNAFFECTED_SPELLS","EnvelopingMists","healingIncrease","evmHealingIncrease","castEnvelopingMist","masteryEnvelopingMist","RenewingMist","healingHits","castRenewingMist","handleGustsOfMists","handleRenewingMist","ExpelHarm","selfHealing","selfOverheal","targetHealing","targetOverheal","sourceTarget","handleExpelHarm","handleTargetExpelHarm","MasteryStats","envelopingMists","renewingMist","expelHarm","valueTooltip","renderMasterySourceChart","Buffs","timelineHighlight","BLOODLUST_BUFFS","item","Number","CoreBuffs","LifeCocoon","cocoonBuff","ItemHealingDone","InvokeYulon","soothHealing","envelopHealing","handleEnvelopingBreath","handleSoothingBreath","InvokeChiJi","chijiStackCount","castsBelowMaxStacks","wastedStacks","freeCasts","missedGlobals","chijiStart","chijiGlobals","chijiUses","lastGlobal","efGcd","checkForSckDamage","handleGust","handleEnvelopCast","handleChijiStart","RISING_SUN_KICK_SECOND","SPINNING_CRANE_KICK_DAMAGE","handleStackGenerator","handleGlobal","EndChannel","handleEssenceFontEnd","start","stackCount","MAX_STACKS","RisingMist","risingMistCount","risingMists","efsExtended","remCount","efCount","evmCount","targetCount","trackUplift","extraVivCleaves","extraVivHealing","extraVivOverhealing","extraVivAbsorbed","extraEnvHits","extraEnvBonusHealing","extraMasteryHits","extraMasteryhealing","extraMasteryOverhealing","extraMasteryAbsorbed","masteryTickTock","extraEFhealing","extraEFOverhealing","extraEFAbsorbed","extendHots","handleVivify","calculateEvn","reduce","acc","risingMist","array","hotTracker","hotHistory","i","healingAfterOriginalEnd","hotHealing","directHealing","hots","originalEnd","object","hot","newRisingMist","procs","foundEf","foundTarget","playerId","spellIdString","attribution","addExtension","averageExtension","calculateVivOverHealing","calculateMasteryOverHealing","getPercentageOfTotalHealingDone","spellUsable","SpellUsable","TimeBetweenRSKs","totalRSKCasts","firstRSKTimestamp","lastRSKTimestamp","onRSK","averageTimeBetweenRSKSeconds","rskWindow","Upwelling","extraHots","extraBolts","boltCount","totalBolts","hotMap","masteryHit","masteryHealing","masteryOverhealing","masteryAbsorbed","efHeal","efcast","removeBuff","hotHeal","boltHeal","fullCount","applicationTime","holder","delete","overhealingBolt","overhealingHot","overhealingMastery","totalHealingAll","MistweaverHealingEfficiencyDetails","healingEfficiencyTracker","Panel","title","explanation","pad","HealingEfficiencyBreakdown","tracker","HealingEfficiencyDetails","HealingEfficiencyTracker","MistweaverHealingEfficiencyTracker","healingDone","damageDone","abilities","getEssenceFontDetails","getEnvelopingMistsDetails","getSoothingMistDetails","getRenewingMistDetails","getVivifyDetails","getRefreshingJadeWindDetails","getRisingSunKickDetails","getYulonDetails","getChijiDetails","getExpelHarmDetails","byAbility","overhealingDone","HealingDone","DamageDone","EssenceFontHealingBreakdown","renderEssenceFontChart","GroundingBreath","args","resourceReturned","healingBoost","vivifyBoost","GROUNDING_BREATH_MANA_RETURN","GROUNDING_BREATH_ENERGY_RETURN","onResourceRefund","COVENANTS","GROUNDING_BREATH","ItemManaGained","HarmDenial","bonusDamage","extraHealing","bonusHealing","HARM_DENIAL","ItemDamageDone","FortifyingIngredients","shield","FORTIFYING_INGREDIENTS","JadeBond","cooldownReductionUsed","cooldownReductionWasted","spellToReduce","conduitRank","conduitRankBySpellID","JADE_BOND","gustProcingSpell","normalizeBoost","isOnCooldown","reduceCooldown","NourishingChi","boost","NOURISHING_CHI","bonusHeal","NOURISHING_CHI_BUFF","RisingSunRevival","RISING_SUN_REVIVAL","rskCast","RISING_SUN_REVIVAL_HEAL","ImbuedReflections","cloneIDs","summon","FALLEN_ORDER_OX_CLONE","FALLEN_ORDER_TIGER_CLONE","FALLEN_ORDER_CRANE_CLONE","trackSummons","normalizeHealingBoost","FALLEN_ORDER_KEG_SMASH","FALLEN_ORDER_BREATH_OF_FIRE","BREATH_OF_FIRE_DEBUFF","normalizeDamageBoost","FALLEN_ORDER_SPINNING_CRANE_KICK","FISTS_OF_FURY_DAMAGE","MELEE","handleMelee","IMBUED_REFLECTIONS","TearofMorning","vivHealing","envHealing","envbHealing","numberOExtendLifes","TEAR_OF_MORNING_BUFF","manageBuffApplied","manageBuffRemoved","envelopingMistHealing","envelopingBreathHealing","vivifyHealing","vivRatio","envRatio","envbRatio","renderDonutChart","AncientTeachingsoftheMonastery","damageSpellToHealing","lastDamageSpellID","lastDamageEvent","ANCIENT_TEACHINGS_OF_THE_MONASTERY_CRIT_HEAL","ANCIENT_TEACHINGS_OF_THE_MONASTERY_BUFF","oldHealingTotal","rskHealing","bokHealing","totmHealing","tpHealing","CloudedFocus","CLOUDED_FOCUS_BUFF","applyBuffStack","calculateManaEffect","calculateHealingEffect","rawResourceCost","stack","CombatLogParser","CoreCombatLogParser","abilitiesAffectedByHealingIncreases","specModules","hotApplicationNormalizer","hotRemovalNormalizer","lowHealthHealing","LowHealthHealing","globalCooldown","hotTrackerMW","manaLevelChart","ManaLevelChart","manaUsageChart","ManaUsageChart","cooldownThroughputTracker","checklist","statValues","evmVivCastRatio","EvmVivCastRatio","masteryStats","buffs","essenceFontHealingBreakDown","averageTimeBetweenRSKSs","AverageTimeBetweenRSKSs","lifeCocoon","touchOfDeath","TouchOfDeath","invokeYulon","upwelling","invokeChiJi","hpmDetails","hpmTracker","fallenOrder","FallenOrder","groundingBreath","harmDenial","fortifyingIngredients","jadeBond","nourishingChi","risingSunRevival","imbuedReflections","tearofMorning","ancientTeachingsoftheMonastery","cloudedFocus","children","calculateEffectiveDamage","increase","raw","BoringValue","relativeHealIncrease","ResourceTracker","eventEmitter","buildersObj","spendersObj","onEnergize","generated","wasted","spent","spentByCast","resourceChangeType","gain","_applyBuilder","getResource","maxGain","initBuilderAbility","shouldProcessCastEvent","eventResource","getReducedCost","initSpenderAbility","triggerSpendEvent","resourceCost","r","fabricatedEvent","SpendResource","__fabricated","fabricateEvent","Boolean","values","EventEmitter","ResourceIcon","noLink","others","alt","useState","elem","setElem","useEffect","TooltipProvider","refresh","other","ref","defineProperty","exports","_typeof","Symbol","iterator","obj","constructor","prototype","_extends","assign","arguments","source","hasOwnProperty","call","_createClass","defineProperties","descriptor","enumerable","configurable","writable","Constructor","protoProps","staticProps","_react2","_interopRequireDefault","require","_propTypes2","_classnames2","__esModule","default","_defineProperty","ANIMATION_STATE_CLASSES","animating","animatingUp","animatingDown","animatingToHeightZero","animatingToHeightAuto","animatingToHeightSpecific","staticHeightZero","staticHeightAuto","staticHeightSpecific","PROPS_TO_OMIT","omit","_len","_key","res","objectKeys","indexOf","cancelAnimationFrames","requestAnimationFrameIDs","cancelAnimationFrame","isNumber","n","isNaN","isFinite","isPercentage","height","search","substr","runCallback","callback","params","AnimateHeight","_React$Component","instance","TypeError","_classCallCheck","_this","self","ReferenceError","_possibleConstructorReturn","__proto__","getPrototypeOf","animationFrameIDs","overflow","animationStateClasses","getStaticStateClasses","state","shouldUseTransitions","subClass","superClass","create","setPrototypeOf","_inherits","contentElement","hideContent","prevProps","prevState","_this2","_props","delay","onAnimationEnd","onAnimationStart","_cx","showContent","contentHeight","offsetHeight","totalDuration","newHeight","timeoutState","isCurrentHeightAuto","timeoutAnimationStateClasses","setState","clearTimeout","timeoutID","animationClassesTimeoutID","requestAnimationFrame","startAnimationHelper","setTimeout","display","_cx2","_cx3","_this3","_props2","animateOpacity","applyInlineTransitions","contentClassName","easing","_state","componentStyle","transition","WebkitTransition","contentStyle","opacity","componentClasses","ariaHidden","createElement","apply","concat","el","propTypes","bool","any","isRequired","string","number","propName","componentName","func","defaultProps","sum","index","background","chartSize","innerRadiusFactor","data","spec","mark","innerRadius","encoding","theta","field","legend","scale","domain","range","view","stroke","width","renderLegend","renderChart","React","PureComponent","StatisticsListBox","bodyStyle","ExecuteHelper","inExecuteWindow","inHealthExecuteWindow","executeWindowStart","lastExecuteHitTimestamp","totalExecuteWindowDuration","castsWithExecute","executeSources","onGeneralDamage","executeSpells","onExecuteCast","onExecuteDamage","executeOutsideRangeEnablers","applyExecuteEnablerBuff","removeExecuteEnablerBuff","onFightEnd","hitPoints","maxHitPoints","lowerThreshold","upperThreshold","isTargetInExecuteRange","isTargetInReverseExecuteRange","usable","allOnCD","targetIsFriendly","areExecuteSpellsOnCD","isExecuteUsableOutsideExecuteRange","isTargetInHealthExecuteWindow","modifiesDamage","damageModifier","healingSpellIds","damageAbsorbed","manaGained","percentOverhealingDone","percentHealingDone","percentDamageDone","manaPercentSpent","hpm","dpm","timeSpentCasting","percentTimeSpentCasting","hpet","dpet","healingAbsorbed","healingOverheal","healingSpellId","healingAbility","damageEffective","spenders","getCustomSpellStats","getTimeSpentCasting","gcdSpent","includeCooldowns","spells","topHpm","topDpm","topHpet","topDpet","getSpellStats","healSpellIds","PerformanceBar","percent","backgroundColor","colorForPerformance","module","HealingEfficiencyTable","getAllSpellStats","showCooldowns","spellArray","sort","a","b","showHealing","spellRows","spellDetail","HealingEfficiencySpellRow","detailedView","DetailView","BarView","BarHeader","render","colSpan","hasHealing","hasDamage","barWidth","DetailHeader","hasOverhealing","floor","formatDuration","marginRight","defaultChecked","icons","onChange","checked","htmlFor","marginLeft","StatisticWrapper","multiplier","HEALTHSTONE","MARK_OF_THE_ANCIENT_PRIESTESS","fallbackSpellInfo","sharedSpellInfo","CORE_SPELL_INFO","mentioned","totalAdjustedHealing","totalOneInt","totalOneCrit","totalOneHasteHpct","totalOneHasteHpm","totalOneMastery","totalOneVers","totalOneVersDr","totalOneLeech","playerHealthMissing","scaleWeightsWithHealth","moreInformationLink","onAbsorb","onHealTaken","onDamageTaken","specSpecific","shared","HealingValue","_handleHealEvent","absorb","_getSpellInfo","targetHealthPercentage","_handleHeal","eventForWeights","_adjustGain","ignored","_leech","_intellect","_criticalStrike","_hasteHpct","_hasteHpm","_mastery","_versatility","mult","currentLeechPercentage","_leechHasLeech","_leechPrediction","currentLeechRating","toPlayer","healIncreaseFromOneLeech","statMultiplier","leech","ratingNeededForNextPercentage","statBaselineRatingPerPercent","healIncreaseFromOneInt","intellect","currentIntellectRating","rating","currentCritRating","baseCritChance","baseCritPercentage","ratingCritChance","hitType","HIT_TYPES","CRIT","_isCrit","_getCritChance","totalCritChance","ratingCritChanceContribution","critMult","getBonus","rawBaseHealing","effectiveCritHealing","currHastePerc","currentHastePercentage","healIncreaseFromOneHaste","HASTE","Error","currVersPerc","currentVersatilityPercentage","healIncreaseFromOneVers","versatility","currentVersatilityRating","_updateMissingHealth","damageVal","DamageValue","blocked","overkill","_versatilityDamageReduction","baseStats","itemLevel","hps","primary","calculatePrimaryStat","hpsPerIntellect","criticalStrike","calculateSecondaryStatDefault","hpsPerCriticalStrike","hpsPerHaste","hpsPerMastery","hpsPerVersatility","hpsPerLeech","oneRatingHealing","results","_prepareResults","urlParts","statValue","weight","_getGain","statName","getName","replace","join","data-place","Info","padding","margin","minWidth","fontWeight","row","_getTooltip","ratingForOne","_ratingPerOnePercent","Icon","getIcon","gainPerSecond","Infinity","informationIconTooltip","getClassNameColor","getNameTranslated","Information","hpsPerHasteHPCT","hpsPerHasteHPM","approximate","parser","Mana","contextTypes","PropTypes","maxCasts","MINUTE","adjustMaxCasts","recommendedEfficiency","totalExecuteDuration","windDamage","brewDamage","mistDamage","mistHealing","mistOverhealing","cloneMap","hasCovenant","VENTHYR","FALLEN_ORDER_CAST","mistHealingTracker","brewDamageTracker","windDamageTracker","cloneType","mistDamageTracker","totalDamage","bouncingHots","currentGuid","hotInfo","_generateHotInfo","hotList","_generateHotList","hotApplied","hotReapplied","hotRemoved","_getTarget","_validateHot","shift","hotDuration","newHot","ticks","attributions","extensions","boosts","att","effectOnCrit","oldEnd","freshDuration","_calculateExtension","clipped","ext","_tallyExtensions","_checkRemovalTime","tickClamps","pandemicClamps","timeOut","timeLeft","timeToAdd","finalAmount","existingExtension","extension","filter","_tallyExtension","now","foundEarlier","latestOutside","rawAmount","currentTimeRemaining","newTimeRemaining","pandemicMax","currentTickPeriod","newTicksRemaining","round","diff","getEntity","RefreshBuff","Haste"],"mappings":"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","file":"static/js/MistweaverMonk.1a0cc5e6.chunk.js","sourcesContent":["import SPELLS from 'common/SPELLS';\r\nimport { CastEvent } from 'parser/core/Events';\r\nimport CoreGlobalCooldown from 'parser/shared/modules/GlobalCooldown';\r\n\r\n/**\r\n * Crackling Jade Lightning has ticks marked as \"cast\", and we fix its channel in the CracklingJadeLightning module. This also fixes its GCD.\r\n */\r\nclass GlobalCooldown extends CoreGlobalCooldown {\r\n  onCast(event: CastEvent) {\r\n    if (event.ability.guid === SPELLS.CRACKLING_JADE_LIGHTNING.id || event.ability.guid === SPELLS.SOOTHING_MIST.id || event.ability.guid === SPELLS.ESSENCE_FONT.id) {\r\n      // Channeling fabricates fake `beginchannel` events for these abilities, that already takes care of the GCD.\r\n      return;\r\n    }\r\n    super.onCast(event);\r\n  }\r\n}\r\n\r\nexport default GlobalCooldown;\r\n","import SPELLS from 'common/SPELLS';\r\nimport Events, { ApplyDebuffEvent, CastEvent, RemoveBuffEvent, RemoveDebuffEvent } from 'parser/core/Events';\r\nimport Ability from 'parser/core/modules/Ability';\r\nimport CoreChanneling from 'parser/shared/modules/Channeling';\r\nimport { Options, SELECTED_PLAYER } from 'parser/core/Analyzer';\r\n\r\n/**\r\n * Crackling Jade Lightning don't reveal in the combatlog when channeling begins and ends, this fabricates the required events so that ABC can handle it properly.\r\n * Combatlog event order is messy, it often looks like:\r\n * 1. applydebuff Crackling Jade Lightning\r\n * 2. begincast/cast new spell\r\n * 3. removedebuff Crackling Jade Lightning\r\n * To avoid Crackling Jade Lightning as being marked \"canceled\" when we start a new spell we mark it as ended instead on the begincast/cast.\r\n */\r\nclass Channeling extends CoreChanneling {\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.addEventListener(Events.applydebuff.by(SELECTED_PLAYER).spell(SPELLS.CRACKLING_JADE_LIGHTNING), this.onApplyDebuff);\r\n    this.addEventListener(Events.removedebuff.by(SELECTED_PLAYER).spell(SPELLS.CRACKLING_JADE_LIGHTNING), this.onRemoveDebuff);\r\n    this.addEventListener(Events.removebuff.by(SELECTED_PLAYER).spell([SPELLS.ESSENCE_FONT, SPELLS.SOOTHING_MIST]), this.onRemoveBuff);\r\n  }\r\n\r\n  onCast(event: CastEvent) {\r\n    if (event.ability.guid === SPELLS.CRACKLING_JADE_LIGHTNING.id) {\r\n      // We track Crackling Jade Lightning differently\r\n      return;\r\n    }\r\n    if (event.ability.guid === SPELLS.ESSENCE_FONT.id || event.ability.guid === SPELLS.SOOTHING_MIST.id) {\r\n      this.beginChannel(event);\r\n      return;\r\n    }\r\n    super.onCast(event);\r\n  }\r\n\r\n  cancelChannel(event: CastEvent, ability: Ability) {\r\n    if (this.isChannelingSpell(SPELLS.CRACKLING_JADE_LIGHTNING.id) || this.isChannelingSpell(SPELLS.ESSENCE_FONT.id) || this.isChannelingSpell(SPELLS.SOOTHING_MIST.id)) {\r\n      // If a channeling spell is \"canceled\" it was actually just ended, so if it looks canceled then instead just mark it as ended\r\n      this.log('Marking', this._currentChannel.ability.name, 'as ended since we started casting something else');\r\n      this.endChannel(event);\r\n    } else {\r\n      super.cancelChannel(event, ability);\r\n    }\r\n  }\r\n\r\n  onApplyDebuff(event: ApplyDebuffEvent) {\r\n    this.beginChannel(event);\r\n  }\r\n\r\n  // Looking at `removebuff` will includes progress towards a tick that never happened. This progress could be considered downtime as it accounts for nothing.\r\n  // If it's ever decided to consider the time between last tick and channel ending as downtime, just change the endchannel trigger.\r\n  onRemoveDebuff(event: RemoveDebuffEvent) {\r\n    if (!this.isChannelingSpell(SPELLS.CRACKLING_JADE_LIGHTNING.id)) {\r\n      // This may be true if we did the event-order fix in begincast/cast and it was already ended there.\r\n      return;\r\n    }\r\n    this.endChannel(event);\r\n  }\r\n\r\n  onRemoveBuff(event: RemoveBuffEvent) {\r\n    if (!this.isChannelingSpell(SPELLS.ESSENCE_FONT.id) || !this.isChannelingSpell(SPELLS.SOOTHING_MIST.id)) {\r\n      // This may be true if we did the event-order fix in begincast/cast and it was already ended there.\r\n      return;\r\n    }\r\n    this.endChannel(event);\r\n  }\r\n}\r\n\r\nexport default Channeling;\r\n","import SPELLS from 'common/SPELLS';\r\nimport { Options } from 'parser/core/Analyzer';\r\nimport Combatant from 'parser/core/Combatant';\r\nimport { ApplyBuffEvent, RefreshBuffEvent } from 'parser/core/Events';\r\nimport HotTracker from 'parser/shared/modules/HotTracker';\r\n\r\nconst REM_BASE_DURATION = 20000;\r\nconst ENV_BASE_DURATION = 6000;\r\nconst EF_BASE_DURATION = 8000;\r\n\r\nconst UPWELLING = 4000;\r\nconst MISTWRAP = 1000;\r\nconst TFT_REM_EXTRA_DURATION = 10000;\r\n\r\nclass HotTrackerMW extends HotTracker {\r\n\r\n  mistwrapActive: boolean = false;\r\n  upwellingActive: boolean = false;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    const selectedCombatant = options.owner.selectedCombatant;\r\n    this.mistwrapActive = selectedCombatant.hasTalent(SPELLS.MIST_WRAP_TALENT.id);\r\n    this.upwellingActive = selectedCombatant.hasTalent(SPELLS.UPWELLING_TALENT.id);\r\n  }\r\n\r\n  calculateMaxDuration(event: ApplyBuffEvent & { selectedCombatant: Combatant }) {\r\n    const spellId = event.ability.guid;\r\n    if (spellId === SPELLS.ENVELOPING_MIST.id) {\r\n      return (ENV_BASE_DURATION + (this.mistwrapActive ? MISTWRAP : 0)) * 2;\r\n    }\r\n    if (spellId === SPELLS.ESSENCE_FONT_BUFF.id) {\r\n      return (EF_BASE_DURATION + (this.upwellingActive ? UPWELLING : 0)) * 2;\r\n    }\r\n    if (event.selectedCombatant.hasBuff(SPELLS.THUNDER_FOCUS_TEA.id) && spellId === SPELLS.RENEWING_MIST_HEAL.id) {\r\n      return (REM_BASE_DURATION + TFT_REM_EXTRA_DURATION) * 2;\r\n    }\r\n    return REM_BASE_DURATION * 2;\r\n  }\r\n\r\n  calculateMaxRemDuration(event: (ApplyBuffEvent | RefreshBuffEvent) & { selectedCombatant: Combatant }) {\r\n    const spellId = event.ability.guid;\r\n    if (event.selectedCombatant.hasBuff(SPELLS.THUNDER_FOCUS_TEA.id) && spellId === SPELLS.RENEWING_MIST_HEAL.id) {\r\n      return (REM_BASE_DURATION + TFT_REM_EXTRA_DURATION);\r\n    }\r\n    return REM_BASE_DURATION;\r\n  }\r\n\r\n  _generateHotInfo() { // must be generated dynamically because it reads from traits\r\n    return {\r\n      [SPELLS.RENEWING_MIST_HEAL.id]: {\r\n        duration: REM_BASE_DURATION,\r\n        tickPeriod: 2000,\r\n        maxDuration: this.calculateMaxDuration,\r\n        bouncy: true,\r\n        durationConditions: this.calculateMaxRemDuration,\r\n        id: SPELLS.RENEWING_MIST_HEAL.id,\r\n      },\r\n      [SPELLS.ENVELOPING_MIST.id]: {\r\n        duration: ENV_BASE_DURATION + (this.mistwrapActive ? MISTWRAP : 0),\r\n        tickPeriod: 1000,\r\n        maxDuration: this.calculateMaxDuration,\r\n        id: SPELLS.ENVELOPING_MIST.id,\r\n      },\r\n      [SPELLS.ESSENCE_FONT_BUFF.id]: {\r\n        duration: EF_BASE_DURATION + (this.upwellingActive ? UPWELLING : 0),\r\n        tickPeriod: 2000,\r\n        maxDuration: this.calculateMaxDuration,\r\n        id: SPELLS.ESSENCE_FONT_BUFF.id,\r\n      },\r\n    };\r\n  }\r\n\r\n  _generateHotList() {\r\n    return [SPELLS.RENEWING_MIST_HEAL, SPELLS.ENVELOPING_MIST, SPELLS.ESSENCE_FONT_BUFF];\r\n  }\r\n}\r\n\r\nexport default HotTrackerMW;\r\n","import EventsNormalizer from 'parser/core/EventsNormalizer';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport { AnyEvent, EventType } from 'parser/core/Events';\r\n\r\nconst MAX_DELAY = 50;\r\n\r\n// Occasionally HoT heal has same timestamp but happens before the applybuff event, which causes issues when attempting to attribute the heal.\r\n// This normalizes the heal to always be after the applybuff\r\nclass HotApplicationNormalizer extends EventsNormalizer {\r\n\r\n  // This ordering issue only happens for the HoTs that tick instantly upon application\r\n  instantTickHotIds: number[] = [\r\n    SPELLS.RENEWING_MIST_HEAL.id,\r\n    SPELLS.ESSENCE_FONT_BUFF.id,\r\n  ];\r\n\r\n  normalize(events: AnyEvent[]): AnyEvent[] {\r\n    const fixedEvents: AnyEvent[] = [];\r\n    events.forEach((event, eventIndex) => {\r\n      fixedEvents.push(event);\r\n\r\n      if (event.type === EventType.ApplyBuff && this.instantTickHotIds.includes(event.ability.guid)) {\r\n        const spellId = event.ability.guid;\r\n        const castTimestamp = event.timestamp;\r\n        if (!event.targetID) {\r\n          return;\r\n        }\r\n\r\n        // Loop through the event history in reverse to detect if there was a heal from same spell on same target\r\n        for (let previousEventIndex = eventIndex; previousEventIndex >= 0; previousEventIndex -= 1) {\r\n          const previousEvent = fixedEvents[previousEventIndex];\r\n          if ((castTimestamp - previousEvent.timestamp) > MAX_DELAY) {\r\n            break;\r\n          }\r\n          if (previousEvent.type === EventType.Heal && previousEvent.ability.guid === spellId && previousEvent.targetID === event.targetID) {\r\n            fixedEvents.splice(previousEventIndex, 1);\r\n            fixedEvents.push(previousEvent);\r\n            previousEvent.__modified = true;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    return fixedEvents;\r\n  }\r\n\r\n}\r\n\r\nexport default HotApplicationNormalizer;\r\n","import EventsNormalizer from 'parser/core/EventsNormalizer';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport { AnyEvent, EventType } from 'parser/core/Events';\r\n\r\nconst MAX_DELAY = 50;\r\n\r\n// Occasionally HoT heal has same timestamp but happens after the removebuff event, which causes issues when attempting to attribute the heal.\r\n// This normalizes the heal to always be before the removebuff\r\nclass HotRemovalNormalizer extends EventsNormalizer {\r\n\r\n  // This ordering issue only happens for the HoTs that tick on removebuff\r\n  instantTickHotIds: number[] = [\r\n    SPELLS.RENEWING_MIST_HEAL.id,\r\n    SPELLS.ESSENCE_FONT_BUFF.id,\r\n  ];\r\n\r\n  normalize(events: AnyEvent[]) {\r\n    const fixedEvents: AnyEvent[] = [];\r\n    events.forEach((event, eventIndex) => {\r\n      fixedEvents.push(event);\r\n\r\n      if (event.type === EventType.Heal && this.instantTickHotIds.includes(event.ability.guid)) {\r\n        const spellId = event.ability.guid;\r\n        const castTimestamp = event.timestamp;\r\n        if (!event.targetID) {\r\n          return;\r\n        }\r\n        // Loop through the event history in reverse to detect if there was a removebuff from same spell on same target\r\n        for (let previousEventIndex = eventIndex; previousEventIndex >= 0; previousEventIndex -= 1) {\r\n          const previousEvent = fixedEvents[previousEventIndex];\r\n          if ((castTimestamp - previousEvent.timestamp) > MAX_DELAY) {\r\n            break;\r\n          }\r\n\r\n          if (previousEvent.type === EventType.RemoveBuff && previousEvent.ability.guid === spellId && previousEvent.targetID === event.targetID) {\r\n            fixedEvents.splice(previousEventIndex, 1);\r\n            fixedEvents.push(previousEvent);\r\n            previousEvent.__modified = true;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n\r\n    });\r\n\r\n    return fixedEvents;\r\n  }\r\n\r\n}\r\n\r\nexport default HotRemovalNormalizer;\r\n","import SPELLS from 'common/SPELLS';\r\n\r\nimport CoreAbilities from 'parser/core/modules/Abilities';\r\n\r\nclass Abilities extends CoreAbilities {\r\n  spellbook() {\r\n    const combatant = this.selectedCombatant;\r\n    return [\r\n      // Rotational Spells\r\n      {\r\n        spell: SPELLS.RENEWING_MIST,\r\n        category: Abilities.SPELL_CATEGORIES.ROTATIONAL,\r\n        cooldown: 9,\r\n        charges: 2,\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n        castEfficiency: {\r\n          suggestion: true,\r\n        },\r\n        timelineSortIndex: 1,\r\n      },\r\n      {\r\n        spell: SPELLS.SOOTHING_MIST,\r\n        category: Abilities.SPELL_CATEGORIES.ROTATIONAL,\r\n        gcd: {\r\n          base: 1000,\r\n        },\r\n        timelineSortIndex: 100,\r\n      },\r\n\r\n      // Cooldowns\r\n      {\r\n        spell: SPELLS.THUNDER_FOCUS_TEA,\r\n        category: Abilities.SPELL_CATEGORIES.COOLDOWNS,\r\n        cooldown: 30,\r\n        castEfficiency: {\r\n          suggestion: true,\r\n        },\r\n        timelineSortIndex: 17,\r\n      },\r\n      {\r\n        spell: SPELLS.MANA_TEA_TALENT,\r\n        category: Abilities.SPELL_CATEGORIES.COOLDOWNS,\r\n        cooldown: 90,\r\n        enabled: combatant.hasTalent(SPELLS.MANA_TEA_TALENT.id),\r\n        castEfficiency: {\r\n          suggestion: true,\r\n        },\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n        timelineSortIndex: 15,\r\n      },\r\n      {\r\n        spell: SPELLS.CHI_BURST_TALENT,\r\n        category: Abilities.SPELL_CATEGORIES.COOLDOWNS,\r\n        cooldown: 30,\r\n        enabled: combatant.hasTalent(SPELLS.CHI_BURST_TALENT.id),\r\n        castEfficiency: {\r\n          suggestion: true,\r\n        },\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n        timelineSortIndex: 10,\r\n      },\r\n      {\r\n        spell: SPELLS.CHI_WAVE_TALENT,\r\n        category: Abilities.SPELL_CATEGORIES.COOLDOWNS,\r\n        cooldown: 15,\r\n        enabled: combatant.hasTalent(SPELLS.CHI_WAVE_TALENT.id),\r\n        castEfficiency: {\r\n          suggestion: true,\r\n        },\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n        timelineSortIndex: 10,\r\n      },\r\n      {\r\n        spell: SPELLS.LIFE_COCOON,\r\n        category: Abilities.SPELL_CATEGORIES.COOLDOWNS,\r\n        cooldown: 120,\r\n        castEfficiency: {\r\n          suggestion: true,\r\n        },\r\n        timelineSortIndex: 17,\r\n      },\r\n      {\r\n        spell: SPELLS.REVIVAL,\r\n        category: Abilities.SPELL_CATEGORIES.COOLDOWNS,\r\n        cooldown: 180,\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n        timelineSortIndex: 18,\r\n      },\r\n      {\r\n        spell: SPELLS.INVOKE_YULON_THE_JADE_SERPENT,\r\n        category: Abilities.SPELL_CATEGORIES.COOLDOWNS,\r\n        enabled: !combatant.hasTalent(SPELLS.INVOKE_CHIJI_THE_RED_CRANE_TALENT.id),\r\n        cooldown: 180,\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n        castEfficiency: {\r\n          suggestion: true,\r\n        },\r\n        timelineSortIndex: 20,\r\n      },\r\n      {\r\n        spell: SPELLS.INVOKE_CHIJI_THE_RED_CRANE_TALENT,\r\n        category: Abilities.SPELL_CATEGORIES.COOLDOWNS,\r\n        enabled: combatant.hasTalent(SPELLS.INVOKE_CHIJI_THE_RED_CRANE_TALENT.id),\r\n        cooldown: 180,\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n        castEfficiency: {\r\n          suggestion: true,\r\n        },\r\n        timelineSortIndex: 20,\r\n      },\r\n\r\n      // Other Spell Casting Metrics\r\n      {\r\n        spell: SPELLS.ENVELOPING_MIST,\r\n        category: Abilities.SPELL_CATEGORIES.OTHERS,\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n        timelineSortIndex: 19,\r\n      },\r\n      {\r\n        spell: SPELLS.VIVIFY,\r\n        category: Abilities.SPELL_CATEGORIES.OTHERS,\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n        timelineSortIndex: 4,\r\n      },\r\n      {\r\n        spell: SPELLS.ESSENCE_FONT,\r\n        category: Abilities.SPELL_CATEGORIES.OTHERS,\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n        cooldown: 12,\r\n        timelineSortIndex: 2,\r\n      },\r\n\r\n      {\r\n        spell: SPELLS.REFRESHING_JADE_WIND_TALENT,\r\n        category: Abilities.SPELL_CATEGORIES.OTHERS,\r\n        enabled: combatant.hasTalent(SPELLS.REFRESHING_JADE_WIND_TALENT.id),\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n        timelineSortIndex: 3,\r\n      },\r\n      {\r\n        spell: SPELLS.SUMMON_JADE_SERPENT_STATUE_TALENT,\r\n        category: Abilities.SPELL_CATEGORIES.OTHERS,\r\n        enabled: combatant.hasTalent(SPELLS.SUMMON_JADE_SERPENT_STATUE_TALENT.id),\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n        cooldown: 10,\r\n        timelineSortIndex: 15,\r\n      },\r\n      {\r\n        spell: SPELLS.EXPEL_HARM,\r\n        category: Abilities.SPELL_CATEGORIES.OTHERS,\r\n        gcd: {\r\n          base: 1000,\r\n        },\r\n      },\r\n\r\n      // Utility Spells\r\n      {\r\n        spell: SPELLS.DIFFUSE_MAGIC_TALENT,\r\n        buffSpellId: SPELLS.DIFFUSE_MAGIC_TALENT.id,\r\n        category: Abilities.SPELL_CATEGORIES.DEFENSIVE,\r\n        cooldown: 90,\r\n        enabled: combatant.hasTalent(SPELLS.DIFFUSE_MAGIC_TALENT.id),\r\n      },\r\n      {\r\n        spell: SPELLS.DAMPEN_HARM_TALENT,\r\n        buffSpellId: SPELLS.DAMPEN_HARM_TALENT.id,\r\n        category: Abilities.SPELL_CATEGORIES.DEFENSIVE,\r\n        cooldown: 120,\r\n        enabled: combatant.hasTalent(SPELLS.DAMPEN_HARM_TALENT.id),\r\n      },\r\n      {\r\n        spell: SPELLS.FORTIFYING_BREW,\r\n        buffSpellId: SPELLS.FORTIFYING_BREW.id,\r\n        category: Abilities.SPELL_CATEGORIES.DEFENSIVE,\r\n        cooldown: 90,\r\n      },\r\n      {\r\n        spell: SPELLS.HEALING_ELIXIR_TALENT,\r\n        category: Abilities.SPELL_CATEGORIES.UTILITY,\r\n        charges: 2,\r\n        cooldown: 30,\r\n        enabled: combatant.hasTalent(SPELLS.HEALING_ELIXIR_TALENT.id),\r\n      },\r\n      {\r\n        spell: SPELLS.DETOX,\r\n        category: Abilities.SPELL_CATEGORIES.UTILITY,\r\n        cooldown: 8,\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n      },\r\n      {\r\n        spell: SPELLS.PARALYSIS,\r\n        category: Abilities.SPELL_CATEGORIES.UTILITY,\r\n        cooldown: 45,\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n      },\r\n      {\r\n        spell: SPELLS.RING_OF_PEACE_TALENT,\r\n        category: Abilities.SPELL_CATEGORIES.UTILITY,\r\n        cooldown: 45,\r\n        enabled: combatant.hasTalent(SPELLS.RING_OF_PEACE_TALENT.id),\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n      },\r\n\r\n      {\r\n        spell: SPELLS.LEG_SWEEP,\r\n        category: Abilities.SPELL_CATEGORIES.UTILITY,\r\n        cooldown: combatant.hasTalent(SPELLS.TIGER_TAIL_SWEEP_TALENT.id) ? 50 : 60,\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n      },\r\n\r\n      {\r\n        spell: SPELLS.ROLL,\r\n        category: Abilities.SPELL_CATEGORIES.UTILITY,\r\n        charges: combatant.hasTalent(SPELLS.CELERITY_TALENT.id) ? 3 : 2,\r\n        cooldown: combatant.hasTalent(SPELLS.CELERITY_TALENT.id) ? 15 : 20,\r\n        enabled: !combatant.hasTalent(SPELLS.CHI_TORPEDO_TALENT.id),\r\n      },\r\n      {\r\n        spell: SPELLS.CHI_TORPEDO_TALENT,\r\n        category: Abilities.SPELL_CATEGORIES.UTILITY,\r\n        charges: 2,\r\n        cooldown: 20,\r\n        enabled: combatant.hasTalent(SPELLS.CHI_TORPEDO_TALENT.id),\r\n      },\r\n      {\r\n        spell: SPELLS.TIGERS_LUST_TALENT,\r\n        category: Abilities.SPELL_CATEGORIES.UTILITY,\r\n        cooldown: 30,\r\n        gcd: {\r\n          static: 1500,\r\n        },\r\n        enabled: combatant.hasTalent(SPELLS.TIGERS_LUST_TALENT.id),\r\n      },\r\n      {\r\n        spell: SPELLS.TRANSCENDENCE,\r\n        category: Abilities.SPELL_CATEGORIES.UTILITY,\r\n        cooldown: 10,\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n      },\r\n      {\r\n        spell: SPELLS.TRANSCENDENCE_TRANSFER,\r\n        category: Abilities.SPELL_CATEGORIES.UTILITY,\r\n        cooldown: 25,\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n      },\r\n\r\n      // Damage Spells\r\n      {\r\n        spell: SPELLS.TIGER_PALM,\r\n        category: Abilities.SPELL_CATEGORIES.HEALER_DAMAGING_SPELL,\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n        timelineSortIndex: 31,\r\n      },\r\n      {\r\n        spell: SPELLS.BLACKOUT_KICK,\r\n        category: Abilities.SPELL_CATEGORIES.HEALER_DAMAGING_SPELL,\r\n        cooldown: (haste: number) => 3 / (1 + haste),\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n        timelineSortIndex: 32,\r\n      },\r\n      {\r\n        spell: SPELLS.RISING_SUN_KICK,\r\n        category: Abilities.SPELL_CATEGORIES.HEALER_DAMAGING_SPELL,\r\n        cooldown: (haste: number) => 12 / (1 + haste),\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n        castEfficiency: {\r\n          suggestion: combatant.hasTalent(SPELLS.RISING_MIST_TALENT.id),\r\n        },\r\n        timelineSortIndex: 100,\r\n      },\r\n      {\r\n        spell: SPELLS.SPINNING_CRANE_KICK,\r\n        category: Abilities.SPELL_CATEGORIES.HEALER_DAMAGING_SPELL,\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n        timelineSortIndex: 100,\r\n      },\r\n      {\r\n        spell: SPELLS.CRACKLING_JADE_LIGHTNING,\r\n        category: Abilities.SPELL_CATEGORIES.HEALER_DAMAGING_SPELL,\r\n        gcd: {\r\n          base: 1500,\r\n        },\r\n        timelineSortIndex: 100,\r\n      },\r\n    ];\r\n  }\r\n}\r\n\r\nexport default Abilities;\r\n","import SPELLS from 'common/SPELLS';\r\n\r\nimport CoreCooldownThroughputTracker, { BUILT_IN_SUMMARY_TYPES } from 'parser/shared/modules/CooldownThroughputTracker';\r\n\r\nclass CooldownThroughputTracker extends CoreCooldownThroughputTracker {\r\n  static cooldownSpells = [\r\n    ...CoreCooldownThroughputTracker.cooldownSpells,\r\n    {\r\n      spell: SPELLS.MANA_TEA_TALENT,\r\n      summary: [\r\n        BUILT_IN_SUMMARY_TYPES.HEALING,\r\n        BUILT_IN_SUMMARY_TYPES.OVERHEALING,\r\n        BUILT_IN_SUMMARY_TYPES.MANA,\r\n      ],\r\n    },\r\n    {\r\n      spell: SPELLS.INVOKE_YULON_THE_JADE_SERPENT,\r\n      summary: [\r\n        BUILT_IN_SUMMARY_TYPES.HEALING,\r\n        BUILT_IN_SUMMARY_TYPES.OVERHEALING,\r\n        BUILT_IN_SUMMARY_TYPES.MANA,\r\n      ],\r\n    },\r\n    {\r\n      spell: SPELLS.INVOKE_CHIJI_THE_RED_CRANE_TALENT,\r\n      summary: [\r\n        BUILT_IN_SUMMARY_TYPES.HEALING,\r\n        BUILT_IN_SUMMARY_TYPES.OVERHEALING,\r\n        BUILT_IN_SUMMARY_TYPES.MANA,\r\n      ],\r\n    },\r\n  ];\r\n\r\n  static ignoredSpells = [\r\n    ...CoreCooldownThroughputTracker.ignoredSpells,\r\n    SPELLS.CHI_BURST_HEAL.id,\r\n    SPELLS.REFRESHING_JADE_WIND_HEAL.id,\r\n    SPELLS.TRANSCENDENCE.id,\r\n  ];\r\n}\r\n\r\nexport default CooldownThroughputTracker;\r\n","import SPELLS from 'common/SPELLS';\r\nimport { formatPercentage } from 'common/format';\r\n\r\nimport CoreAlwaysBeCastingHealing from 'parser/shared/modules/AlwaysBeCastingHealing';\r\nimport { ThresholdStyle, When } from 'parser/core/ParseResults';\r\n\r\nimport { i18n } from '@lingui/core';\r\nimport { t } from '@lingui/macro';\r\n\r\nclass AlwaysBeCasting extends CoreAlwaysBeCastingHealing {\r\n  static HEALING_ABILITIES_ON_GCD: number[] = [\r\n    SPELLS.ENVELOPING_MIST.id,\r\n    SPELLS.ESSENCE_FONT.id,\r\n    SPELLS.RENEWING_MIST.id,\r\n    SPELLS.VIVIFY.id,\r\n    SPELLS.REVIVAL.id,\r\n    SPELLS.CHI_BURST_TALENT.id,\r\n    SPELLS.CHI_WAVE_TALENT.id,\r\n    SPELLS.REFRESHING_JADE_WIND_TALENT.id,\r\n    SPELLS.SOOTHING_MIST.id,\r\n    SPELLS.INVOKE_CHIJI_THE_RED_CRANE_TALENT.id,\r\n    SPELLS.EXPEL_HARM.id,\r\n    SPELLS.INVOKE_YULON_THE_JADE_SERPENT.id,\r\n  ];\r\n\r\n  get nonHealingTimeSuggestionThresholds() {\r\n    return {\r\n      actual: this.nonHealingTimePercentage,\r\n      isGreaterThan: {\r\n        minor: 0.4,\r\n        average: 0.5,\r\n        major: 0.55,\r\n      },\r\n      style: ThresholdStyle.PERCENTAGE,\r\n    };\r\n  }\r\n\r\n  get downtimeSuggestionThresholds() {\r\n    return {\r\n      actual: this.downtimePercentage,\r\n      isGreaterThan: {\r\n        minor: 0.4,\r\n        average: 0.55,\r\n        major: 1,\r\n      },\r\n      style: ThresholdStyle.PERCENTAGE,\r\n    };\r\n  }\r\n\r\n  suggestions(when: When) {\r\n    when(this.nonHealingTimePercentage).isGreaterThan(this.nonHealingTimeSuggestionThresholds.isGreaterThan.minor)\r\n      .addSuggestion((suggest, actual, recommended) => suggest('Your non healing time can be improved. Try to reduce the delay between casting spells and try to continue healing when you have to move.')\r\n        .icon('petbattle_health-down')\r\n        .actual(i18n._(t('monk.mistweaver.suggestions.alwaysBeCasting.nonHealing')`${formatPercentage(actual)}% non healing time`))\r\n        .recommended(`<${formatPercentage(recommended)}% is recommended`)\r\n        .regular(this.nonHealingTimeSuggestionThresholds.isGreaterThan.average).major(this.nonHealingTimeSuggestionThresholds.isGreaterThan.major));\r\n    when(this.downtimePercentage).isGreaterThan(this.downtimeSuggestionThresholds.isGreaterThan.minor)\r\n      .addSuggestion((suggest, actual, recommended) => suggest('Your downtime can be improved. Try to Always Be Casting (ABC); try to reduce the delay between casting spells and when you\\'re not healing try to contribute some damage.')\r\n        .icon('spell_mage_altertime')\r\n        .actual(i18n._(t('monk.mistweaver.suggestions.alwaysBeCasting.downtime')`${formatPercentage(actual)}% downtime`))\r\n        .recommended(`<${formatPercentage(recommended)}% is recommended`)\r\n        .regular(this.downtimeSuggestionThresholds.isGreaterThan.average).major(this.downtimeSuggestionThresholds.isGreaterThan.major));\r\n  }\r\n}\r\n\r\nexport default AlwaysBeCasting;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport SpellLink from 'common/SpellLink';\r\nimport SpellIcon from 'common/SpellIcon';\r\nimport { formatNumber, formatPercentage } from 'common/format';\r\nimport { TooltipElement } from 'common/Tooltip';\r\n\r\nimport Analyzer, { Options, SELECTED_PLAYER } from 'parser/core/Analyzer';\r\nimport Combatants from 'parser/shared/modules/Combatants';\r\n\r\nimport StatisticBox, { STATISTIC_ORDER } from 'interface/others/StatisticBox';\r\nimport Events, { CastEvent, HealEvent } from 'parser/core/Events';\r\nimport { ThresholdStyle, When } from 'parser/core/ParseResults';\r\n\r\nimport { i18n } from '@lingui/core';\r\nimport { t } from '@lingui/macro';\r\n\r\nconst debug = false;\r\n\r\nclass EssenceFontMastery extends Analyzer {\r\n  static dependencies = {\r\n    combatants: Combatants,\r\n  };\r\n  healEF: number = 0;\r\n  healing: number = 0;\r\n  castEF: number = 0;\r\n  gustHeal: boolean = false;\r\n  hasUpwelling: boolean = false;\r\n  secondGustHealing: number = 0;\r\n  secondGustOverheal: number = 0;\r\n  protected combatants!: Combatants;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.hasUpwelling = this.selectedCombatant.hasTalent(SPELLS.UPWELLING_TALENT.id);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.GUSTS_OF_MISTS), this.gustHealing);\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.ESSENCE_FONT), this.efCast);\r\n  }\r\n\r\n  get avgMasteryCastsPerEF() {\r\n    const efMasteryCasts = (this.healEF / 2) || 0;\r\n\r\n    return (efMasteryCasts / this.castEF) || 0;\r\n  }\r\n\r\n  get suggestionThresholds() {\r\n    if (this.hasUpwelling) {\r\n      return {\r\n        actual: this.avgMasteryCastsPerEF,\r\n        isLessThan: {\r\n          minor: 4,\r\n          average: 3.5,\r\n          major: 3,\r\n        },\r\n        style: ThresholdStyle.DECIMAL,\r\n      };\r\n    } else {\r\n      return {\r\n        actual: this.avgMasteryCastsPerEF,\r\n        isLessThan: {\r\n          minor: 3,\r\n          average: 2.5,\r\n          major: 2,\r\n        },\r\n        style: ThresholdStyle.DECIMAL,\r\n      };\r\n    }\r\n  }\r\n\r\n  gustHealing(event: HealEvent) {\r\n    const targetId = event.targetID;\r\n    if (!this.combatants.players[targetId]) {\r\n      return;\r\n    }\r\n    if (this.combatants.players[targetId].hasBuff(SPELLS.ESSENCE_FONT_BUFF.id, event.timestamp, 0, 0, event.sourceID) && !this.gustHeal) {\r\n      debug && console.log(`First Gust Heal: Player ID: ${event.targetID}  Timestamp: ${event.timestamp}`);\r\n      this.healEF += 1;\r\n      this.gustHeal = true;\r\n    } else if (this.combatants.players[targetId].hasBuff(SPELLS.ESSENCE_FONT_BUFF.id, event.timestamp, 0, 0, event.sourceID) && this.gustHeal) {\r\n      this.healEF += 1;\r\n      this.healing += (event.amount || 0) + (event.absorbed || 0);\r\n      this.gustHeal = false;\r\n    }\r\n  }\r\n\r\n  efCast(event: CastEvent) {\r\n    this.castEF += 1;\r\n  }\r\n\r\n  suggestions(when: When) {\r\n    when(this.suggestionThresholds).addSuggestion((suggest, actual, recommended) => suggest(\r\n      <>\r\n        You are currently not utilizing your <SpellLink id={SPELLS.ESSENCE_FONT.id} /> HOT buffs effectively. Casting into injured targets with the <SpellLink id={SPELLS.ESSENCE_FONT.id} /> allows you to take advantage of the double <SpellLink id={SPELLS.GUSTS_OF_MISTS.id} /> procs.\r\n      </>,\r\n    )\r\n      .icon(SPELLS.ESSENCE_FONT.icon)\r\n      .actual(i18n._(t('monk.mistweaver.suggestions.essenceFontMastery.averageHots')`${this.avgMasteryCastsPerEF.toFixed(2)} average EF HoTs`))\r\n      .recommended(`${recommended} or more EF HoTs utilized is recommended`));\r\n  }\r\n\r\n  statistic() {\r\n    const efMasteryCasts = (this.healEF / 2) || 0;\r\n    const efMasteryEffectiveHealing = ((this.healing) / 2) || 0;\r\n    const avgEFMasteryHealing = efMasteryEffectiveHealing / efMasteryCasts || 0;\r\n\r\n    return (\r\n      <StatisticBox\r\n        position={STATISTIC_ORDER.OPTIONAL(0)}\r\n        icon={<SpellIcon id={SPELLS.GUSTS_OF_MISTS.id} />}\r\n        value={efMasteryCasts}\r\n        label={(\r\n          <TooltipElement\r\n            content={(\r\n              <>\r\n                You healed an average of {this.avgMasteryCastsPerEF.toFixed(2)} targets per Essence Font cast.\r\n                <ul>\r\n                  <li>{formatNumber(avgEFMasteryHealing)} average healing per cast</li>\r\n                  <li>{formatNumber(this.secondGustOverheal)} Second Gust of Mists overhealing ({formatPercentage(this.secondGustOverheal / this.secondGustHealing)}%)</li>\r\n                </ul>\r\n              </>\r\n            )}\r\n          >\r\n            Mastery Buffs utilized\r\n          </TooltipElement>\r\n        )}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default EssenceFontMastery;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport SpellLink from 'common/SpellLink';\r\n\r\nimport Analyzer, { Options, SELECTED_PLAYER } from 'parser/core/Analyzer';\r\nimport Events, { ApplyBuffEvent, CastEvent, HealEvent, RefreshBuffEvent } from 'parser/core/Events';\r\n\r\nimport StatisticBox, { STATISTIC_ORDER } from 'interface/others/StatisticBox';\r\nimport SpellIcon from 'common/SpellIcon';\r\nimport { formatNumber } from 'common/format';\r\nimport { TooltipElement } from 'common/Tooltip';\r\nimport { ThresholdStyle, When } from 'parser/core/ParseResults';\r\n\r\nimport { i18n } from '@lingui/core';\r\nimport { t } from '@lingui/macro';\r\n\r\nclass EssenceFont extends Analyzer {\r\n  totalHealing: number = 0;\r\n  totalOverhealing: number = 0;\r\n  totalAbsorbs: number = 0;\r\n  castEF: number = 0;\r\n  targetsEF: number = 0;\r\n  efHotHeal: number = 0;\r\n  efHotOverheal: number = 0;\r\n  targetOverlap: number = 0;\r\n  uniqueTargets: Set<number> = new Set<number>();\r\n  total: number = 0;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.ESSENCE_FONT), this.castEssenceFont);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.ESSENCE_FONT), this.handleEssenceFont);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.ESSENCE_FONT_BUFF), this.handleEssenceFontBuff);\r\n    this.addEventListener(Events.applybuff.by(SELECTED_PLAYER).spell(SPELLS.ESSENCE_FONT_BUFF), this.applyEssenceFontBuff);\r\n    this.addEventListener(Events.refreshbuff.by(SELECTED_PLAYER).spell(SPELLS.ESSENCE_FONT_BUFF), this.refreshEssenceFontBuff);\r\n  }\r\n\r\n  get efHotHealing() {\r\n    return (this.efHotHeal);\r\n  }\r\n\r\n  get efHotOverhealing() {\r\n    return (this.efHotOverheal / (this.efHotHeal + this.efHotOverheal)).toFixed(4);\r\n  }\r\n\r\n  get avgTargetsHitPerEF() {\r\n    return (this.targetsEF / this.castEF) || 0;\r\n  }\r\n\r\n  get efHotOverlap() {\r\n    return ((this.targetOverlap / this.targetsEF) || 0).toFixed(2);\r\n  }\r\n\r\n  get suggestionThresholds() {\r\n    return {\r\n      actual: this.avgTargetsHitPerEF,\r\n      isLessThan: {\r\n        minor: 17,\r\n        average: 14,\r\n        major: 12,\r\n      },\r\n      style: ThresholdStyle.NUMBER,\r\n    };\r\n  }\r\n\r\n  castEssenceFont(event: CastEvent) {\r\n    this.castEF += 1;\r\n    this.total += this.uniqueTargets.size || 0;\r\n    this.uniqueTargets.clear();\r\n  }\r\n\r\n  handleEssenceFont(event: HealEvent) {\r\n    this.totalHealing += event.amount || 0;\r\n    this.totalOverhealing += event.overheal || 0;\r\n    this.totalAbsorbs += event.absorbed || 0;\r\n  }\r\n\r\n  handleEssenceFontBuff(event: HealEvent) {\r\n    if (event.tick === true) {\r\n      this.efHotHeal += (event.amount || 0) + (event.absorbed || 0);\r\n      this.efHotOverheal += event.overheal || 0;\r\n    }\r\n\r\n    this.totalHealing += event.amount || 0;\r\n    this.totalOverhealing += event.overheal || 0;\r\n    this.totalAbsorbs += event.absorbed || 0;\r\n    this.uniqueTargets.add(event.targetID);\r\n  }\r\n\r\n  applyEssenceFontBuff(event: ApplyBuffEvent) {\r\n    this.targetsEF += 1;\r\n  }\r\n\r\n  refreshEssenceFontBuff(event: RefreshBuffEvent) {\r\n    this.targetsEF += 1;\r\n    this.targetOverlap += 1;\r\n  }\r\n\r\n  suggestions(when: When) {\r\n    when(this.suggestionThresholds).addSuggestion((suggest, actual, recommended) => suggest(\r\n      <>\r\n        You are currently using not utilizing your <SpellLink id={SPELLS.ESSENCE_FONT.id} /> effectively. Each <SpellLink id={SPELLS.ESSENCE_FONT.id} /> cast should hit a total of 18 targets. Either hold the cast til 6 or more targets are injured or move while casting to increase the effective range of the spell.\r\n      </>,\r\n    )\r\n      .icon(SPELLS.ESSENCE_FONT.icon)\r\n      .actual(`${this.avgTargetsHitPerEF.toFixed(2)}${i18n._(t('monk.mistweaver.suggestions.essenceFont.averageTargetsHit')`average targets hit per cast`)}`)\r\n      .recommended(`${recommended} targets hit is recommended`));\r\n  }\r\n\r\n  statistic() {\r\n    const averageHits = this.total / this.castEF;\r\n    return (\r\n      <StatisticBox\r\n        postion={STATISTIC_ORDER.OPTIONAL(50)}\r\n        icon={<SpellIcon id={SPELLS.ESSENCE_FONT.id} />}\r\n        value={`${formatNumber(averageHits)}`}\r\n        label={(\r\n          <TooltipElement content=\"This is the average unique targets hit per essences font cast.\">\r\n            Average Unique Targets Hit\r\n          </TooltipElement>\r\n        )}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default EssenceFont;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport SpellLink from 'common/SpellLink';\r\nimport { formatPercentage } from 'common/format';\r\n\r\nimport Analyzer, { Options, SELECTED_PLAYER } from 'parser/core/Analyzer';\r\nimport Events, { ApplyBuffEvent, HealEvent } from 'parser/core/Events';\r\nimport { ThresholdStyle, When } from 'parser/core/ParseResults';\r\n\r\nimport { i18n } from '@lingui/core';\r\nimport { t } from '@lingui/macro';\r\n\r\nconst TARGETSPERCAST = 78;\r\n\r\nclass RefreshingJadeWind extends Analyzer {\r\n  healsRJW: number = 0;\r\n  healingRJW: number = 0;\r\n  overhealingRJW: number = 0;\r\n  castRJW: number = 0;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.active = this.selectedCombatant.hasTalent(SPELLS.REFRESHING_JADE_WIND_TALENT.id);\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n\r\n    this.addEventListener(Events.applybuff.by(SELECTED_PLAYER).spell(SPELLS.REFRESHING_JADE_WIND_TALENT), this.rjwBuff);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.REFRESHING_JADE_WIND_HEAL), this.rjwHeal);\r\n  }\r\n\r\n  get avgTargetsHitPerRJWPercentage() {\r\n    return (this.healsRJW / this.castRJW) / TARGETSPERCAST || 0;\r\n  }\r\n\r\n  get rjwEffectiveness() {\r\n    const rjwEfficiency = (this.healsRJW / (this.castRJW * TARGETSPERCAST)) || 0;\r\n    return rjwEfficiency.toFixed(4);\r\n  }\r\n\r\n  get suggestionThresholds() {\r\n    return {\r\n      actual: this.avgTargetsHitPerRJWPercentage,\r\n      isLessThan: {\r\n        minor: .9,\r\n        average: .8,\r\n        major: .7,\r\n      },\r\n      style: ThresholdStyle.PERCENTAGE,\r\n    };\r\n  }\r\n\r\n  rjwBuff(event: ApplyBuffEvent) {\r\n    this.castRJW += 1;\r\n  }\r\n\r\n  rjwHeal(event: HealEvent) {\r\n    this.healsRJW += 1;\r\n    this.healingRJW += (event.amount || 0) + (event.absorbed || 0);\r\n    this.overhealingRJW += event.overheal || 0;\r\n  }\r\n\r\n  suggestions(when: When) {\r\n    when(this.suggestionThresholds).addSuggestion((suggest, actual, recommended) => suggest(\r\n      <>\r\n        You are not utilizing your <SpellLink id={SPELLS.REFRESHING_JADE_WIND_TALENT.id} /> effectively. <SpellLink id={SPELLS.REFRESHING_JADE_WIND_TALENT.id} /> excells when you hit 6 targets for the duration of the spell. The easiest way to accomplish this is to stand in melee, but there can be other uses when the raid stacks for various abilities.\r\n      </>,\r\n    )\r\n      .icon(SPELLS.REFRESHING_JADE_WIND_TALENT.icon)\r\n      .actual(`${formatPercentage(this.avgTargetsHitPerRJWPercentage)}${i18n._(t('monk.mistweaver.suggestions.refreshingJadeWind.avgTargetsHit')`% of targets hit per Refreshing Jade Wind`)}`)\r\n      .recommended(`>${formatPercentage(recommended)}% is recommended`));\r\n  }\r\n}\r\n\r\nexport default RefreshingJadeWind;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport SpellLink from 'common/SpellLink';\r\nimport { formatPercentage } from 'common/format';\r\n\r\nimport Analyzer, { SELECTED_PLAYER } from 'parser/core/Analyzer';\r\nimport Combatants from 'parser/shared/modules/Combatants';\r\nimport Events from 'parser/core/Events';\r\nimport { i18n } from '@lingui/core';\r\nimport { t } from '@lingui/macro';\r\n\r\nconst debug = false;\r\n\r\nclass ChiBurst extends Analyzer {\r\n  get avgTargetsHitPerCB() {\r\n    return this.targetsChiBurst / this.castChiBurst || 0;\r\n  }\r\n\r\n  get suggestionThresholds() {\r\n    return {\r\n      actual: this.avgTargetsHitPerCB,\r\n      isLessThan: {\r\n        minor: this.raidSize * 0.3,\r\n        average: this.raidSize * 0.25,\r\n        major: this.raidSize * 0.2,\r\n      },\r\n      style: 'number',\r\n    };\r\n  }\r\n\r\n  static dependencies = {\r\n    combatants: Combatants,\r\n  };\r\n  castChiBurst = 0;\r\n  healing = 0;\r\n  targetsChiBurst = 0;\r\n  raidSize = 0;\r\n\r\n  constructor(...options) {\r\n    super(...options);\r\n    this.active = this.selectedCombatant.hasTalent(SPELLS.CHI_BURST_TALENT.id);\r\n    this.raidSize = Object.keys(this.combatants.players).length;\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.CHI_BURST_TALENT), this.onCast);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.CHI_BURST_HEAL), this.onHeal);\r\n    this.addEventListener(Events.fightend, this.onFightend);\r\n  }\r\n\r\n  onCast(event) {\r\n    this.castChiBurst += 1;\r\n  }\r\n\r\n  onHeal(event) {\r\n    const targetId = event.targetID;\r\n\r\n    if (!this.combatants.players[targetId]) {\r\n      return;\r\n    }\r\n    this.healing += (event.amount || 0) + (event.absorbed || 0);\r\n    this.targetsChiBurst += 1;\r\n  }\r\n\r\n  suggestions(when) {\r\n    when(this.suggestionThresholds).addSuggestion((suggest, actual, recommended) => suggest(\r\n      <>\r\n        You are not utilizing your <SpellLink id={SPELLS.CHI_BURST_TALENT.id} /> talent as effectively as you should. You should work on both your positioning and aiming of the spell. Always aim for the highest concentration of players, which is normally melee.\r\n      </>,\r\n    )\r\n      .icon(SPELLS.CHI_BURST_TALENT.icon)\r\n      .actual(`${this.avgTargetsHitPerCB.toFixed(2)} ${i18n._(t('monk.mistweaver.suggestions.chiBurst.targetsHit')`targets hit per Chi Burst cast - `)}${formatPercentage(this.avgTargetsHitPerCB / this.raidSize)}${i18n._(t('monk.mistweaver.suggestions.chiBurst.targetsHitPartTwo')`% of raid hit`)}`)\r\n      .recommended('30% of the raid hit is recommended'));\r\n  }\r\n\r\n  onFightend() {\r\n    if (debug) {\r\n      console.log(`ChiBurst Casts: ${this.castChiBurst}`);\r\n      console.log(`Total Chi Burst Healing: ${this.healing}`);\r\n      console.log(`Chi Burst Targets Hit: ${this.targetsChiBurst}`);\r\n    }\r\n  }\r\n}\r\n\r\nexport default ChiBurst;\r\n","import SPELLS from 'common/SPELLS';\r\n\r\nexport const ABILITIES_AFFECTED_BY_HEALING_INCREASES = [\r\n  // Spells\r\n  SPELLS.ENVELOPING_MIST.id,\r\n  SPELLS.ESSENCE_FONT.id,\r\n  SPELLS.ESSENCE_FONT_BUFF.id,\r\n  SPELLS.RENEWING_MIST.id,\r\n  SPELLS.RENEWING_MIST_HEAL.id,\r\n  SPELLS.VIVIFY.id,\r\n  SPELLS.SOOTHING_MIST.id,\r\n  SPELLS.GUSTS_OF_MISTS.id,\r\n\r\n  // Cooldowns\r\n  SPELLS.REVIVAL.id,\r\n\r\n  // Talents\r\n  SPELLS.CHI_BURST_TALENT.id,\r\n  SPELLS.CHI_BURST_HEAL.id,\r\n  SPELLS.CHI_WAVE_TALENT.id,\r\n  SPELLS.REFRESHING_JADE_WIND_TALENT.id,\r\n  SPELLS.REFRESHING_JADE_WIND_HEAL.id,\r\n\r\n  // Misc\r\n  SPELLS.LEECH.id,\r\n];\r\n\r\nexport const LIFE_COCOON_HEALING_BOOST = .5;\r\n\r\nexport function conduitScaling(rankOne: number, requiredRank: number) {\r\n  const scalingFactor = rankOne * .1;\r\n  const rankZero = rankOne - scalingFactor;\r\n  const rankRequested = rankZero + scalingFactor * requiredRank;\r\n  return rankRequested;\r\n}\r\n\r\nexport const NOURISHING_CHI_RANK_ONE = .1875;\r\nexport const JADE_BOND_RANK_ONE = .0625;\r\nexport const RISING_SUN_REVIVAL = .125;\r\n\r\nexport const LIFECYCLES_MANA_PERC_REDUCTION = 0.25;\r\n\r\nexport const TEACHINGS_OF_THE_MONASTERY_DURATION = 20000;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport { formatNumber } from 'common/format';\r\n\r\nimport Analyzer, { Options, SELECTED_PLAYER } from 'parser/core/Analyzer';\r\nimport Events, { ApplyBuffEvent, ApplyBuffStackEvent, CastEvent, EnergizeEvent, RemoveBuffEvent } from 'parser/core/Events';\r\n\r\nimport { ThresholdStyle, When } from 'parser/core/ParseResults';\r\n\r\nimport { TEACHINGS_OF_THE_MONASTERY_DURATION } from 'parser/monk/mistweaver/constants';\r\n\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport BoringValueText from 'interface/statistics/components/BoringValueText';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport SpellIcon from 'common/SpellIcon';\r\nimport SpellLink from 'common/SpellLink';\r\n\r\nimport { i18n } from '@lingui/core';\r\nimport { t } from '@lingui/macro';\r\n\r\nconst SOTC_MANA_PER_SECOND_RETURN_MINOR = 80;\r\nconst SOTC_MANA_PER_SECOND_RETURN_AVERAGE: number = SOTC_MANA_PER_SECOND_RETURN_MINOR - 15;\r\nconst SOTC_MANA_PER_SECOND_RETURN_MAJOR: number = SOTC_MANA_PER_SECOND_RETURN_MINOR - 15;\r\n\r\nconst debug = false;\r\n\r\nclass SpiritOfTheCrane extends Analyzer {\r\n  castsTp: number = 0;\r\n  buffTotm: number = 0;\r\n  castsBk: number = 0;\r\n  lastTotmBuffTimestamp: number = 0;\r\n  totmOverCap: number = 0;\r\n  totmBuffWasted: number = 0;\r\n  totalTotmBuffs: number = 0;\r\n\r\n  manaReturnSotc: number = 0;\r\n  sotcWasted: number = 0;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.active = this.selectedCombatant.hasTalent(SPELLS.SPIRIT_OF_THE_CRANE_TALENT.id);\r\n\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n\r\n    this.addEventListener(Events.applybuff.by(SELECTED_PLAYER).spell(SPELLS.TEACHINGS_OF_THE_MONASTERY), this.firstStack);\r\n    this.addEventListener(Events.applybuffstack.by(SELECTED_PLAYER).spell(SPELLS.TEACHINGS_OF_THE_MONASTERY), this.gainStacks);\r\n    this.addEventListener(Events.removebuff.by(SELECTED_PLAYER).spell(SPELLS.TEACHINGS_OF_THE_MONASTERY), this.lostStacks);\r\n    this.addEventListener(Events.energize.by(SELECTED_PLAYER).spell(SPELLS.SPIRIT_OF_THE_CRANE_BUFF), this.stacksToMana);\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.TIGER_PALM), this.tigerPalm);\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.BLACKOUT_KICK), this.blackoutKick);\r\n  }\r\n\r\n  get manaReturn() {\r\n    return this.manaReturnSotc;\r\n  }\r\n\r\n  get suggestionThresholds() {\r\n    return {\r\n      actual: this.manaReturn,\r\n      isLessThan: {\r\n        minor: SOTC_MANA_PER_SECOND_RETURN_MINOR * (this.owner.fightDuration / 1000),\r\n        average: SOTC_MANA_PER_SECOND_RETURN_AVERAGE * (this.owner.fightDuration / 1000),\r\n        major: SOTC_MANA_PER_SECOND_RETURN_MAJOR * (this.owner.fightDuration / 1000),\r\n      },\r\n      style: ThresholdStyle.NUMBER,\r\n    };\r\n  }\r\n\r\n  firstStack(event: ApplyBuffEvent) {\r\n\r\n    this.buffTotm += 1;\r\n    this.lastTotmBuffTimestamp = event.timestamp;\r\n    debug && console.log(`ToTM at ${this.buffTotm}`);\r\n\r\n  }\r\n\r\n  gainStacks(event: ApplyBuffStackEvent) {\r\n    this.buffTotm += 1;\r\n    this.lastTotmBuffTimestamp = event.timestamp;\r\n    debug && console.log(`ToTM at ${this.buffTotm}`);\r\n  }\r\n\r\n  lostStacks(event: RemoveBuffEvent) {\r\n    debug && console.log(event.timestamp);\r\n    if ((event.timestamp - this.lastTotmBuffTimestamp) > TEACHINGS_OF_THE_MONASTERY_DURATION) {\r\n      this.totmBuffWasted += 1;\r\n      this.buffTotm = 0;\r\n      debug && console.log('ToTM Buff Wasted');\r\n    }\r\n    this.buffTotm = 0;\r\n  }\r\n\r\n  stacksToMana(event: EnergizeEvent) {\r\n    this.manaReturnSotc += event.resourceChange - event.waste;\r\n    this.sotcWasted += event.waste;\r\n    debug && console.log(`SotC Entergize: ${event.resourceChange - event.waste} Total: ${this.manaReturnSotc}`);\r\n    debug && console.log(`SotC Waste: ${event.waste} Total: ${this.sotcWasted} Timestamp: ${event.timestamp}`);\r\n  }\r\n\r\n  tigerPalm(event: CastEvent) {\r\n    if (!this.selectedCombatant.hasBuff(SPELLS.TEACHINGS_OF_THE_MONASTERY.id)) {\r\n      return;\r\n    }\r\n\r\n    debug && console.log(`TP Casted at 3 stacks ${event.timestamp}`);\r\n    this.lastTotmBuffTimestamp = event.timestamp;\r\n    this.totmOverCap += 1;\r\n  }\r\n\r\n  blackoutKick() {\r\n    if (!this.selectedCombatant.hasBuff(SPELLS.TEACHINGS_OF_THE_MONASTERY.id)) {\r\n      return;\r\n    }\r\n\r\n    if (this.buffTotm > 0) {\r\n      if (this.selectedCombatant.hasBuff(SPELLS.TEACHINGS_OF_THE_MONASTERY.id)) {\r\n        this.totalTotmBuffs += this.buffTotm;\r\n        debug && console.log(`Black Kick Casted with Totm at ${this.buffTotm} stacks`);\r\n      }\r\n    }\r\n  }\r\n\r\n  suggestions(when: When) {\r\n    when(this.suggestionThresholds).addSuggestion((suggest, actual, recommended) => suggest(\r\n      <>\r\n        You are not utilizing your <SpellLink id={SPELLS.SPIRIT_OF_THE_CRANE_TALENT.id} /> talent as effectively as you could. Make sure you are using any available downtime to use <SpellLink id={SPELLS.TIGER_PALM.id} /> and <SpellLink id={SPELLS.BLACKOUT_KICK.id} /> to take advantage of this talent.\r\n      </>,\r\n    )\r\n      .icon(SPELLS.SPIRIT_OF_THE_CRANE_TALENT.icon)\r\n      .actual(`${formatNumber(this.manaReturn)}${i18n._(t('monk.mistweaver.suggestions.spiritOfTheCrane.manaReturned')` mana returned through Spirit of the Crane`)}`)\r\n      .recommended(`${formatNumber(recommended)} is the recommended mana return`));\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(30)}\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.TALENTS}\r\n        tooltip={(\r\n          <>\r\n            You gained a raw total of {((this.manaReturnSotc + this.sotcWasted) / 1000).toFixed(0)}k mana from SotC with {(this.sotcWasted / 1000).toFixed(0)}k wasted.<br />\r\n\r\n            You lost {(this.totmOverCap + this.totmBuffWasted)} Teachings of the Monestery stacks.<br />\r\n            <ul>\r\n              {this.totmOverCap > 0 && <li>You overcapped Teachings {(this.totmOverCap)} times</li>}\r\n              {this.totmBuffWasted > 0 && <li>You let Teachings drop off {(this.totmBuffWasted)} times</li>}\r\n            </ul>\r\n          </>\r\n        )}\r\n      >\r\n        <BoringValueText\r\n          label={<><SpellIcon id={SPELLS.SPIRIT_OF_THE_CRANE_TALENT.id} /> Mana Returned</>}\r\n        >\r\n          <>\r\n            {formatNumber(this.manaReturnSotc)}\r\n          </>\r\n        </BoringValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default SpiritOfTheCrane;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport { formatNumber, formatPercentage, formatThousands } from 'common/format';\r\nimport AbilityTracker from 'parser/shared/modules/AbilityTracker';\r\nimport Analyzer, { Options, SELECTED_PLAYER } from 'parser/core/Analyzer';\r\nimport Events, { ApplyBuffEvent, CastEvent, HealEvent } from 'parser/core/Events';\r\nimport RESOURCE_TYPES from 'game/RESOURCE_TYPES';\r\nimport { ThresholdStyle, When } from 'parser/core/ParseResults';\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport BoringValueText from 'interface/statistics/components/BoringValueText';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport SpellIcon from 'common/SpellIcon';\r\nimport SpellLink from 'common/SpellLink';\r\n\r\nimport { i18n } from '@lingui/core';\r\nimport { t } from '@lingui/macro';\r\n\r\nclass ManaTea extends Analyzer {\r\n  static dependencies = {\r\n    abilityTracker: AbilityTracker,\r\n  };\r\n  manaSavedMT: number = 0;\r\n  manateaCount: number = 0;\r\n  casts: Map<string, number> = new Map<string, number>();\r\n  effectiveHealing: number = 0;\r\n  overhealing: number = 0;\r\n  protected abilityTracker!: AbilityTracker;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.active = this.selectedCombatant.hasTalent(SPELLS.MANA_TEA_TALENT.id);\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER), this.handleCast);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER), this.heal);\r\n    this.addEventListener(Events.applybuff.by(SELECTED_PLAYER).spell(SPELLS.MANA_TEA_TALENT), this.applyBuff);\r\n  }\r\n\r\n  get avgMtSaves() {\r\n    return this.manaSavedMT / this.manateaCount || 0;\r\n  }\r\n\r\n  get suggestionThresholds() {\r\n    return {\r\n      actual: this.avgMtSaves,\r\n      isLessThan: {\r\n        minor: 7500,\r\n        average: 6500,\r\n        major: 5500,\r\n      },\r\n      style: ThresholdStyle.NUMBER,\r\n    };\r\n  }\r\n\r\n  get avgOverhealing() {\r\n    return parseFloat((this.overhealing / (this.overhealing + this.effectiveHealing) || 0).toFixed(4));\r\n  }\r\n\r\n  get suggestionThresholdsOverhealing() {\r\n    return {\r\n      actual: this.avgOverhealing,\r\n      isGreaterThan: {\r\n        minor: .20,\r\n        average: .30,\r\n        major: .40,\r\n      },\r\n      style: ThresholdStyle.PERCENTAGE,\r\n    };\r\n  }\r\n\r\n  applyBuff(event: ApplyBuffEvent) {\r\n    this.manateaCount += 1;//count the number of mana teas to make an average over teas\r\n  }\r\n\r\n  heal(event: HealEvent) {\r\n    if (this.selectedCombatant.hasBuff(SPELLS.MANA_TEA_TALENT.id)) {//if this is in a mana tea window\r\n      this.effectiveHealing += (event.amount || 0) + (event.absorbed || 0);\r\n      this.overhealing += (event.overheal || 0);\r\n    }\r\n  }\r\n\r\n  handleCast(event: CastEvent) {\r\n    const name = event.ability.name;\r\n    const manaEvent = event.classResources?.find(resource => resource.type === RESOURCE_TYPES.MANA.id);\r\n    if (manaEvent === undefined) {\r\n      return;\r\n    }\r\n\r\n    if (this.selectedCombatant.hasBuff(SPELLS.MANA_TEA_TALENT.id) && event.ability.guid !== SPELLS.MANA_TEA_TALENT.id) {//we check both since melee doesn't havea classResource\r\n      if (manaEvent.cost !== undefined) { //checks if the spell costs anything (we don't just use cost since some spells don't play nice)\r\n        this.manaSavedMT += manaEvent.cost / 2;\r\n      }\r\n      if (this.casts.has(name)) {\r\n        this.casts.set(name, (this.casts.get(name) || 0) + 1);\r\n      } else {\r\n        this.casts.set(name, 1);\r\n      }\r\n    }\r\n  }\r\n\r\n  suggestions(when: When) {\r\n    when(this.suggestionThresholds).addSuggestion((suggest, actual, recommended) => suggest(\r\n      <>\r\n        Your mana spent during <SpellLink id={SPELLS.MANA_TEA_TALENT.id} /> can be improved. Aim to prioritize as many <SpellLink id={SPELLS.VIVIFY.id} /> casts until the last second of the buff and then cast <SpellLink id={SPELLS.ESSENCE_FONT.id} />. <SpellLink id={SPELLS.ESSENCE_FONT.id} />'s mana cost is taken at the beginning of the channel, so you gain the benefit of <SpellLink id={SPELLS.MANA_TEA_TALENT.id} /> even if the channel continues past the buff.\r\n      </>,\r\n    )\r\n      .icon(SPELLS.MANA_TEA_TALENT.icon)\r\n      .actual(`${formatNumber(this.avgMtSaves)}${i18n._(t('monk.mistweaver.suggestions.manaTea.avgManaSaved')` average mana saved per Mana Tea cast`)}`)\r\n      .recommended(`${(recommended / 1000).toFixed(0)}k average mana saved is recommended`));\r\n    when(this.suggestionThresholdsOverhealing).addSuggestion((suggest, actual, recommended) => suggest(\r\n      <>\r\n        Your average overhealing was high during your <SpellLink id={SPELLS.MANA_TEA_TALENT.id} /> usage. Consider using <SpellLink id={SPELLS.MANA_TEA_TALENT.id} /> during specific boss abilities or general periods of high damage to the raid. Also look to target low health raid members to avoid large amounts of overhealing.\r\n      </>,\r\n    )\r\n      .icon(SPELLS.MANA_TEA_TALENT.icon)\r\n      .actual(`${formatPercentage(this.avgOverhealing)}${i18n._(t('monk.mistweaver.suggestions.manaTea.avgOverHealing')` % average overhealing per Mana Tea cast`)}`)\r\n      .recommended(`under ${formatPercentage(recommended)}% over healing is recommended`));\r\n  }\r\n\r\n  statistic() {\r\n    const arrayOfKeys = Array.from(this.casts.keys());\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(25)}\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.TALENTS}\r\n        tooltip={(\r\n          <>\r\n            During your {this.manateaCount} Mana Teas saved the following mana ({formatThousands(this.manaSavedMT / this.owner.fightDuration * 1000 * 5)} MP5):\r\n            <ul>\r\n              {\r\n                arrayOfKeys.map(spell => (\r\n                  <li key={spell}>\r\n                    {this.casts.get(spell)} {spell} casts\r\n                  </li>\r\n                ))\r\n              }\r\n            </ul>\r\n          </>\r\n        )}\r\n      >\r\n        <BoringValueText\r\n          label={<><SpellIcon id={SPELLS.MANA_TEA_TALENT.id} /> Average mana saved</>}\r\n        >\r\n          <>\r\n            {formatNumber(this.avgMtSaves)}\r\n          </>\r\n        </BoringValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ManaTea;\r\n","import React from 'react';\r\nimport SPELLS from 'common/SPELLS';\r\nimport { formatNumber, formatPercentage } from 'common/format';\r\nimport Analyzer, { Options, SELECTED_PLAYER } from 'parser/core/Analyzer';\r\nimport Events, { CastEvent } from 'parser/core/Events';\r\nimport { ThresholdStyle, When } from 'parser/core/ParseResults';\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport BoringValueText from 'interface/statistics/components/BoringValueText';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport SpellLink from 'common/SpellLink';\r\nimport { i18n } from '@lingui/core';\r\nimport { t } from '@lingui/macro';\r\nimport { LIFECYCLES_MANA_PERC_REDUCTION } from 'parser/monk/mistweaver/constants';\r\n\r\nconst LC_MANA_PER_SECOND_RETURN_MINOR: number = 40; //since its based on mp5 and mana & mp5 got halved going into SL we're gonna just halve this value too (80 -> 40)\r\nconst LC_MANA_PER_SECOND_RETURN_AVERAGE: number = LC_MANA_PER_SECOND_RETURN_MINOR - 15;\r\nconst LC_MANA_PER_SECOND_RETURN_MAJOR: number = LC_MANA_PER_SECOND_RETURN_MINOR - 15;\r\nconst CHIJI_MANA_SAVED_PER_STACK: number = 1001;\r\nconst MAX_CHIJI_STACKS: number = 3;\r\n\r\nconst debug: boolean = false;\r\n\r\nclass Lifecycles extends Analyzer {\r\n  manaSaved: number = 0;\r\n  manaSavedViv: number = 0;\r\n  manaSavedEnm: number = 0;\r\n  castsRedEnm: number = 0;\r\n  castsRedViv: number = 0;\r\n  castsNonRedViv: number = 0;\r\n  castsNonRedEnm: number = 0;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.active = this.selectedCombatant.hasTalent(SPELLS.LIFECYCLES_TALENT.id);\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.VIVIFY), this.vivifyCast);\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.ENVELOPING_MIST), this.envelopingMistCast);\r\n  }\r\n\r\n  get suggestionThresholds() {\r\n    return {\r\n      actual: this.manaSaved,\r\n      isLessThan: {\r\n        minor: LC_MANA_PER_SECOND_RETURN_MINOR * (this.owner.fightDuration / 1000),\r\n        average: LC_MANA_PER_SECOND_RETURN_AVERAGE * (this.owner.fightDuration / 1000),\r\n        major: LC_MANA_PER_SECOND_RETURN_MAJOR * (this.owner.fightDuration / 1000),\r\n      },\r\n      style: ThresholdStyle.NUMBER,\r\n    };\r\n  }\r\n\r\n  vivifyCast(event: CastEvent) {\r\n    // Checking for TFT->Viv and classify as non-reduced Viv\r\n    if (this.selectedCombatant.hasBuff(SPELLS.THUNDER_FOCUS_TEA.id) || this.selectedCombatant.hasBuff(SPELLS.INNERVATE.id)) {\r\n      return;\r\n    }\r\n    if (!this.selectedCombatant.hasBuff(SPELLS.LIFECYCLES_VIVIFY_BUFF.id)) {\r\n      this.castsNonRedViv += 1;\r\n      return;\r\n    }\r\n    this.manaSaved += SPELLS.VIVIFY.manaCost * LIFECYCLES_MANA_PERC_REDUCTION;\r\n    this.manaSavedViv += SPELLS.VIVIFY.manaCost * LIFECYCLES_MANA_PERC_REDUCTION;\r\n    this.castsRedViv += 1;\r\n    debug && console.log('Viv Reduced');\r\n  }\r\n\r\n  envelopingMistCast(event: CastEvent) {\r\n    if (this.selectedCombatant.hasBuff(SPELLS.INNERVATE.id)) {\r\n      return;\r\n    }\r\n    // Checking to ensure player has cast Enveloping Mists and has the mana reduction buff\r\n    if (!this.selectedCombatant.hasBuff(SPELLS.LIFECYCLES_ENVELOPING_MIST_BUFF.id)) {\r\n      this.castsNonRedEnm += 1;\r\n      return;\r\n    }\r\n    // Checking for chiji stacks and determine mana reduction\r\n    const chijiStacksAtEnvCast = this.selectedCombatant.getBuff(SPELLS.INVOKE_CHIJI_THE_RED_CRANE_BUFF.id, event.timestamp)?.stacks;\r\n    if (!chijiStacksAtEnvCast) {\r\n      this.calculateEnvManaSaved(SPELLS.ENVELOPING_MIST.manaCost);\r\n      return;\r\n    }\r\n    //check for free cast from chiji\r\n    if (chijiStacksAtEnvCast === MAX_CHIJI_STACKS) {\r\n      return;\r\n    }\r\n    //have to do this weird because blizzard decided to make each chiji stack reduce the mana cost by 1001 instead of and exact 33%\r\n    const modifiedManaCost = SPELLS.ENVELOPING_MIST.manaCost - (CHIJI_MANA_SAVED_PER_STACK * chijiStacksAtEnvCast);\r\n    this.calculateEnvManaSaved(modifiedManaCost);\r\n  }\r\n\r\n  calculateEnvManaSaved(manaCost: number) {\r\n    this.manaSaved += manaCost * LIFECYCLES_MANA_PERC_REDUCTION;\r\n    this.manaSavedEnm += manaCost * LIFECYCLES_MANA_PERC_REDUCTION;\r\n    this.castsRedEnm += 1;\r\n    debug && console.log('Env Reduced');\r\n  }\r\n\r\n  suggestions(when: When) {\r\n    when(this.suggestionThresholds).addSuggestion((suggest, actual, recommended) => suggest(\r\n      <>\r\n        Your current spell usage is not taking full advantage of the <SpellLink id={SPELLS.LIFECYCLES_TALENT.id} /> talent. You should be trying to alternate the use of these spells as often as possible to take advantage of the buff.\r\n      </>,\r\n    )\r\n      .icon(SPELLS.LIFECYCLES_TALENT.icon)\r\n      .actual(`${formatNumber(actual)}${i18n._(t('monk.mistweaver.suggestions.lifecycles.manaSaved')` mana saved through Lifecycles`)}`)\r\n      .recommended(`${formatNumber(recommended)} is the recommended amount of mana savings`));\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(70)}\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.TALENTS}\r\n        tooltip={(\r\n          <>\r\n            You saved a total of {this.manaSaved} mana from the Lifecycles talent.\r\n            <ul>\r\n              <li>On {this.castsRedViv} Vivify casts, you saved {(this.manaSavedViv / 1000).toFixed(0)}k mana. ({formatPercentage(this.castsRedViv / (this.castsRedViv + this.castsNonRedViv))}%)</li>\r\n              <li>On {this.castsRedEnm} Enveloping Mists casts, you saved {(this.manaSavedEnm / 1000).toFixed(0)}k mana. ({formatPercentage(this.castsRedEnm / (this.castsRedEnm + this.castsNonRedEnm))}%)</li>\r\n              <li>You casted {this.castsNonRedViv} Vivify's and {this.castsNonRedEnm} Enveloping Mists for full mana cost.</li>\r\n            </ul>\r\n          </>\r\n        )}\r\n      >\r\n        <BoringValueText\r\n          label={<><SpellLink id={SPELLS.LIFECYCLES_TALENT.id} /></>}\r\n        >\r\n          <>\r\n            {formatNumber(this.manaSaved)} Mana Saved\r\n          </>\r\n        </BoringValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Lifecycles;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport SpellLink from 'common/SpellLink';\r\n\r\nimport Analyzer, { Options, SELECTED_PLAYER } from 'parser/core/Analyzer';\r\nimport Events, { CastEvent } from 'parser/core/Events';\r\n\r\nimport { STATISTIC_ORDER } from 'interface/others/StatisticsListBox';\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport DonutChart from 'interface/statistics/components/DonutChart';\r\nimport { ThresholdStyle, When } from 'parser/core/ParseResults';\r\nimport RESOURCE_TYPES from 'game/RESOURCE_TYPES';\r\n\r\nimport { i18n } from '@lingui/core';\r\nimport { t } from '@lingui/macro';\r\n\r\nconst debug = false;\r\n\r\n//TODO clean up and make easier to add triggers\r\nclass ThunderFocusTea extends Analyzer {\r\n  castsTftRsk: number = 0;\r\n  castsTftViv: number = 0;\r\n  castsTftEnm: number = 0;\r\n  castsTftRem: number = 0;\r\n\r\n  castsTft: number = 0;\r\n  castsUnderTft: number = 0;\r\n\r\n  correctCasts: number = 0;\r\n\r\n  castBufferTimestamp: number = 0;\r\n  ftActive: boolean = false;\r\n  rmActive: boolean = false;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.ftActive = this.selectedCombatant.hasTalent(SPELLS.FOCUSED_THUNDER_TALENT.id);\r\n    this.rmActive = this.selectedCombatant.hasTalent(SPELLS.RISING_MIST_TALENT.id);\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.THUNDER_FOCUS_TEA), this.tftCast);\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER), this.buffedCast);\r\n  }\r\n\r\n  get incorrectTftCasts() {\r\n    return this.castsUnderTft - this.correctCasts;\r\n  }\r\n\r\n  get suggestionThresholds() {\r\n    return {\r\n      actual: this.incorrectTftCasts,\r\n      isGreaterThan: {\r\n        minor: 1,\r\n        average: 1.5,\r\n        major: 2,\r\n      },\r\n      style: ThresholdStyle.NUMBER,\r\n    };\r\n  }\r\n\r\n  tftCast(event: CastEvent) {\r\n    this.castsTft += this.ftActive ? 2 : 1;\r\n  }\r\n\r\n  buffedCast(event: CastEvent) {\r\n    const spellId: number = event.ability.guid;\r\n\r\n    // Implemented as a way to remove non-buffed REM casts that occur at the same timestamp as the buffed Viv cast.\r\n    // Need to think of cleaner solution\r\n    if ((event.timestamp - this.castBufferTimestamp) < 25) {\r\n      return;\r\n    }\r\n\r\n    if (this.selectedCombatant.hasBuff(SPELLS.THUNDER_FOCUS_TEA.id)) {\r\n      if (SPELLS.VIVIFY.id === spellId && !event.classResources?.find(resource => resource.type === RESOURCE_TYPES.MANA.id)?.cost) {\r\n        this.castsUnderTft += 1;\r\n        this.castsTftViv += 1;\r\n        this.correctCasts += 1;\r\n        debug && console.log('Viv TFT Check ', event.timestamp);\r\n        this.castBufferTimestamp = event.timestamp;\r\n      }\r\n      if (SPELLS.RISING_SUN_KICK.id === spellId) {\r\n        this.castsUnderTft += 1;\r\n        this.castsTftRsk += 1;\r\n\r\n        if (this.rmActive) {\r\n          this.correctCasts += 1;\r\n        }\r\n\r\n        debug && console.log('RSK TFT Check ', event.timestamp);\r\n      }\r\n      if (SPELLS.ENVELOPING_MIST.id === spellId) {\r\n        this.castsUnderTft += 1;\r\n        this.castsTftEnm += 1;\r\n        debug && console.log('Enm TFT Check ', event.timestamp);\r\n      }\r\n      if (SPELLS.RENEWING_MIST.id === spellId) {\r\n        this.castsUnderTft += 1;\r\n        this.castsTftRem += 1;\r\n        this.correctCasts += 1;\r\n        debug && console.log('REM TFT Check ', event.timestamp);\r\n      }\r\n    }\r\n  }\r\n\r\n  renderCastRatioChart() {\r\n    const items = [\r\n      {\r\n        color: '#00b159',\r\n        label: 'Vivify',\r\n        spellId: SPELLS.VIVIFY.id,\r\n        value: this.castsTftViv,\r\n      },\r\n      {\r\n        color: '#db00db',\r\n        label: 'Renewing Mist',\r\n        spellId: SPELLS.RENEWING_MIST.id,\r\n        value: this.castsTftRem,\r\n      },\r\n      {\r\n        color: '#f37735',\r\n        label: 'Enveloping Mists',\r\n        spellId: SPELLS.ENVELOPING_MIST.id,\r\n        value: this.castsTftEnm,\r\n      },\r\n      {\r\n        color: '#ffc425',\r\n        label: 'Rising Sun Kick',\r\n        spellId: SPELLS.RISING_SUN_KICK.id,\r\n        value: this.castsTftRsk,\r\n      },\r\n    ];\r\n\r\n    return (\r\n      <DonutChart\r\n        items={items}\r\n      />\r\n    );\r\n  }\r\n\r\n  suggestions(when: When) {\r\n    when(this.suggestionThresholds).addSuggestion((suggest, actual, recommended) => suggest(\r\n      <>\r\n        You are currently using <SpellLink id={SPELLS.THUNDER_FOCUS_TEA.id} /> to buff spells other than {this.rmActive ? <SpellLink id={SPELLS.RISING_SUN_KICK.id} /> : <SpellLink id={SPELLS.VIVIFY.id} />} or <SpellLink id={SPELLS.RENEWING_MIST.id} />. It is advised to limit the number of spells buffed to only these two.\r\n      </>,\r\n    )\r\n      .icon(SPELLS.THUNDER_FOCUS_TEA.icon)\r\n      .actual(`${this.incorrectTftCasts}${i18n._(t('monk.mistweaver.suggestions.thunderFocusTea.incorrectCasts')`incorrect casts with Thunder Focus Tea`)}`)\r\n      .recommended(`<${recommended} incorrect cast is recommended`));\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.CORE(20)}\r\n        size=\"flexible\"\r\n      >\r\n        <div className=\"pad\">\r\n          <label><SpellLink id={SPELLS.THUNDER_FOCUS_TEA.id} /> usage</label>\r\n          {this.renderCastRatioChart()}\r\n        </div>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ThunderFocusTea;\r\n","// Based on Clearcasting Implementation done by @Blazyb\r\nimport React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport SpellLink from 'common/SpellLink';\r\nimport SpellIcon from 'common/SpellIcon';\r\nimport { formatNumber } from 'common/format';\r\nimport { TooltipElement } from 'common/Tooltip';\r\n\r\nimport Analyzer, { Options, SELECTED_PLAYER } from 'parser/core/Analyzer';\r\nimport Events, { CastEvent, HealEvent } from 'parser/core/Events';\r\nimport Combatants from 'parser/shared/modules/Combatants';\r\n\r\nimport AbilityTracker from 'parser/shared/modules/AbilityTracker';\r\n\r\nimport StatisticBox, { STATISTIC_ORDER } from 'interface/others/StatisticBox';\r\nimport { ThresholdStyle, When } from 'parser/core/ParseResults';\r\n\r\nimport { i18n } from '@lingui/core';\r\nimport { t } from '@lingui/macro';\r\n\r\nclass Vivify extends Analyzer {\r\n  static dependencies = {\r\n    abilityTracker: AbilityTracker,\r\n    combatants: Combatants,\r\n  };\r\n  remVivifyHealCount: number = 0;\r\n  remVivifyHealing: number = 0;\r\n  gustsHealing: number = 0;\r\n  lastCastTarget: number = 0;\r\n  remDuringManaTea: number = 0;\r\n  numberToCount: number = 0;\r\n  protected abilityTracker!: AbilityTracker;\r\n  protected combatants!: Combatants;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.VIVIFY), this.vivCast);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.VIVIFY), this.handleViv);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.GUSTS_OF_MISTS), this.handleMastery);\r\n  }\r\n\r\n  get averageRemPerVivify() {\r\n    const vivifyCasts = this.abilityTracker.getAbility(SPELLS.VIVIFY.id).casts || 0;\r\n\r\n    return this.remVivifyHealCount / vivifyCasts || 0;\r\n  }\r\n\r\n  get suggestionThresholds() {\r\n    return {\r\n      actual: this.averageRemPerVivify,\r\n      isLessThan: {\r\n        minor: 1.75,\r\n        average: 1.25,\r\n        major: 0.75,\r\n      },\r\n      style: ThresholdStyle.NUMBER,\r\n    };\r\n  }\r\n\r\n  vivCast(event: CastEvent) {\r\n    this.numberToCount += 1;\r\n    this.lastCastTarget = event.targetID || 0;\r\n  }\r\n\r\n  handleViv(event: HealEvent) {\r\n    if ((this.lastCastTarget !== event.targetID)) {\r\n      this.remVivifyHealCount += 1;\r\n      this.remVivifyHealing += (event.amount || 0) + (event.absorbed || 0);\r\n      if (this.selectedCombatant.hasBuff(SPELLS.MANA_TEA_TALENT.id)) {\r\n        this.remDuringManaTea += 1;\r\n      }\r\n    }\r\n  }\r\n\r\n  handleMastery(event: HealEvent) {\r\n    if ((this.lastCastTarget === event.targetID) && this.numberToCount > 0) {\r\n      this.gustsHealing += (event.amount || 0) + (event.absorbed || 0);\r\n      this.numberToCount -= 1;\r\n    }\r\n  }\r\n\r\n  suggestions(when: When) {\r\n    when(this.suggestionThresholds).addSuggestion((suggest, actual, recommended) => suggest(\r\n      <>\r\n        You are casting <SpellLink id={SPELLS.VIVIFY.id} /> with less than 2 <SpellLink id={SPELLS.RENEWING_MIST.id} /> out on the raid. To ensure you are gaining the maximum <SpellLink id={SPELLS.VIVIFY.id} /> healing, keep <SpellLink id={SPELLS.RENEWING_MIST.id} /> on cooldown.\r\n      </>,\r\n    )\r\n      .icon(SPELLS.VIVIFY.icon)\r\n      .actual(`${this.averageRemPerVivify.toFixed(2)}${i18n._(t('monk.mistweaver.suggestions.vivify.renewingMistsPerVivify')` Renewing Mists per Vivify`)}`)\r\n      .recommended(`${recommended} Renewing Mists are recommended per Vivify`));\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <StatisticBox\r\n        postion={STATISTIC_ORDER.CORE(15)}\r\n        icon={<SpellIcon id={SPELLS.VIVIFY.id} />}\r\n        value={`${this.averageRemPerVivify.toFixed(2)}`}\r\n        label={(\r\n          <TooltipElement\r\n            content={(\r\n              <>\r\n                Healing Breakdown:\r\n                <ul>\r\n                  <li>{formatNumber(this.abilityTracker.getAbility(SPELLS.VIVIFY.id).healingEffective)} overall healing from Vivify.</li>\r\n                  <li>{formatNumber(this.remVivifyHealing)} portion of your Vivify healing to REM targets.</li>\r\n                </ul>\r\n              </>\r\n            )}\r\n          >\r\n            Avg REMs per Cast\r\n          </TooltipElement>\r\n        )}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default Vivify;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\n\r\nimport AbilityTracker from 'parser/shared/modules/AbilityTracker';\r\nimport Analyzer, { Options } from 'parser/core/Analyzer';\r\n\r\nimport { ThresholdStyle, When } from 'parser/core/ParseResults';\r\n\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport BoringValueText from 'interface/statistics/components/BoringValueText';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport SpellIcon from 'common/SpellIcon';\r\nimport SpellLink from 'common/SpellLink';\r\n\r\nimport { i18n } from '@lingui/core';\r\nimport { t } from '@lingui/macro';\r\n\r\nimport Vivify from '../spells/Vivify';\r\nimport ManaTea from './ManaTea';\r\n\r\nclass RenewingMistDuringManaTea extends Analyzer {\r\n  static dependencies = {\r\n    abilityTracker: AbilityTracker,\r\n    vivify: Vivify,\r\n    manaTea: ManaTea,\r\n  };\r\n\r\n  protected abilityTracker!: AbilityTracker;\r\n  protected vivify!: Vivify;\r\n  protected manaTea!: ManaTea;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.active = this.selectedCombatant.hasTalent(SPELLS.MANA_TEA_TALENT.id);\r\n  }\r\n\r\n  get avgRemDuringMT() {\r\n    return (this.vivify.remDuringManaTea / (this.manaTea.casts.get('Vivify') || 0)) || 0;\r\n  }\r\n\r\n  get suggestionThresholds() {\r\n    return {\r\n      actual: this.avgRemDuringMT,\r\n      isLessThan: {\r\n        minor: 2,\r\n        average: 1.5,\r\n        major: 1,\r\n      },\r\n      style: ThresholdStyle.NUMBER,\r\n    };\r\n  }\r\n\r\n  suggestions(when: When) {\r\n    when(this.suggestionThresholds).addSuggestion((suggest, actual, recommended) => suggest(\r\n      <>\r\n        During <SpellLink id={SPELLS.MANA_TEA_TALENT.id} /> you should have a minimum of two <SpellLink id={SPELLS.RENEWING_MIST.id} /> out to maximize your healing during the buff.\r\n      </>,\r\n    )\r\n      .icon(SPELLS.MANA_TEA_TALENT.icon)\r\n      .actual(`${this.avgRemDuringMT.toFixed(2)}${i18n._(t('monk.mistweaver.suggestions.renewingMistDuringManaTea.avgRenewingMists')` average Renewing Mists during Mana Tea`)}`)\r\n      .recommended(`${recommended} average Renewing Mists recommended`));\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(30)}\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.TALENTS}\r\n        tooltip={(\r\n          <>\r\n            This is the average number of Renewing Mists active during Mana Tea\r\n          </>\r\n        )}\r\n      >\r\n        <BoringValueText\r\n          label={<><SpellIcon id={SPELLS.MANA_TEA_TALENT.id} /> Average Renewing Mists</>}\r\n        >\r\n          <>\r\n            {this.avgRemDuringMT.toFixed(2)}\r\n          </>\r\n        </BoringValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default RenewingMistDuringManaTea;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport SpellLink from 'common/SpellLink';\r\n\r\nimport Analyzer, { Options, SELECTED_PLAYER } from 'parser/core/Analyzer';\r\nimport Events, { CastEvent, DamageEvent, FightEndEvent } from 'parser/core/Events';\r\nimport { formatMilliseconds } from 'common/format';\r\nimport { ThresholdStyle, When } from 'parser/core/ParseResults';\r\n\r\nimport { i18n } from '@lingui/core';\r\nimport { t } from '@lingui/macro';\r\n\r\nclass SpinningCraneKick extends Analyzer {\r\n  goodSCKcount: number = 0;\r\n  goodSCKTimeList: string[] = [];\r\n  badSCKcount: number = 0;\r\n  badSCKTimeList: string[] = [];\r\n  canceledSCKcount: number = 0;//figure out if this is possible\r\n  enemiesHitSCK: string[] = [];\r\n  currentTime: number = 0;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.SPINNING_CRANE_KICK), this.castSpinningCraneKick);\r\n    this.addEventListener(Events.damage.by(SELECTED_PLAYER).spell(SPELLS.SPINNING_CRANE_KICK), this.handleSpinningCraneKick);\r\n    this.addEventListener(Events.fightend, this.fightEnd);\r\n  }\r\n\r\n  get suggestionThresholds() {\r\n    return {\r\n      actual: this.badSCKcount,\r\n      isGreaterThan: {//following the tft logic of one is okay anymore is bad\r\n        minor: 1,\r\n        average: 1.5,\r\n        major: 2,\r\n      },\r\n      style: ThresholdStyle.NUMBER,\r\n    };\r\n  }\r\n\r\n  castSpinningCraneKick(event: CastEvent) {\r\n    if (this.enemiesHitSCK.length > 0) { //this nested is needed due to weird logs\r\n      this.checkSCK();\r\n    }\r\n    this.currentTime = this.owner.currentTimestamp - this.owner.fight.start_time;\r\n    this.enemiesHitSCK = [];\r\n  }\r\n\r\n  //tracking channel time isn't needed due to the fact it is the same as a gcd so they have to have another cast event\r\n  handleSpinningCraneKick(event: DamageEvent) {\r\n    const enemy = `${event.targetID} ${event.targetInstance || 0}`;\r\n    if (!this.enemiesHitSCK.includes(enemy)) {\r\n      this.enemiesHitSCK.push(enemy);\r\n    }\r\n  }\r\n\r\n  fightEnd(event: FightEndEvent) {\r\n    if (this.enemiesHitSCK) {\r\n      this.checkSCK();\r\n    }\r\n  }\r\n\r\n  checkSCK() {\r\n    if (this.enemiesHitSCK.length > 2) {\r\n      this.goodSCKcount += 1;\r\n      this.goodSCKTimeList.push(formatMilliseconds(this.currentTime));\r\n    } else {\r\n      this.badSCKcount += 1;\r\n      this.badSCKTimeList.push(formatMilliseconds(this.currentTime));\r\n    }\r\n  }\r\n\r\n  suggestions(when: When) {\r\n    when(this.suggestionThresholds).addSuggestion((suggest, actual, recommended) => suggest(\r\n      <>\r\n        You are not utilizing your <SpellLink id={SPELLS.SPINNING_CRANE_KICK.id} /> spell as effectively as you should. You should work on both your positioning spell. Always aim for the highest concentration of enemies, which is normally melee.\r\n      </>,\r\n    )\r\n      .icon(SPELLS.SPINNING_CRANE_KICK.icon)\r\n      .actual(`${this.badSCKcount}${i18n._(t('monk.mistweaver.suggestions.spinningCraneKick.efficiency')` Spinning Crane Kicks that hit fewer than 3 enemies`)}`)\r\n      .recommended('Aim to hit 3 or more targets with Spinning Crane Kick if there is less than 3 targets then Rising Sunkick, Blackout Kick or Tiger\\'s palm'));\r\n  }\r\n\r\n}\r\n\r\nexport default SpinningCraneKick;\r\n","import React from 'react';\r\nimport { formatPercentage } from 'common/format';\r\nimport AbilityTracker from 'parser/shared/modules/AbilityTracker';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\n\r\nimport Analyzer, { Options, SELECTED_PLAYER_PET } from 'parser/core/Analyzer';\r\nimport Events, { ApplyBuffEvent, HealEvent, RefreshBuffEvent, RemoveBuffEvent } from 'parser/core/Events';\r\nimport Combatants from 'parser/shared/modules/Combatants';\r\nimport { ThresholdStyle, When } from 'parser/core/ParseResults';\r\n\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport BoringValueText from 'interface/statistics/components/BoringValueText';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport SpellIcon from 'common/SpellIcon';\r\nimport SpellLink from 'common/SpellLink';\r\n\r\nimport { i18n } from '@lingui/core';\r\nimport { t } from '@lingui/macro';\r\n\r\nclass JadeSerpentStatue extends Analyzer {\r\n  static dependencies = {\r\n    abilityTracker: AbilityTracker,\r\n    combatants: Combatants,\r\n  };\r\n  healing: number = 0;\r\n  overHealing: number = 0;\r\n  casts: number = 0;\r\n  soothingMistUptime: number = 0;\r\n  lastBuffApplyTimestamp: number = 0;\r\n  jssCasting: boolean = false;\r\n  protected abilityTracker!: AbilityTracker;\r\n  protected combatants!: Combatants;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.active = this.selectedCombatant.hasTalent(SPELLS.SUMMON_JADE_SERPENT_STATUE_TALENT.id);\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER_PET).spell(SPELLS.SOOTHING_MIST_STATUE), this.jssHeal);\r\n    this.addEventListener(Events.applybuff.by(SELECTED_PLAYER_PET).spell(SPELLS.SOOTHING_MIST_STATUE), this.jssApplyBuff);\r\n    this.addEventListener(Events.removebuff.by(SELECTED_PLAYER_PET).spell(SPELLS.SOOTHING_MIST_STATUE), this.jssRemoveBuff);\r\n    this.addEventListener(Events.refreshbuff.by(SELECTED_PLAYER_PET).spell(SPELLS.SOOTHING_MIST_STATUE), this.jssRefreshBuff);\r\n    this.addEventListener(Events.fightend, this.endFight);\r\n  }\r\n\r\n  get jadeSerpentStatueUptime() {\r\n    return this.soothingMistUptime / this.owner.fightDuration;\r\n  }\r\n\r\n  get suggestionThresholds() {\r\n    return {\r\n      actual: this.jadeSerpentStatueUptime,\r\n      isLessThan: {\r\n        minor: .85,\r\n        average: .75,\r\n        major: .65,\r\n      },\r\n      style: ThresholdStyle.PERCENTAGE,\r\n    };\r\n  }\r\n\r\n  jssHeal(event: HealEvent) {\r\n    this.healing += (event.amount || 0) + (event.absorbed || 0);\r\n    this.overHealing += event.overheal || 0;\r\n    this.casts += 1;\r\n\r\n  }\r\n\r\n  jssApplyBuff(event: ApplyBuffEvent) {\r\n    this.lastBuffApplyTimestamp = event.timestamp;\r\n    this.jssCasting = true;\r\n  }\r\n\r\n  jssRemoveBuff(event: RemoveBuffEvent) {\r\n\r\n    // Care for buff application before fight.\r\n    if (this.lastBuffApplyTimestamp === null) {\r\n      this.soothingMistUptime += event.timestamp - this.owner.fight.start_time;\r\n      return;\r\n    }\r\n\r\n    this.soothingMistUptime += event.timestamp - this.lastBuffApplyTimestamp;\r\n    this.jssCasting = false;\r\n  }\r\n\r\n  jssRefreshBuff(event: RefreshBuffEvent) {\r\n    const spellId = event.ability.guid;\r\n    if (spellId !== SPELLS.SOOTHING_MIST_STATUE.id) {\r\n      return;\r\n    }\r\n\r\n    // Care for buff application before fight.\r\n    if (this.lastBuffApplyTimestamp === null) {\r\n      this.soothingMistUptime += event.timestamp - this.owner.fight.start_time;\r\n    } else {\r\n      this.soothingMistUptime += event.timestamp - this.lastBuffApplyTimestamp;\r\n    }\r\n\r\n    this.lastBuffApplyTimestamp = event.timestamp;\r\n    this.jssCasting = true;\r\n  }\r\n\r\n  endFight() {\r\n    if (this.jssCasting) {\r\n      this.soothingMistUptime += this.owner.fight.end_time - this.lastBuffApplyTimestamp;\r\n    }\r\n  }\r\n\r\n  suggestions(when: When) {\r\n    when(this.suggestionThresholds).addSuggestion((suggest, actual, recommended) => suggest(\r\n      <>\r\n        You selected <SpellLink id={SPELLS.SUMMON_JADE_SERPENT_STATUE_TALENT.id} /> as your talent. To gain the most value out of this talent you should have it casting on someone as often as possible. The priority should be tanks or any raid member taking heavy damage, such as from a specific DOT or boss mechanic.\r\n      </>,\r\n    )\r\n      .icon(SPELLS.SUMMON_JADE_SERPENT_STATUE_TALENT.icon)\r\n      .actual(`${formatPercentage(actual)}${i18n._(t('monk.mistweaver.jadeSerpentStatue.uptime')`% uptime`)}`)\r\n      .recommended(`${formatPercentage(recommended)}% uptime is recommended`));\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(13)}\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.TALENTS}\r\n      >\r\n        <BoringValueText\r\n          label={<><SpellIcon id={SPELLS.SUMMON_JADE_SERPENT_STATUE_TALENT.id} /> % Uptime</>}\r\n        >\r\n          <>\r\n            {formatPercentage(this.jadeSerpentStatueUptime)}\r\n          </>\r\n        </BoringValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n\r\n}\r\n\r\nexport default JadeSerpentStatue;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport { formatNumber } from 'common/format';\r\n\r\nimport AbilityTracker from 'parser/shared/modules/AbilityTracker';\r\nimport Analyzer, { Options } from 'parser/core/Analyzer';\r\nimport Events from 'parser/core/Events';\r\nimport ManaTracker from 'parser/core/healingEfficiency/ManaTracker';\r\n\r\nimport { ThresholdStyle, When } from 'parser/core/ParseResults';\r\n\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport BoringValueText from 'interface/statistics/components/BoringValueText';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport SpellIcon from 'common/SpellIcon';\r\nimport SpellLink from 'common/SpellLink';\r\n\r\nimport { i18n } from '@lingui/core';\r\nimport { t } from '@lingui/macro';\r\nimport { LIFECYCLES_MANA_PERC_REDUCTION } from 'parser/monk/mistweaver/constants';\r\n\r\nimport ManaTea from './ManaTea';\r\nimport SpiritOfTheCrane from './SpiritOfTheCrane';\r\nimport Lifecycles from './Lifecycles';\r\n\r\nconst debug = false;\r\n\r\nclass Tier45Comparison extends Analyzer {\r\n  static dependencies = {\r\n    abilityTracker: AbilityTracker,\r\n    manaTea: ManaTea,\r\n    manaTracker: ManaTracker,\r\n    spiritOfTheCrane: SpiritOfTheCrane,\r\n    lifeCycles: Lifecycles,\r\n  };\r\n  manatea: BestTalent & { requiredPerTea: number; } = {\r\n    selected: false,//is this the selected talent\r\n    manaFrom: 0,//how much mana did they save/get from talent (will compute even if not selected)\r\n    icon: SPELLS.MANA_TEA_TALENT.icon,//icon\r\n    name: SPELLS.MANA_TEA_TALENT.name,//name\r\n    id: SPELLS.MANA_TEA_TALENT.id,//id\r\n    best: false,//is it the best talent\r\n    requiredPerTea: 0,//differs from talent to talent but tldr its the requirements to equal best\r\n  };\r\n  lifecycles: BestTalent & { requiredVivs: number; requiredEnvs: number } = {\r\n    selected: false,\r\n    manaFrom: 0,\r\n    icon: SPELLS.LIFECYCLES_TALENT.icon,\r\n    name: SPELLS.LIFECYCLES_TALENT.name,\r\n    id: SPELLS.LIFECYCLES_TALENT.id,\r\n    best: false,\r\n    requiredVivs: 0,\r\n    requiredEnvs: 0,\r\n  };\r\n  sotc: BestTalent & { requiredTps: number; } = {\r\n    selected: false,\r\n    manaFrom: 0,\r\n    icon: SPELLS.SPIRIT_OF_THE_CRANE_TALENT.icon,\r\n    name: SPELLS.SPIRIT_OF_THE_CRANE_TALENT.name,\r\n    id: SPELLS.SPIRIT_OF_THE_CRANE_TALENT.id,\r\n    best: false,\r\n    requiredTps: 0,\r\n  };\r\n  talents = [this.manatea, this.lifecycles, this.sotc];\r\n  returnedFromSelected = 0;\r\n  best!: BestTalent;\r\n  protected abilityTracker!: AbilityTracker;\r\n  protected manaTea!: ManaTea;\r\n  protected manaTracker!: ManaTracker;\r\n  protected spiritOfTheCrane!: SpiritOfTheCrane;\r\n  protected lifeCycles!: Lifecycles;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.sotc.selected = this.selectedCombatant.hasTalent(SPELLS.SPIRIT_OF_THE_CRANE_TALENT.id);\r\n    this.manatea.selected = this.selectedCombatant.hasTalent(SPELLS.MANA_TEA_TALENT.id);\r\n    this.lifecycles.selected = !(this.sotc.selected || this.manatea.selected);\r\n    this.addEventListener(Events.fightend, this.endFight);\r\n\r\n  }\r\n\r\n  get suggestionThresholds() {\r\n    return {\r\n      actual: this.best.selected,\r\n      isEqual: false,\r\n      style: ThresholdStyle.BOOLEAN,\r\n    };\r\n  }\r\n\r\n  endFight() {\r\n    // --- get mana from talents --- //\r\n    if (this.sotc.selected) {\r\n      this.sotc.manaFrom = (this.spiritOfTheCrane.manaReturnSotc || 0);\r\n      this.returnedFromSelected = this.sotc.manaFrom;\r\n    }\r\n\r\n    if (this.manatea.selected) {\r\n      this.manatea.manaFrom = (this.manaTea.manaSavedMT || 0);\r\n      this.returnedFromSelected = this.manatea.manaFrom;\r\n    }\r\n\r\n    if (this.lifecycles.selected) {\r\n      this.lifecycles.manaFrom = this.lifeCycles.manaSaved;\r\n      this.returnedFromSelected = this.lifecycles.manaFrom;\r\n    }\r\n    // --- end get mana from talents ---//\r\n\r\n    // --- setup talents that were not selected --- //\r\n    this.sotc.manaFrom = this.sotc.selected ? this.sotc.manaFrom : this.generateSotc();\r\n    this.manatea.manaFrom = this.manatea.selected ? this.manatea.manaFrom : this.generateManaTea();\r\n    this.lifecycles.manaFrom = this.lifecycles.selected ? this.lifecycles.manaFrom : this.generateLifeCycles();\r\n    // --- end setup talents that were not selected --- //\r\n\r\n    // --- pick best --- //\r\n    if (this.sotc.manaFrom > this.manatea.manaFrom && this.sotc.manaFrom > this.lifecycles.manaFrom) {\r\n      this.best = this.sotc;\r\n    }\r\n    if (this.manatea.manaFrom > this.sotc.manaFrom && this.manatea.manaFrom > this.lifecycles.manaFrom) {\r\n      this.best = this.manatea;\r\n    }\r\n    if (this.lifecycles.manaFrom > this.manatea.manaFrom && this.lifecycles.manaFrom > this.sotc.manaFrom) {\r\n      this.best = this.lifecycles;\r\n    }\r\n    if (!this.best) {\r\n      this.best = this.manatea;\r\n    }\r\n    // --- end picking best --- //\r\n\r\n    // -- sees what it takes for the other ones to equal the best -- //\r\n    this.calculateOthers();\r\n\r\n    // -- logging for debug --//\r\n    if (debug) {\r\n      console.log(this.manatea);\r\n      console.log(this.sotc);\r\n      console.log(this.lifecycles);\r\n    }\r\n  }\r\n\r\n  //sotc gives mana back while the other two save mana\r\n\r\n  calculateOthers() {\r\n\r\n    if (this.sotc !== this.best) {\r\n      //sotc gives .65% mana per totm stack used so (max mana * .0065) = mana per totm\r\n      //mana from best talent / mana per totom = totm stacks need but gotta round up since you can't have .5 of a totm stack\r\n      this.sotc.requiredTps = Math.ceil(this.best.manaFrom / (this.manaTracker.maxResource * .0065));\r\n    }\r\n\r\n    if (this.lifecycles !== this.best) {\r\n      //life cycles reduces mana cost of two spells if you casted the other before hand\r\n      //so best = (x-1) * VivCost * LifcylesReduction + x * EnvCost * LifcylesReduction = (best + ReducedViv) / ReducedEnv = x\r\n      //x-1 since you viv first in all fights\r\n      this.lifecycles.requiredEnvs = Math.ceil((this.best.manaFrom + SPELLS.VIVIFY.manaCost * SPELLS.LIFECYCLES_VIVIFY_BUFF.manaPercRed) / SPELLS.ENVELOPING_MIST.manaCost * SPELLS.LIFECYCLES_ENVELOPING_MIST_BUFF.manaPercRed);\r\n      this.lifecycles.requiredVivs = this.lifecycles.requiredEnvs - 1;\r\n    }\r\n\r\n    if (this.manatea !== this.best) {\r\n      const fightLength = (this.owner.fight.end_time - this.owner.fight.start_time) / 1000;\r\n      const manaTeasPossible = (Math.ceil(fightLength / 90) || 1);\r\n      this.manatea.requiredPerTea = this.best.manaFrom / manaTeasPossible;\r\n    }\r\n  }\r\n\r\n  //anaylze current play style and see how much mana they would have gained from this talent\r\n  generateSotc() {\r\n    const sotcBlackOutKicks = this.abilityTracker.getAbility(SPELLS.BLACKOUT_KICK_TOTM.id).damageHits || 0;\r\n    const manaPercentFromSotc = sotcBlackOutKicks * SPELLS.SPIRIT_OF_THE_CRANE_BUFF.manaRet;\r\n    const rawManaFromSotc = manaPercentFromSotc * this.manaTracker.maxResource;\r\n    return rawManaFromSotc || 0;\r\n  }\r\n\r\n  //anaylze current play style and see how much mana they would have saved (so avarage )\r\n\r\n  //anaylze current play style and see how much mana they would have saved (so average mana per second / total mt time)\r\n  generateManaTea() {\r\n    const fightLength = (this.owner.fight.end_time - this.owner.fight.start_time) / 1000;\r\n    const manaTeasPossible = (Math.ceil(fightLength / 90) || 1);\r\n    const manaPerDuration = (this.totalManaSpent() / fightLength) * SPELLS.MANA_TEA_TALENT.duration / 1000;//duration of mana Tea\r\n    const manaPerTea = manaTeasPossible * manaPerDuration;\r\n    return manaPerTea || 0;\r\n  }\r\n\r\n  //assume that each env casted has a viv before it and that first viv is not effected\r\n  generateLifeCycles() {\r\n    const envCasts = this.abilityTracker.getAbility(SPELLS.ENVELOPING_MIST.id).casts || 0;\r\n    const vivCasts = this.abilityTracker.getAbility(SPELLS.VIVIFY.id).casts - 1;\r\n    const manaDiscountOnViv = Math.min(vivCasts, envCasts) * SPELLS.VIVIFY.manaCost * LIFECYCLES_MANA_PERC_REDUCTION;\r\n    const manaDiscountOnEnv = Math.min(vivCasts, envCasts) * SPELLS.ENVELOPING_MIST.manaCost * LIFECYCLES_MANA_PERC_REDUCTION;\r\n    return (manaDiscountOnEnv + manaDiscountOnViv) || 0;\r\n  }\r\n\r\n  totalManaSpent(): number {\r\n    let manaSpent = 0;\r\n    let lastMana = this.manaTracker.maxResource;\r\n    this.manaTracker.resourceUpdates.forEach(function(event) {\r\n      if (event.used !== 0) {\r\n        manaSpent += Math.abs(lastMana - event.used);\r\n      }\r\n      lastMana = event.current;\r\n    });\r\n    return manaSpent;\r\n  }\r\n\r\n  suggestions(when: When) {\r\n    when(this.suggestionThresholds).addSuggestion((suggest, actual, recommended) => suggest(\r\n      <>\r\n        With your current playstyle you are not using the most effective tier 45 talent. <SpellLink id={this.best.id} /> is better based off of how you played.\r\n      </>,\r\n    )\r\n      .icon(this.best.icon)\r\n      .actual(`${formatNumber(this.returnedFromSelected)}${i18n._(t('monk.mistweaver.suggestions.tier45Talent.efficiency')` mana returned through `)}${this.best.name}`)\r\n      .recommended(`${this.best.name} would have returned ${formatNumber(this.best.manaFrom)}`));\r\n  }\r\n\r\n  statistic() {\r\n\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(30)}\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.TALENTS}\r\n        dropdown={\r\n          <div className=\"pad\">\r\n            <div>\r\n              This is an infographic for tier 45 talents to see what is required to equal the best pick for how you played. This also attempts to calculate the other talents based on how you played for the difference row, for the equals row it shows the requirements in general, ignoring how you played.\r\n            </div>\r\n            <table className=\"table table-condensed\">\r\n              <thead>\r\n                <tr>\r\n                  <th />\r\n                  <th>LC</th>\r\n                  <th>SOTC</th>\r\n                  <th>MT</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                <tr>\r\n                  <td>Difference</td>\r\n                  <td>{formatNumber(this.best.manaFrom - this.lifecycles.manaFrom)}</td>\r\n                  <td>{formatNumber(this.best.manaFrom - this.sotc.manaFrom)}</td>\r\n                  <td>{formatNumber(this.best.manaFrom - this.manatea.manaFrom)}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td>Equal</td>\r\n                  <td>\r\n                    Viv:{this.lifecycles.requiredVivs}\r\n                    <br />\r\n                    Env:{this.lifecycles.requiredEnvs}\r\n                  </td>\r\n                  <td>Totm Stacks {this.sotc.requiredTps}</td>\r\n                  <td>Mana {formatNumber(this.manatea.requiredPerTea)} per tea</td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>}\r\n        tooltip={(\r\n          <>\r\n            <ul>\r\n              <li>LC = Life cycles</li>\r\n              <li>SOTC = Spirit of the Crane</li>\r\n              <li>MT = mana Tea</li>\r\n            </ul>\r\n          </>\r\n        )}\r\n      >\r\n        <BoringValueText\r\n          label={<><SpellIcon id={this.best.id} /> Tier 45 Comparison</>}\r\n        >\r\n          <>\r\n            {formatNumber(this.best.manaFrom)} Mana from {this.best.name}\r\n          </>\r\n        </BoringValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\ninterface BestTalent {\r\n  selected: boolean;\r\n  manaFrom: number;\r\n  icon: string;\r\n  name: string;\r\n  id: number;\r\n  best: boolean;\r\n}\r\n\r\nexport default Tier45Comparison;\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport SpellLink from 'common/SpellLink';\r\nimport ResourceLink from 'common/ResourceLink';\r\nimport RESOURCE_TYPES from 'game/RESOURCE_TYPES';\r\nimport { TooltipElement } from 'common/Tooltip';\r\nimport Checklist from 'parser/shared/modules/features/Checklist';\r\nimport Rule from 'parser/shared/modules/features/Checklist/Rule';\r\nimport Requirement from 'parser/shared/modules/features/Checklist/Requirement';\r\nimport PreparationRule from 'parser/shared/modules/features/Checklist/PreparationRule';\r\nimport GenericCastEfficiencyRequirement from 'parser/shared/modules/features/Checklist/GenericCastEfficiencyRequirement';\r\n\r\nconst MistweaverMonkChecklist = ({ combatant, castEfficiency, thresholds }: any) => {\r\n  const AbilityRequirement = (props: any) => (\r\n    <GenericCastEfficiencyRequirement\r\n      castEfficiency={castEfficiency.getCastEfficiencyForSpellId(props.spell)}\r\n      {...props}\r\n    />\r\n  );\r\n  AbilityRequirement.propTypes = {\r\n    spell: PropTypes.number.isRequired,\r\n  };\r\n\r\n  return (\r\n    <Checklist>\r\n      <Rule\r\n        name=\"Use core abilities as often as possible\"\r\n        description={(\r\n          <>\r\n            As a Mistweaver you only have a single rotational spell that should be cast on CD <SpellLink id={SPELLS.RENEWING_MIST.id} />. The other piece is ensuring you have enough <SpellLink id={SPELLS.RENEWING_MIST.id} />'s on the raid so that you maximize the cleave healing from <SpellLink id={SPELLS.VIVIFY.id} />.\r\n          </>\r\n        )}\r\n      >\r\n        <AbilityRequirement spell={SPELLS.RENEWING_MIST.id} />\r\n        <Requirement name={(<><SpellLink id={SPELLS.RENEWING_MIST.id} /> avg per Vivify cast</>)} thresholds={thresholds.vivify} />\r\n        {combatant.hasTalent(SPELLS.RISING_MIST_TALENT.id) && <AbilityRequirement spell={SPELLS.RISING_SUN_KICK.id} />}\r\n      </Rule>\r\n\r\n      <Rule\r\n        name=\"Use cooldowns effectively\"\r\n        description={(\r\n          <>\r\n            Your cooldowns are an important contributor to your healing throughput. Try to get in as many efficient casts as the fight allows.{' '}\r\n            <a href=\"https://www.peakofserenity.com/bfa/mistweaver/guide/\" target=\"_blank\" rel=\"noopener noreferrer\">More info.</a>\r\n          </>\r\n        )}\r\n      >\r\n        <AbilityRequirement spell={SPELLS.THUNDER_FOCUS_TEA.id} />\r\n        {combatant.hasTalent(SPELLS.MANA_TEA_TALENT.id) && <AbilityRequirement spell={SPELLS.MANA_TEA_TALENT.id} />}\r\n        {combatant.hasTalent(SPELLS.MANA_TEA_TALENT.id) && <Requirement name={(<><SpellLink id={SPELLS.RENEWING_MIST.id} /> active during <SpellLink id={SPELLS.MANA_TEA_TALENT.id} /></>)} thresholds={thresholds.renewingMistDuringManaTea} />}\r\n        {combatant.hasTalent(SPELLS.CHI_BURST_TALENT.id) && <AbilityRequirement spell={SPELLS.CHI_BURST_TALENT.id} />}\r\n        {combatant.hasTalent(SPELLS.CHI_WAVE_TALENT.id) && <AbilityRequirement spell={SPELLS.CHI_WAVE_TALENT.id} />}\r\n        <AbilityRequirement spell={SPELLS.REVIVAL.id} />\r\n        {!combatant.hasTalent(SPELLS.INVOKE_CHIJI_THE_RED_CRANE_TALENT.id) && <AbilityRequirement spell={SPELLS.INVOKE_YULON_THE_JADE_SERPENT.id} />}\r\n        {combatant.hasTalent(SPELLS.INVOKE_CHIJI_THE_RED_CRANE_TALENT.id) && <AbilityRequirement spell={SPELLS.INVOKE_CHIJI_THE_RED_CRANE_TALENT.id} />}\r\n        <AbilityRequirement spell={SPELLS.TOUCH_OF_DEATH.id} />\r\n        <Requirement name={(<><SpellLink id={SPELLS.ENVELOPING_BREATH.id} /> applied per <SpellLink id={SPELLS.ENVELOPING_MIST.id} /> cast</>)} thresholds={thresholds.envelopingBreath} />\r\n        {/* We can't detect race, so disable this when it has never been cast. */}\r\n        {castEfficiency.getCastEfficiencyForSpellId(SPELLS.ARCANE_TORRENT_MANA1.id) && (\r\n          <AbilityRequirement spell={SPELLS.ARCANE_TORRENT_MANA1.id} />\r\n        )}\r\n      </Rule>\r\n\r\n      <Rule\r\n        name=\"Position yourself well to maximize your most effective spells\"\r\n        description={(\r\n          <>\r\n            Effective use of <SpellLink id={SPELLS.ESSENCE_FONT.id} /> has a big impact on your healing. Ensure you stay in melee to maximize the number of targets that can be in range of both <SpellLink id={SPELLS.ESSENCE_FONT.id} /> and other spells such as <SpellLink id={SPELLS.REFRESHING_JADE_WIND_TALENT.id} />.\r\n          </>\r\n        )}\r\n      >\r\n        <Requirement\r\n          name={(<><SpellLink id={SPELLS.ESSENCE_FONT.id} /> targets hit</>)} thresholds={thresholds.essenceFont}\r\n        />\r\n        {combatant.hasTalent(SPELLS.REFRESHING_JADE_WIND_TALENT.id) &&\r\n        <Requirement name={(<><SpellLink id={SPELLS.REFRESHING_JADE_WIND_TALENT.id} /> % targets hit</>)} thresholds={thresholds.refreshingJadeWind} />}\r\n        {combatant.hasTalent(SPELLS.CHI_BURST_TALENT.id) &&\r\n        <Requirement name={(<><SpellLink id={SPELLS.CHI_BURST_TALENT.id} /> targets hit</>)} thresholds={thresholds.chiBurst} />}\r\n        <Requirement name={(<><SpellLink id={SPELLS.SPINNING_CRANE_KICK.id} /> casts hitting 2 or fewer targets</>)} thresholds={thresholds.spinningCraneKick} />\r\n      </Rule>\r\n\r\n      <Rule\r\n        name=\"Pick the right tools for the fight\"\r\n        description=\"The throughput gain of some talents might vary greatly. Consider switching to a more reliable alternative if something is underperforming regularly.\"\r\n      >\r\n        <Requirement\r\n          name={<>Correct Tier 45 Talent </>}\r\n          thresholds={thresholds.tier45Comparison}\r\n        />\r\n\r\n        {combatant.hasTalent(SPELLS.SPIRIT_OF_THE_CRANE_TALENT.id) &&\r\n        <Requirement name={(<><SpellLink id={SPELLS.SPIRIT_OF_THE_CRANE_TALENT.id} /> mana returned</>)} thresholds={thresholds.spiritOfTheCrane} />}\r\n\r\n        {combatant.hasTalent(SPELLS.MANA_TEA_TALENT.id) &&\r\n        <Requirement name={(<><SpellLink id={SPELLS.MANA_TEA_TALENT.id} /> mana saved</>)} thresholds={thresholds.manaTea} />}\r\n        {combatant.hasTalent(SPELLS.MANA_TEA_TALENT.id) &&\r\n        <Requirement name={(<><SpellLink id={SPELLS.MANA_TEA_TALENT.id} /> % overhealing</>)} thresholds={thresholds.manaTeaOverhealing} />}\r\n\r\n        {combatant.hasTalent(SPELLS.LIFECYCLES_TALENT.id) &&\r\n        <Requirement name={(<><SpellLink id={SPELLS.LIFECYCLES_TALENT.id} /> mana saved</>)} thresholds={thresholds.lifecycles} />}\r\n        {combatant.hasTalent(SPELLS.SUMMON_JADE_SERPENT_STATUE_TALENT.id) &&\r\n        <Requirement name={(<><SpellLink id={SPELLS.SUMMON_JADE_SERPENT_STATUE_TALENT.id} /> Cast Uptime</>)} thresholds={thresholds.jadeSerpentStatue} />}\r\n      </Rule>\r\n\r\n      <Rule\r\n        name=\"Use your procs and short CDs\"\r\n        description=\"Make sure to use your procs and spells at the correct time.\"\r\n      >\r\n        <Requirement name={(<><SpellLink id={SPELLS.THUNDER_FOCUS_TEA.id} /> incorrect casts</>)} thresholds={thresholds.thunderFocusTea} />\r\n        <Requirement name={(<><SpellLink id={SPELLS.ESSENCE_FONT.id} /> HOTS Used per Cast</>)} thresholds={thresholds.essenceFontMastery} />\r\n      </Rule>\r\n\r\n      <Rule\r\n        name=\"Try to avoid being inactive for a large portion of the fight\"\r\n        description={(\r\n          <>\r\n            While it's suboptimal to always be casting as a healer you should still try to always be doing something during the entire fight and high downtime is inexcusable. You can reduce your downtime by reducing the delay between casting spells, anticipating movement, moving during the GCD, and <TooltipElement content=\"While helping with damage would be optimal, it's much less important as a healer than any of the other suggestions on this checklist. You should ignore this suggestion while you are having difficulties with anything else.\">when you're not healing try to contribute some damage*</TooltipElement>.\r\n          </>\r\n        )}\r\n      >\r\n        <Requirement name=\"Non healing time\" thresholds={thresholds.nonHealingTimeSuggestionThresholds} />\r\n        <Requirement name=\"Downtime\" thresholds={thresholds.downtimeSuggestionThresholds} />\r\n        <Requirement name={(<>Effective <SpellLink id={SPELLS.SOOTHING_MIST.id} /> Casts</>)} thresholds={thresholds.soothingMist} />\r\n\r\n      </Rule>\r\n\r\n      <Rule\r\n        name=\"Use your defensive cooldowns effectively\"\r\n        description=\"Make sure you use your personal and defensive cooldowns at appropriate times throughout the fight. While it may not make sense to use these abilities on cooldown, saving them for large damage events is ideal.\"\r\n      >\r\n        <AbilityRequirement spell={SPELLS.FORTIFYING_BREW.id} />\r\n        <AbilityRequirement spell={SPELLS.LIFE_COCOON.id} />\r\n        {combatant.hasTalent(SPELLS.DIFFUSE_MAGIC_TALENT.id) && <AbilityRequirement spell={SPELLS.DIFFUSE_MAGIC_TALENT.id} />}\r\n        {combatant.hasTalent(SPELLS.DAMPEN_HARM_TALENT.id) && <AbilityRequirement spell={SPELLS.DAMPEN_HARM_TALENT.id} />}\r\n        {combatant.hasTalent(SPELLS.HEALING_ELIXIR_TALENT.id) && <AbilityRequirement spell={SPELLS.HEALING_ELIXIR_TALENT.id} />}\r\n      </Rule>\r\n      <Rule\r\n        name={<>Use all of your <ResourceLink id={RESOURCE_TYPES.MANA.id} /> effectively</>}\r\n        description=\"If you have a large amount of mana left at the end of the fight that's mana you could have turned into healing. Try to use all your mana during a fight. A good rule of thumb is to try to match your mana level with the boss's health.\"\r\n      >\r\n        <Requirement name=\"Mana left\" thresholds={thresholds.manaLeft} />\r\n      </Rule>\r\n      <PreparationRule thresholds={thresholds} />\r\n    </Checklist>\r\n  );\r\n};\r\n\r\nMistweaverMonkChecklist.propTypes = {\r\n  castEfficiency: PropTypes.object.isRequired,\r\n  combatant: PropTypes.shape({\r\n    hasTalent: PropTypes.func.isRequired,\r\n  }).isRequired,\r\n  thresholds: PropTypes.object.isRequired,\r\n};\r\n\r\nexport default MistweaverMonkChecklist;\r\n","import React from 'react';\r\nimport CoreChanneling from 'parser/shared/modules/Channeling';\r\n\r\nimport Analyzer, { Options, SELECTED_PLAYER } from 'parser/core/Analyzer';\r\nimport Events, { CastEvent, FightEndEvent, HealEvent, RemoveBuffEvent } from 'parser/core/Events';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport SpellLink from 'common/SpellLink';\r\nimport SUGGESTION_IMPORTANCE from 'parser/core/ISSUE_IMPORTANCE';\r\nimport StatTracker from 'parser/shared/modules/StatTracker';\r\nimport { formatPercentage } from 'common/format';\r\n\r\nimport { i18n } from '@lingui/core';\r\nimport { t } from '@lingui/macro';\r\nimport { ThresholdStyle, When } from 'parser/core/ParseResults';\r\n\r\nclass SoothingMist extends Analyzer {\r\n  static dependencies = {\r\n    channeling: CoreChanneling,\r\n    statTracker: StatTracker,\r\n  };\r\n  soomTicks: number = 0;\r\n  gustProc: number = 0;\r\n  gustsHealing: number = 0;\r\n  lastSoomTickTimestamp: number = 0;\r\n  startStamp: number = 0;\r\n  endStamp: number = 0;\r\n  soomInProgress: boolean = false;\r\n  castsInSoom: number = 0;\r\n  badSooms: number = 0;\r\n  totalSoomCasts = 0;\r\n  assumedGCD: number = 0;\r\n  startGCD: number = 0;\r\n  protected channeling!: CoreChanneling;\r\n  protected statTracker!: StatTracker;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.assumedGCD = 1500 * .95;\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.SOOTHING_MIST), this.castSoothingMist);\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell([SPELLS.VIVIFY, SPELLS.ENVELOPING_MIST]), this.castDuringSoothingMist);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.SOOTHING_MIST), this.handleSoothingMist);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.GUSTS_OF_MISTS), this.masterySoothingMist);\r\n    this.addEventListener(Events.removebuff.by(SELECTED_PLAYER).spell(SPELLS.SOOTHING_MIST), this.removeBuffSoothingMist);\r\n    this.addEventListener(Events.fightend, this.end);\r\n  }\r\n\r\n  get soomTicksPerDuration() {\r\n    const soomTicks = (this.soomTicks * 2 / this.owner.fightDuration * 1000) || 0;\r\n    return soomTicks >= 1.5;\r\n  }\r\n\r\n  get suggestionThresholds() {\r\n    return {\r\n      actual: this.soomTicksPerDuration,\r\n      isEqual: true,\r\n      style: ThresholdStyle.BOOLEAN,\r\n    };\r\n  }\r\n\r\n  get soomThresholds() {\r\n    return (this.totalSoomCasts - this.badSooms) / this.totalSoomCasts;\r\n  }\r\n\r\n  get suggestionThresholdsCasting() {\r\n    return {\r\n      actual: this.soomThresholds,\r\n      isLessThan: {\r\n        minor: 1,\r\n        average: .95,\r\n        major: .9,\r\n      },\r\n      style: ThresholdStyle.PERCENTAGE,\r\n    };\r\n  }\r\n\r\n  handleSoothingMist(event: HealEvent) {\r\n    this.soomTicks += 1;\r\n    this.lastSoomTickTimestamp = event.timestamp;\r\n  }\r\n\r\n  masterySoothingMist(event: HealEvent) {\r\n    if (this.lastSoomTickTimestamp === event.timestamp && this.gustProc < Math.ceil(this.soomTicks / 8)) {\r\n      this.gustProc += 1;\r\n      this.gustsHealing += (event.amount || 0) + (event.absorbed || 0);\r\n    }\r\n  }\r\n\r\n  castDuringSoothingMist(event: CastEvent) {\r\n    if (this.soomInProgress) {\r\n      this.castsInSoom += 1;\r\n    }\r\n  }\r\n\r\n  castSoothingMist(event: CastEvent) {\r\n    if (this.soomInProgress) {\r\n      //if they refresh soom for some stupid reason\r\n      this.endStamp = event.timestamp;\r\n      this.checkChannelTiming();\r\n      this.castsInSoom = 0;\r\n    }\r\n\r\n    this.startStamp = event.timestamp;\r\n    this.soomInProgress = true;\r\n    const gcd = 1000 / (1 + this.statTracker.hastePercentage(this.statTracker.currentHasteRating));\r\n    this.startGCD = Math.max(750, gcd) * .95;\r\n  }\r\n\r\n  removeBuffSoothingMist(event: RemoveBuffEvent) {\r\n    if (!this.soomInProgress) {\r\n      return;\r\n    }\r\n\r\n    this.endStamp = event.timestamp;\r\n    this.soomInProgress = false;\r\n    this.checkChannelTiming();\r\n    this.castsInSoom = 0;\r\n  }\r\n\r\n  checkChannelTiming() {\r\n    this.totalSoomCasts += 1;\r\n    let duration = this.endStamp - this.startStamp;\r\n\r\n    if (duration < this.startGCD) {\r\n      return;\r\n    }\r\n\r\n    duration -= this.startGCD;\r\n\r\n    this.castsInSoom -= (duration / this.assumedGCD);\r\n\r\n    if (this.castsInSoom < 0) {\r\n      this.badSooms += 1;\r\n    }\r\n  }\r\n\r\n  end(event: FightEndEvent) {\r\n    if (this.soomInProgress) {\r\n      this.endStamp = this.owner.fightDuration;\r\n      this.checkChannelTiming();\r\n    }\r\n  }\r\n\r\n  suggestions(when: When) {\r\n    when(this.suggestionThresholds).addSuggestion((suggest) => suggest(\r\n      <>\r\n        You are allowing <SpellLink id={SPELLS.SOOTHING_MIST.id} /> to channel for an extended period of time. <SpellLink id={SPELLS.SOOTHING_MIST.id} /> does little healing, so your time is better spent DPS'ing through the use of <SpellLink id={SPELLS.TIGER_PALM.id} /> and <SpellLink id={SPELLS.BLACKOUT_KICK.id} />.\r\n      </>,\r\n    )\r\n      .icon(SPELLS.SOOTHING_MIST.icon)\r\n      .staticImportance(SUGGESTION_IMPORTANCE.MAJOR));\r\n\r\n    when(this.suggestionThresholdsCasting).addSuggestion((suggest, actual, recommended) => suggest(\r\n      <>\r\n        You were channeling <SpellLink id={SPELLS.SOOTHING_MIST.id} /> without casting spells during it. Replace this channel time with damage abilities like <SpellLink id={SPELLS.RISING_SUN_KICK.id} />.\r\n      </>,\r\n    )\r\n      .icon(SPELLS.SOOTHING_MIST.icon)\r\n      .actual(`${formatPercentage(this.badSooms / this.totalSoomCasts)}${i18n._(t('monk.mistweaver.suggestions.soothingMist.channelingWithoutCastingSpells')`% of Soothing Mist casts with max spells casted`)}`)\r\n      .recommended(`${recommended} is recommended`));\r\n  }\r\n}\r\n\r\nexport default SoothingMist;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport { formatNumber } from 'common/format';\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport BoringSpellValueText from 'interface/statistics/components/BoringSpellValueText';\r\nimport SpellLink from 'common/SpellLink';\r\nimport Analyzer, { Options, SELECTED_PLAYER, SELECTED_PLAYER_PET } from 'parser/core/Analyzer';\r\nimport Events, { ApplyBuffEvent, CastEvent, DeathEvent, HealEvent } from 'parser/core/Events';\r\nimport calculateEffectiveHealing from 'parser/core/calculateEffectiveHealing';\r\nimport Combatants from 'parser/shared/modules/Combatants';\r\nimport { ThresholdStyle, When } from 'parser/core/ParseResults';\r\nimport { i18n } from '@lingui/core';\r\nimport { t } from '@lingui/macro';\r\n\r\nconst ENVELOPING_BREATH_INCREASE = .1;\r\nconst debug: boolean = false;\r\n\r\nclass EnvelopingBreath extends Analyzer {\r\n  static dependencies = {\r\n    combatants: Combatants,\r\n  };\r\n  envsDuringCelestial: number = 0;\r\n  envBreathsApplied: number = 0;\r\n  chijiActive: boolean = false;\r\n  envBIncrease: number = 0;\r\n  protected combatants!: Combatants;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER), this.handleEnvelopingBreathHeal);\r\n    this.addEventListener(Events.applybuff.by(SELECTED_PLAYER).spell(SPELLS.ENVELOPING_BREATH), this.handleEnvelopingBreathCount);\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.ENVELOPING_MIST), this.handleEnvelopingMist);\r\n    if (this.selectedCombatant.hasTalent(SPELLS.INVOKE_CHIJI_THE_RED_CRANE_TALENT)) {\r\n      this.addEventListener(Events.death.to(SELECTED_PLAYER_PET), this.handleChijiDeath);\r\n      this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.INVOKE_CHIJI_THE_RED_CRANE_TALENT), this.handleChijiSummon);\r\n    }\r\n  }\r\n\r\n  get averageEnvBPerEnv() {\r\n    return this.envBreathsApplied / this.envsDuringCelestial || 0;\r\n  }\r\n\r\n  get suggestionThresholds() {\r\n    return {\r\n      actual: this.averageEnvBPerEnv,\r\n      isLessThan: {\r\n        minor: 5,\r\n        average: 4,\r\n        major: 3,\r\n      },\r\n      style: ThresholdStyle.NUMBER,\r\n    };\r\n  }\r\n\r\n  handleEnvelopingBreathHeal(event: HealEvent) {\r\n    const targetId = event.targetID;\r\n    const sourceId = event.sourceID;\r\n\r\n    if (this.combatants.players[targetId]) {\r\n      if (this.combatants.players[targetId].hasBuff(SPELLS.ENVELOPING_BREATH.id, event.timestamp, 0, 0, sourceId)) {\r\n        this.envBIncrease += calculateEffectiveHealing(event, ENVELOPING_BREATH_INCREASE);\r\n      }\r\n    }\r\n  }\r\n\r\n  handleEnvelopingMist(event: CastEvent) {\r\n    if (this.chijiActive || this.selectedCombatant.hasBuff(SPELLS.INVOKE_YULON_THE_JADE_SERPENT.id)) {\r\n      this.envsDuringCelestial += 1;\r\n    }\r\n  }\r\n\r\n  handleEnvelopingBreathCount(event: ApplyBuffEvent) {\r\n    this.envBreathsApplied += 1;\r\n  }\r\n\r\n  handleChijiSummon(event: CastEvent) {\r\n    this.chijiActive = true;\r\n    debug && console.log('Chiji summoned');\r\n  }\r\n\r\n  handleChijiDeath(event: DeathEvent) {\r\n    this.chijiActive = false;\r\n    debug && console.log('Chiji Died');\r\n  }\r\n\r\n  suggestions(when: When) {\r\n    when(this.suggestionThresholds).addSuggestion((suggest, actual, recommended) => suggest(\r\n      <>\r\n        You are not utilizing <SpellLink id={SPELLS.ENVELOPING_BREATH.id} /> effectively. Make sure you are choosing good targets for your <SpellLink id={SPELLS.ENVELOPING_MIST.id} /> during your Celestial cooldowns to apply the maximum number of <SpellLink id={SPELLS.ENVELOPING_BREATH.id} /> possible.\r\n      </>,\r\n    )\r\n      .icon(SPELLS.ENVELOPING_BREATH.icon)\r\n      .actual(`${this.averageEnvBPerEnv.toFixed(2)}${i18n._(t('monk.mistweaver.suggestions.envelopingBreath.averageEnvBPerEnv')` Enveloping Breaths per Enveloping Mist during Celestial`)}`)\r\n      .recommended(`${recommended} Enveloping Breaths are recommended per cast`));\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.GENERAL}\r\n        tooltip={<>This is the effective healing contributed by the Enveloping Breath buff.</>}\r\n      >\r\n        <BoringSpellValueText spell={SPELLS.ENVELOPING_BREATH}>\r\n          <>\r\n            {formatNumber(this.envBIncrease)} <small>healing contributed by the buff</small>\r\n          </>\r\n        </BoringSpellValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n\r\n}\r\n\r\nexport default EnvelopingBreath;\r\n","import React from 'react';\r\n\r\nimport BaseChecklist from 'parser/shared/modules/features/Checklist/Module';\r\nimport CastEfficiency from 'parser/shared/modules/CastEfficiency';\r\nimport Combatants from 'parser/shared/modules/Combatants';\r\nimport ManaValues from 'parser/shared/modules/ManaValues';\r\nimport PreparationRuleAnalyzer from 'parser/shared/modules/features/Checklist/PreparationRuleAnalyzer';\r\n\r\nimport AlwaysBeCasting from '../AlwaysBeCasting';\r\nimport EssenceFont from '../../spells/EssenceFont';\r\nimport RefreshingJadeWind from '../../talents/RefreshingJadeWind';\r\nimport ChiBurst from '../../talents/ChiBurst';\r\nimport SpiritOfTheCrane from '../../talents/SpiritOfTheCrane';\r\nimport ManaTea from '../../talents/ManaTea';\r\nimport Lifecycles from '../../talents/Lifecycles';\r\nimport ThunderFocusTea from '../../spells/ThunderFocusTea';\r\nimport EssenceFontMastery from '../EssenceFontMastery';\r\nimport RenewingMistDuringManaTea from '../../talents/RenewingMistDuringManaTea';\r\nimport SpinningCraneKick from '../../spells/SpinningCraneKick';\r\nimport Vivify from '../../spells/Vivify';\r\nimport JadeSerpentStatue from '../../talents/JadeSerpentStatue';\r\nimport Tier45Comparison from '../../talents/Tier45Comparison';\r\nimport Component from './Component';\r\nimport SoothingMist from '../../spells/SoothingMist';\r\nimport EnvelopingBreath from '../../spells/EnvelopingBreath';\r\n\r\nclass Checklist extends BaseChecklist {\r\n  static dependencies = {\r\n    combatants: Combatants,\r\n    castEfficiency: CastEfficiency,\r\n    manaValues: ManaValues,\r\n    preparationRuleAnalyzer: PreparationRuleAnalyzer,\r\n    alwaysBeCasting: AlwaysBeCasting,\r\n    essenceFont: EssenceFont,\r\n    refreshingJadeWind: RefreshingJadeWind,\r\n    chiBurst: ChiBurst,\r\n    spiritOfTheCrane: SpiritOfTheCrane,\r\n    manaTea: ManaTea,\r\n    lifecycles: Lifecycles,\r\n    thunderFocusTea: ThunderFocusTea,\r\n    essenceFontMastery: EssenceFontMastery,\r\n    renewingMistDuringManaTea: RenewingMistDuringManaTea,\r\n    spinningCraneKick: SpinningCraneKick,\r\n    vivify: Vivify,\r\n    jadeSerpentStatue: JadeSerpentStatue,\r\n    soothingMist: SoothingMist,\r\n    tier45Comparison: Tier45Comparison,\r\n    envelopingBreath: EnvelopingBreath,\r\n  };\r\n\r\n  protected combatants!: Combatants;\r\n  protected castEfficiency!: CastEfficiency;\r\n  protected manaValues!: ManaValues;\r\n  protected preparationRuleAnalyzer!: PreparationRuleAnalyzer;\r\n  protected alwaysBeCasting!: AlwaysBeCasting;\r\n  protected essenceFont!: EssenceFont;\r\n  protected refreshingJadeWind!: RefreshingJadeWind;\r\n  protected chiBurst!: ChiBurst;\r\n  protected spiritOfTheCrane!: SpiritOfTheCrane;\r\n  protected manaTea!: ManaTea;\r\n  protected lifecycles!: Lifecycles;\r\n  protected thunderFocusTea!: ThunderFocusTea;\r\n  protected essenceFontMastery!: EssenceFontMastery;\r\n  protected renewingMistDuringManaTea!: RenewingMistDuringManaTea;\r\n  protected spinningCraneKick!: SpinningCraneKick;\r\n  protected vivify!: Vivify;\r\n  protected jadeSerpentStatue!: JadeSerpentStatue;\r\n  protected soothingMist!: SoothingMist;\r\n  protected tier45Comparison!: Tier45Comparison;\r\n  protected envelopingBreath!: EnvelopingBreath;\r\n\r\n  render() {\r\n    return (\r\n      <Component\r\n        combatant={this.combatants.selected}\r\n        castEfficiency={this.castEfficiency}\r\n        thresholds={{\r\n          ...this.preparationRuleAnalyzer.thresholds,\r\n\r\n          nonHealingTimeSuggestionThresholds: this.alwaysBeCasting.nonHealingTimeSuggestionThresholds,\r\n          downtimeSuggestionThresholds: this.alwaysBeCasting.downtimeSuggestionThresholds,\r\n          manaLeft: this.manaValues.suggestionThresholds,\r\n          essenceFont: this.essenceFont.suggestionThresholds,\r\n          envelopingBreath: this.envelopingBreath.suggestionThresholds,\r\n          refreshingJadeWind: this.refreshingJadeWind.suggestionThresholds,\r\n          chiBurst: this.chiBurst.suggestionThresholds,\r\n          spiritOfTheCrane: this.spiritOfTheCrane.suggestionThresholds,\r\n          manaTea: this.manaTea.suggestionThresholds,\r\n          manaTeaOverhealing: this.manaTea.suggestionThresholdsOverhealing,\r\n          spinningCraneKick: this.spinningCraneKick.suggestionThresholds,\r\n          lifecycles: this.lifecycles.suggestionThresholds,\r\n          thunderFocusTea: this.thunderFocusTea.suggestionThresholds,\r\n          essenceFontMastery: this.essenceFontMastery.suggestionThresholds,\r\n          renewingMistDuringManaTea: this.renewingMistDuringManaTea.suggestionThresholds,\r\n          vivify: this.vivify.suggestionThresholds,\r\n          jadeSerpentStatue: this.jadeSerpentStatue.suggestionThresholds,\r\n          soothingMist: this.soothingMist.suggestionThresholdsCasting,\r\n          tier45Comparison: this.tier45Comparison.suggestionThresholds,\r\n        }}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default Checklist;\r\n","import SPELLS from 'common/SPELLS';\r\n\r\n/*\r\n * Fields:\r\n * int: spell scales with Intellect\r\n * crit: spell scales with (is able to or procced from) Critical Strike\r\n * hasteHpm: spell does more healing due to Haste, e.g. HoTs that gain more ticks\r\n * hasteHpct: spell can be cast more frequently due to Haste, basically any spell except for non haste scaling CDs\r\n * mastery: spell is boosted by Mastery\r\n * masteryStack: spell's HoT counts as a Mastery Stack\r\n * vers: spell scales with Versatility\r\n * multiplier: spell scales with whatever procs it, should be ignored for purpose of weights and for 'total healing' number\r\n * ignored: spell should be ignored for purpose of stat weights\r\n */\r\n\r\n// This only works with actual healing events; casts are not recognized.\r\n\r\nexport default {\r\n  [SPELLS.ENVELOPING_MIST.id]: {\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: true,\r\n    hasteHpct: true,\r\n    mastery: false, //Procs Gusts\r\n    vers: true,\r\n  },\r\n  [SPELLS.ENVELOPING_MIST_TFT.id]: { // Instant Heal when using TFT-> Enveloping Mist\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: false,\r\n    hasteHpct: false,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.ESSENCE_FONT.id]: {\r\n    int: true,\r\n    crit: true,\r\n    hasteHpct: false,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.ESSENCE_FONT_BUFF.id]: {\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: true,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.RENEWING_MIST_HEAL.id]: {\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: true,\r\n    hasteHpct: false,\r\n    mastery: false, // Procs Gusts\r\n    vers: true,\r\n  },\r\n  [SPELLS.VIVIFY.id]: {\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: false,\r\n    hasteHpct: true,\r\n    mastery: false, // Procs Gusts\r\n    vers: true,\r\n  },\r\n  [SPELLS.CHI_BURST_HEAL.id]: {\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: false,\r\n    hasteHpct: false,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.GUSTS_OF_MISTS.id]: {\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: false,\r\n    hasteHpct: false,\r\n    mastery: true, // Procs Gusts\r\n    vers: false,\r\n  },\r\n  [SPELLS.SOOTHING_MIST.id]: {\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: false,\r\n    hasteHpct: true,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.REFRESHING_JADE_WIND_HEAL.id]: {\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: false,\r\n    hasteHpct: true,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.REVIVAL.id]: {\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: false,\r\n    hasteHpct: false,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.LIFE_COCOON.id]: {//life cocoon scales off of hp\r\n    int: false,\r\n    crit: false,\r\n    hasteHpm: false,\r\n    hasteHpct: false,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.RISING_MIST_HEAL.id]: { // t100 trait\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: false,\r\n    hasteHpct: true,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.HEALING_ELIXIR_TALENT.id]: { // t75 trait\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: false,\r\n    hasteHpct: false,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.SOOTHING_MIST_STATUE.id]: {\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: false,\r\n    hasteHpct: true,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.ANCIENT_TEACHINGS_OF_THE_MONASTERY_HEAL.id]: {\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: false,\r\n    hasteHpct: true,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.GUST_OF_MISTS_CHIJI.id]: { // Chi-ji's gusts\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: false,\r\n    hasteHpct: true,\r\n    mastery: true,\r\n    vers: true,\r\n  },\r\n  [SPELLS.SOOTHING_BREATH.id]: { //Yu'lon's healing\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: false,\r\n    hasteHpct: true,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.ENVELOPING_BREATH.id]: {\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: true,\r\n    hasteHpct: false,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.EXPEL_HARM.id]: {\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: false,\r\n    hasteHpct: false,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.EXPEL_HARM_TARGET_HEAL.id]: {\r\n    int: true,\r\n    crit: true,\r\n    hastHpm: false,\r\n    hasteHpct: false,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.TEAR_OF_MORNING_HEAL.id]: {\r\n    int: false,\r\n    crit: false,\r\n    hasteHpm: false,\r\n    hasteHpct: false,\r\n    mastery: false,\r\n    vers: false,\r\n  },\r\n  [SPELLS.FALLEN_ORDER_ENVELOPING_MIST.id]: {\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: true,\r\n    hasteHpct: true,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.FALLEN_ORDER_SOOTHING_MIST.id]: {\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: false,\r\n    hasteHpct: true,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.FAELINE_STOMP_HEAL.id]: {\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: false,\r\n    hasteHpct: false,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.FAELINE_STOMP_ESSENCE_FONT.id]: {\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: true,\r\n    hasteHpct: false,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.WEAPONS_OF_ORDER_BUFF_AND_HEAL.id]: {\r\n    int: true,\r\n    crit: true,\r\n    hasteHpm: false,\r\n    hasteHpct: false,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.BONEDUST_BREW_HEAL.id]: {\r\n    int: true,\r\n    crit: false,\r\n    hasteHpm: false,\r\n    hasteHpct: false,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n  [SPELLS.BONEDUST_BREW_GUST_OF_MIST.id]: {\r\n    int: true,\r\n    crit: false,\r\n    hasteHpm: false,\r\n    hasteHpct: false,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n};\r\n","import { Trans } from '@lingui/macro';\r\nimport React from 'react';\r\n\r\nimport BaseHealerStatValues from 'parser/shared/modules/features/BaseHealerStatValues';\r\nimport STAT from 'parser/shared/modules/features/STAT';\r\nimport StatTracker from 'parser/shared/modules/StatTracker';\r\nimport CritEffectBonus from 'parser/shared/modules/helpers/CritEffectBonus';\r\n\r\nimport { HealEvent } from 'parser/core/Events';\r\nimport HealingValue from 'parser/shared/modules/HealingValue';\r\n\r\nimport SPELL_INFO from './StatValuesSpellInfo';\r\n\r\n/**\r\n * Mistweaver Monk Stat Values\r\n */\r\nclass StatValues extends BaseHealerStatValues {\r\n  static dependencies = {\r\n    statTracker: StatTracker,\r\n    critEffectBonus: CritEffectBonus,\r\n  };\r\n  spellInfo: {} = SPELL_INFO;\r\n  qeLive: boolean = true;\r\n  protected statTracker!: StatTracker;\r\n  protected critEffectBonus!: CritEffectBonus;\r\n\r\n  _mastery(event: HealEvent, healVal: HealingValue): number {\r\n    if (healVal.overheal) {\r\n      // If a spell overheals, it could not have healed for more. Seeing as Mastery is a secondary heal, that is proc'ed by our single target heals, any overheal can be ignored.\r\n      return 0;\r\n    }\r\n\r\n    // assuming gust heal vs. mastery % are linear and start at 0 ( gust_heal = K * mast_pct )\r\n    // h2 / h1 = mast_pct(rat) / mast_pct(rat-1)\r\n    // solving that for h2 - h1 brings...\r\n    return healVal.effective * (1 - (this.statTracker.masteryPercentage(this.statTracker.currentMasteryRating - 1, true) / this.statTracker.masteryPercentage(this.statTracker.currentMasteryRating, true)));\r\n  }\r\n\r\n  _prepareResults() {\r\n    return [\r\n      STAT.INTELLECT,\r\n      STAT.CRITICAL_STRIKE,\r\n      {\r\n        stat: STAT.HASTE_HPCT,\r\n        tooltip: (\r\n          <Trans id=\"monk.mistweaver.modules.features.statValues.hpct\">\r\n            HPCT stands for \"Healing per Cast Time\". This is the max value that Haste would be worth if you would cast everything you are already casting (that scales with Haste) faster. Mana and overhealing are not accounted for in any way.<br /><br />\r\n\r\n            The real value of Haste (HPCT) will be between 0 and the shown value. It depends on various things, such as if you have the mana left to spend, if the gained casts would overheal, and how well you are at casting spells end-to-end. If you are going OOM before the end of the fight you might instead want to drop some Haste or cast fewer bad heals. If you had mana left-over, Haste could help you convert that into healing. If your Haste usage is optimal Haste will then be worth the shown max value.<br /><br />\r\n\r\n            Haste can also help you safe lives during intense damage phases. If you notice you're GCD capped when people are dying, Haste might help you land more heals. This may contribute more towards actually getting the kill.\r\n          </Trans>\r\n        ),\r\n      },\r\n      STAT.HASTE_HPM,\r\n      STAT.MASTERY,\r\n      STAT.VERSATILITY,\r\n      STAT.VERSATILITY_DR,\r\n      STAT.LEECH,\r\n    ];\r\n  }\r\n}\r\n\r\nexport default StatValues;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport SpellIcon from 'common/SpellIcon';\r\n\r\nimport Analyzer from 'parser/core/Analyzer';\r\nimport AbilityTracker from 'parser/shared/modules/AbilityTracker';\r\n\r\nimport StatisticBox, { STATISTIC_ORDER } from 'interface/others/StatisticBox';\r\n\r\n/* Add in Statistic box to show Vivfy to Enveloping Mist Cast ratio.\r\n * TODO:\r\n * Add in suggestion thresholds and checklist item on ratio. Need additional log data to implement.\r\n*/\r\n\r\nclass CastRatio extends Analyzer {\r\n  static dependencies = {\r\n    abilityTracker: AbilityTracker,\r\n  };\r\n\r\n  protected abilityTracker!: AbilityTracker;\r\n\r\n  statistic() {\r\n    const getAbility = (spellId: number) => this.abilityTracker.getAbility(spellId);\r\n\r\n    const evmCasts = getAbility(SPELLS.ENVELOPING_MIST.id).casts || 0;\r\n    const vivCasts = getAbility(SPELLS.VIVIFY.id).casts || 0;\r\n\r\n    return (\r\n      <StatisticBox\r\n        position={STATISTIC_ORDER.OPTIONAL(10)}\r\n        icon={<><SpellIcon id={SPELLS.ENVELOPING_MIST.id} /> : <SpellIcon id={SPELLS.VIVIFY.id} /> </>}\r\n        value={`${evmCasts} : ${vivCasts}`}\r\n        label=\"Enveloping Mist to Vivify Casts\"\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default CastRatio;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport { formatNumber } from 'common/format';\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport BoringSpellValueText from 'interface/statistics/components/BoringSpellValueText';\r\n\r\nimport Analyzer, { Options, SELECTED_PLAYER } from 'parser/core/Analyzer';\r\nimport Events, { CastEvent, HealEvent } from 'parser/core/Events';\r\nimport calculateEffectiveHealing from 'parser/core/calculateEffectiveHealing';\r\nimport Combatants from 'parser/shared/modules/Combatants';\r\n\r\nconst UNAFFECTED_SPELLS: number[] = [\r\n  SPELLS.ENVELOPING_MIST.id,\r\n];\r\n\r\nclass EnvelopingMists extends Analyzer {\r\n  static dependencies = {\r\n    combatants: Combatants,\r\n  };\r\n  healingIncrease: number = 0;\r\n  evmHealingIncrease: number = 0;\r\n  gustsHealing: number = 0;\r\n  lastCastTarget: number = -1;\r\n  numberToCount: number = 0;\r\n  gustProc: number = 0;\r\n  protected combatants!: Combatants;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.evmHealingIncrease = this.selectedCombatant.hasTalent(SPELLS.MIST_WRAP_TALENT.id) ? .4 : .3;\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.ENVELOPING_MIST), this.castEnvelopingMist);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER), this.handleEnvelopingMist);\r\n\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.GUSTS_OF_MISTS), this.masteryEnvelopingMist);\r\n  }\r\n\r\n  castEnvelopingMist(event: CastEvent) {\r\n    this.numberToCount += 1;\r\n    this.lastCastTarget = event.targetID || -1;\r\n  }\r\n\r\n  masteryEnvelopingMist(event: HealEvent) {\r\n    const targetId = event.targetID;\r\n\r\n    if ((this.lastCastTarget === targetId) && this.numberToCount > 0) {\r\n      this.gustProc += 1;\r\n      this.gustsHealing += (event.amount || 0) + (event.absorbed || 0);\r\n      this.numberToCount -= 1;\r\n    }\r\n  }\r\n\r\n  handleEnvelopingMist(event: HealEvent) {\r\n    const targetId = event.targetID;\r\n    const spellId = event.ability.guid;\r\n    const sourceId = event.sourceID;\r\n\r\n    if (UNAFFECTED_SPELLS.includes(spellId)) {\r\n      return;\r\n    }\r\n\r\n    if (this.combatants.players[targetId]) {\r\n      if (this.combatants.players[targetId].hasBuff(SPELLS.ENVELOPING_MIST.id, event.timestamp, 0, 0, sourceId)) {\r\n        this.healingIncrease += calculateEffectiveHealing(event, this.evmHealingIncrease);\r\n      }\r\n    }\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.GENERAL}\r\n        tooltip={<>This is the effective healing contributed by the Enveloping Mist buff.</>}\r\n      >\r\n        <BoringSpellValueText spell={SPELLS.ENVELOPING_MIST}>\r\n          <>\r\n            {formatNumber(this.healingIncrease)} <small>healing contributed by the buff</small>\r\n          </>\r\n        </BoringSpellValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default EnvelopingMists;\r\n","import SPELLS from 'common/SPELLS';\r\nimport Analyzer, { Options, SELECTED_PLAYER } from 'parser/core/Analyzer';\r\nimport Events, { CastEvent, HealEvent } from 'parser/core/Events';\r\n\r\nclass RenewingMist extends Analyzer {\r\n  totalHealing: number = 0;\r\n  totalOverhealing: number = 0;\r\n  totalAbsorbs: number = 0;\r\n  gustsHealing: number = 0;\r\n  lastCastTarget: number = 0;\r\n  healingHits: number = 0;\r\n  numberToCount: number = 0;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.RENEWING_MIST), this.castRenewingMist);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.GUSTS_OF_MISTS), this.handleGustsOfMists);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.RENEWING_MIST_HEAL), this.handleRenewingMist);\r\n  }\r\n\r\n  castRenewingMist(event: CastEvent) {\r\n    this.numberToCount += 1;\r\n    this.lastCastTarget = event.targetID || 0;\r\n  }\r\n\r\n  handleGustsOfMists(event: HealEvent) {\r\n    if ((this.lastCastTarget === event.targetID) && this.numberToCount > 0) {\r\n      this.gustsHealing += (event.amount || 0) + (event.absorbed || 0);\r\n      this.numberToCount -= 1;\r\n    }\r\n  }\r\n\r\n  handleRenewingMist(event: HealEvent) {\r\n    this.totalHealing += event.amount || 0;\r\n    this.totalOverhealing += event.overheal || 0;\r\n    this.totalAbsorbs += event.absorbed || 0;\r\n    this.healingHits += 1;\r\n  }\r\n}\r\n\r\nexport default RenewingMist;\r\n","import SPELLS from 'common/SPELLS';\r\nimport Analyzer, { Options, SELECTED_PLAYER } from 'parser/core/Analyzer';\r\nimport Events, { HealEvent } from 'parser/core/Events';\r\n\r\nclass ExpelHarm extends Analyzer {\r\n\r\n  selfHealing: number = 0;\r\n  selfOverheal: number = 0;\r\n  targetHealing: number = 0;\r\n  targetOverheal: number = 0;\r\n  gustsHealing: number = 0;\r\n  lastCastTarget: number = -1;\r\n  sourceTarget: number = -1;\r\n  numberToCount: number = 0;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.EXPEL_HARM), this.handleExpelHarm);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.EXPEL_HARM_TARGET_HEAL), this.handleTargetExpelHarm);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.GUSTS_OF_MISTS), this.handleMastery);\r\n  }\r\n\r\n  handleExpelHarm(event: HealEvent) {\r\n    this.selfHealing += (event.amount || 0) + (event.absorbed || 0);\r\n    this.selfOverheal += (event.overheal || 0);\r\n    this.numberToCount += 1;\r\n    this.sourceTarget = event.targetID;\r\n  }\r\n\r\n  handleTargetExpelHarm(event: HealEvent) {\r\n    this.targetHealing += (event.amount || 0) + (event.absorbed || 0);\r\n    this.targetOverheal += (event.overheal || 0);\r\n    this.numberToCount += 1;\r\n    this.lastCastTarget = event.targetID;\r\n  }\r\n\r\n  handleMastery(event: HealEvent) {\r\n    if ((event.targetID === this.lastCastTarget || event.targetID === this.sourceTarget) && this.numberToCount > 0) {\r\n      this.gustsHealing += (event.amount || 0) + (event.absorbed || 0);\r\n      this.numberToCount -= 1;\r\n    }\r\n  }\r\n}\r\n\r\nexport default ExpelHarm;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\n\r\nimport SpellLink from 'common/SpellLink';\r\nimport { formatThousands } from 'common/format';\r\n\r\nimport Analyzer from 'parser/core/Analyzer';\r\nimport EssenceFontMastery from 'parser/monk/mistweaver/modules/features/EssenceFontMastery';\r\nimport EnvelopingMists from 'parser/monk/mistweaver/modules/spells/EnvelopingMists';\r\nimport SoothingMist from 'parser/monk/mistweaver/modules/spells/SoothingMist';\r\nimport RenewingMist from 'parser/monk/mistweaver/modules/spells/RenewingMist';\r\nimport Vivify from 'parser/monk/mistweaver/modules/spells/Vivify';\r\n\r\nimport { STATISTIC_ORDER } from 'interface/others/StatisticsListBox';\r\nimport DonutChart from 'interface/statistics/components/DonutChart';\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport ExpelHarm from 'parser/monk/mistweaver/modules/spells/ExpelHarm';\r\n\r\nclass MasteryStats extends Analyzer {\r\n  static dependencies = {\r\n    essenceFontMastery: EssenceFontMastery,\r\n    envelopingMists: EnvelopingMists,\r\n    soothingMist: SoothingMist,\r\n    renewingMist: RenewingMist,\r\n    vivify: Vivify,\r\n    expelHarm: ExpelHarm,\r\n  };\r\n\r\n  protected essenceFontMastery!: EssenceFontMastery;\r\n  protected envelopingMists!: EnvelopingMists;\r\n  protected soothingMist!: SoothingMist;\r\n  protected renewingMist!: RenewingMist;\r\n  protected vivify!: Vivify;\r\n  protected expelHarm!: ExpelHarm;\r\n\r\n  get totalMasteryHealing() {\r\n    return (this.vivify.gustsHealing || 0)\r\n      + (this.renewingMist.gustsHealing || 0)\r\n      + (this.envelopingMists.gustsHealing || 0)\r\n      + (this.soothingMist.gustsHealing || 0)\r\n      + (this.essenceFontMastery.healing || 0)\r\n      + (this.expelHarm.gustsHealing || 0);\r\n  }\r\n\r\n  renderMasterySourceChart() {\r\n    const items = [\r\n      {\r\n        color: '#00b159',\r\n        label: 'Vivify',\r\n        spellId: SPELLS.VIVIFY.id,\r\n        value: this.vivify.gustsHealing,\r\n        valueTooltip: formatThousands(this.vivify.gustsHealing),\r\n      },\r\n      {\r\n        color: '#db00db',\r\n        label: 'Renewing Mist',\r\n        spellId: SPELLS.RENEWING_MIST.id,\r\n        value: this.renewingMist.gustsHealing,\r\n        valueTooltip: formatThousands(this.renewingMist.gustsHealing),\r\n      },\r\n      {\r\n        color: '#f37735',\r\n        label: 'Enveloping Mists',\r\n        spellId: SPELLS.ENVELOPING_MIST.id,\r\n        value: this.envelopingMists.gustsHealing,\r\n        valueTooltip: formatThousands(this.envelopingMists.gustsHealing),\r\n      },\r\n      {\r\n        color: '#ffc425',\r\n        label: 'Soothing Mist',\r\n        spellId: SPELLS.SOOTHING_MIST.id,\r\n        value: this.soothingMist.gustsHealing,\r\n        valueTooltip: formatThousands(this.soothingMist.gustsHealing),\r\n      },\r\n      {\r\n        color: '#00bbcc',\r\n        label: 'Essence font',\r\n        spellId: SPELLS.ESSENCE_FONT.id,\r\n        value: this.essenceFontMastery.healing,\r\n        valueTooltip: formatThousands(this.essenceFontMastery.healing),\r\n      },\r\n      {\r\n        color: '#03fcad',\r\n        label: 'Expel Harm',\r\n        spellId: SPELLS.EXPEL_HARM.id,\r\n        value: this.expelHarm.gustsHealing,\r\n        valueTooltip: formatThousands(this.expelHarm.gustsHealing),\r\n      },\r\n    ];\r\n\r\n    return (\r\n      <DonutChart\r\n        items={items}\r\n      />\r\n    );\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.CORE(20)}\r\n        size=\"flexible\"\r\n      >\r\n        <div className=\"pad\">\r\n          <label><SpellLink id={SPELLS.GUSTS_OF_MISTS.id}>Gusts of Mists</SpellLink> breakdown</label>\r\n          {this.renderMasterySourceChart()}\r\n        </div>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default MasteryStats;\r\n","import SPELLS from 'common/SPELLS';\r\nimport CoreBuffs from 'parser/core/modules/Buffs';\r\nimport BLOODLUST_BUFFS from 'game/BLOODLUST_BUFFS';\r\n\r\nclass Buffs extends CoreBuffs {\r\n  buffs() {\r\n    const combatant = this.selectedCombatant;\r\n\r\n    // This should include ALL buffs that can be applied by your spec.\r\n    // This data can be used by various kinds of modules to improve their results, and modules added in the future may rely on buffs that aren't used today.\r\n    return [\r\n      {\r\n        spellId: SPELLS.THUNDER_FOCUS_TEA.id,\r\n      },\r\n      {\r\n        spellId: [SPELLS.LIFECYCLES_VIVIFY_BUFF.id, SPELLS.LIFECYCLES_ENVELOPING_MIST_BUFF.id],\r\n        enabled: combatant.hasTalent(SPELLS.LIFECYCLES_TALENT),\r\n      },\r\n      {\r\n        spellId: SPELLS.TEACHINGS_OF_THE_MONASTERY.id,\r\n      },\r\n      {\r\n        spellId: SPELLS.REFRESHING_JADE_WIND_TALENT.id,\r\n        enabled: combatant.hasTalent(SPELLS.REFRESHING_JADE_WIND_TALENT),\r\n        timelineHighlight: true,\r\n      },\r\n      {\r\n        spellId: SPELLS.INVOKE_CHIJI_THE_RED_CRANE_BUFF.id,\r\n        enabled: combatant.hasTalent(SPELLS.INVOKE_CHIJI_THE_RED_CRANE_TALENT),\r\n      },\r\n      // Throughput Cooldown\r\n      {\r\n        spellId: SPELLS.MANA_TEA_TALENT.id,\r\n        enabled: combatant.hasTalent(SPELLS.MANA_TEA_TALENT),\r\n        timelineHighlight: true,\r\n      },\r\n\r\n      // Utility\r\n      {\r\n        spellId: SPELLS.TIGERS_LUST_TALENT.id,\r\n        enabled: combatant.hasTalent(SPELLS.TIGERS_LUST_TALENT),\r\n      },\r\n      {\r\n        spellId: SPELLS.DIFFUSE_MAGIC_TALENT.id,\r\n        enabled: combatant.hasTalent(SPELLS.DIFFUSE_MAGIC_TALENT),\r\n      },\r\n      {\r\n        spellId: SPELLS.DAMPEN_HARM_TALENT.id,\r\n        enabled: combatant.hasTalent(SPELLS.DAMPEN_HARM_TALENT),\r\n      },\r\n      {\r\n        spellId: SPELLS.FORTIFYING_BREW.id,\r\n      },\r\n      {\r\n        spellId: Object.keys(BLOODLUST_BUFFS).map(item => Number(item)),\r\n        timelineHighlight: true,\r\n      },\r\n    ];\r\n  }\r\n}\r\n\r\nexport default Buffs;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\n\r\nimport Analyzer, { Options } from 'parser/core/Analyzer';\r\nimport Events, { HealEvent } from 'parser/core/Events';\r\nimport calculateEffectiveHealing from 'parser/core/calculateEffectiveHealing';\r\nimport Combatants from 'parser/shared/modules/Combatants';\r\n\r\nimport BoringSpellValueText from 'interface/statistics/components/BoringSpellValueText';\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport ItemHealingDone from 'interface/ItemHealingDone';\r\n\r\nimport { LIFE_COCOON_HEALING_BOOST } from '../../constants';\r\n\r\nclass LifeCocoon extends Analyzer {\r\n  static dependencies = {\r\n    combatants: Combatants,\r\n  };\r\n  healing: number = 0;\r\n  protected combatants!: Combatants;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.addEventListener(Events.heal, this.cocoonBuff);\r\n  }\r\n\r\n  cocoonBuff(event: HealEvent) {\r\n    //Life Cocoon works on any HoT that has this flag checked even if they don't come from the mistweaver themselves\r\n    if (!event.tick) {\r\n      return;\r\n    }\r\n\r\n    const target = this.combatants.players[event.targetID];\r\n\r\n    if (!target) {\r\n      return;\r\n    }\r\n\r\n    if (target.hasBuff(SPELLS.LIFE_COCOON.id, event.timestamp, 0, 0)) {\r\n      this.healing += calculateEffectiveHealing(event, LIFE_COCOON_HEALING_BOOST);\r\n    }\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(20)}\r\n        size=\"flexible\"\r\n        tooltip={<>Life Cocoon boosts HoTs from other players as wells as your own.</>}\r\n      >\r\n        <BoringSpellValueText spell={SPELLS.LIFE_COCOON}>\r\n          <ItemHealingDone amount={this.healing} /><br />\r\n        </BoringSpellValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n\r\n}\r\n\r\nexport default LifeCocoon;\r\n","import React from 'react';\r\nimport SPELLS from 'common/SPELLS';\r\nimport Analyzer, { Options, SELECTED_PLAYER, SELECTED_PLAYER_PET } from 'parser/core/Analyzer';\r\nimport Events, { HealEvent } from 'parser/core/Events';\r\nimport BoringSpellValueText from 'interface/statistics/components/BoringSpellValueText';\r\nimport { formatNumber } from 'common/format';\r\nimport ItemHealingDone from 'interface/ItemHealingDone';\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\n\r\nclass InvokeYulon extends Analyzer {\r\n  soothHealing: number = 0;\r\n  envelopHealing: number = 0;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.active = !this.selectedCombatant.hasTalent(SPELLS.INVOKE_CHIJI_THE_RED_CRANE_TALENT.id);\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.ENVELOPING_BREATH), this.handleEnvelopingBreath);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER_PET).spell(SPELLS.SOOTHING_BREATH), this.handleSoothingBreath);\r\n  }\r\n\r\n  handleEnvelopingBreath(event: HealEvent) {\r\n    this.envelopHealing += (event.amount || 0) + (event.absorbed || 0);\r\n  }\r\n\r\n  handleSoothingBreath(event: HealEvent) {\r\n    this.soothHealing += (event.amount || 0) + (event.absorbed || 0);\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(50)}\r\n        size=\"flexible\"\r\n        tooltip={\r\n          <>\r\n            Healing Breakdown:\r\n            <ul>\r\n              <li>{formatNumber(this.soothHealing)} healing from Soothing Breath.</li>\r\n              <li>{formatNumber(this.envelopHealing)} healing from Enveloping Breath.</li>\r\n            </ul>\r\n          </>\r\n        }\r\n      >\r\n        <BoringSpellValueText spell={SPELLS.INVOKE_YULON_THE_JADE_SERPENT}>\r\n          <ItemHealingDone amount={this.soothHealing + this.envelopHealing} /><br />\r\n        </BoringSpellValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default InvokeYulon;\r\n","import React from 'react';\r\nimport { Trans } from '@lingui/macro';\r\nimport SPELLS from 'common/SPELLS';\r\nimport BoringValueText from 'interface/statistics/components/BoringValueText';\r\nimport Analyzer, { Options, SELECTED_PLAYER, SELECTED_PLAYER_PET } from 'parser/core/Analyzer';\r\nimport { formatNumber } from 'common/format';\r\nimport Events, { CastEvent, DamageEvent, DeathEvent, EndChannelEvent, GlobalCooldownEvent, HealEvent } from 'parser/core/Events';\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport ItemHealingDone from 'interface/ItemHealingDone';\r\nimport SpellLink from 'common/SpellLink';\r\n\r\n/**\r\n * Blackout Kick, Totm BoKs, Rising Sun Kick and Spinning Crane Kick generate stacks of Invoke Chi-Ji, the Red Crane, which reduce the cast time and mana\r\n * cost of Enveloping Mist by 33% per stack, up to 3 stacks.\r\n * These abilities also heal 2 nearby allies for a Gust of Mist heal.\r\n * Casting Enveloping Mist while Chiji is active applies Enveloping Breath on up to 6 nearby allies within 10 yards.\r\n */\r\nconst MAX_STACKS = 3;\r\n\r\nclass InvokeChiJi extends Analyzer {\r\n  chijiActive: boolean = false;\r\n  //healing breakdown vars\r\n  gustHealing: number = 0;\r\n  envelopHealing: number = 0;\r\n  //stack breakdown vars\r\n  chijiStackCount: number = 0;\r\n  castsBelowMaxStacks: number = 0;\r\n  wastedStacks: number = 0;\r\n  freeCasts: number = 0;\r\n  //missed GCDs vars\r\n  missedGlobals: number = 0;\r\n  chijiStart: number = 0;\r\n  chijiGlobals: number = 0;\r\n  chijiUses: number = 0;\r\n  lastGlobal: number = 0;\r\n  efGcd: number = 0;\r\n  checkForSckDamage: number = -1;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.active = this.selectedCombatant.hasTalent(SPELLS.INVOKE_CHIJI_THE_RED_CRANE_TALENT.id);\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.GUST_OF_MISTS_CHIJI), this.handleGust);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.ENVELOPING_BREATH), this.handleEnvelopingBreath);\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.ENVELOPING_MIST), this.handleEnvelopCast);\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.INVOKE_CHIJI_THE_RED_CRANE_TALENT), this.handleChijiStart);\r\n    this.addEventListener(Events.death.to(SELECTED_PLAYER), this.handleChijiDeath);\r\n    this.addEventListener(Events.death.to(SELECTED_PLAYER_PET), this.handleChijiDeath);\r\n    this.addEventListener(Events.damage.by(SELECTED_PLAYER).spell([SPELLS.BLACKOUT_KICK, SPELLS.RISING_SUN_KICK_SECOND, SPELLS.BLACKOUT_KICK_TOTM, SPELLS.SPINNING_CRANE_KICK_DAMAGE]), this.handleStackGenerator);\r\n    //need a different eventlistener beacause chiji currently only applies 1 stack per cast of sck, not on each dmg event\r\n    this.addEventListener(Events.GlobalCooldown.by(SELECTED_PLAYER).spell(SPELLS.SPINNING_CRANE_KICK), this.handleSpinningCraneKick);\r\n    this.addEventListener(Events.GlobalCooldown.by(SELECTED_PLAYER), this.handleGlobal);\r\n    this.addEventListener(Events.EndChannel.by(SELECTED_PLAYER).spell(SPELLS.ESSENCE_FONT), this.handleEssenceFontEnd);\r\n  }\r\n\r\n  //missed gcd mangement\r\n  handleChijiStart(event: CastEvent) {\r\n    this.chijiActive = true;\r\n    this.chijiStart = this.lastGlobal = event.timestamp;\r\n    this.chijiGlobals += 1;\r\n    this.chijiUses += 1;\r\n  }\r\n\r\n  handleChijiDeath(event: DeathEvent) {\r\n    this.chijiActive = false;\r\n  }\r\n\r\n  handleGlobal(event: GlobalCooldownEvent) {\r\n    if (this.chijiActive) {\r\n      this.chijiGlobals += 1;\r\n      //if timebetween globals is longer than the gcd add the difference to the missed gcd tally\r\n      //we only care about accounting for channels of essence font during WoO, other than that it should be the gcd during chiji\r\n      if (event.ability.guid === SPELLS.ESSENCE_FONT.id && this.selectedCombatant.hasBuff(SPELLS.WEAPONS_OF_ORDER_BUFF_AND_HEAL.id)) {\r\n        this.efGcd = event.duration;\r\n      } else if ((event.timestamp - this.lastGlobal) > event.duration) {\r\n        this.missedGlobals += (event.timestamp - this.lastGlobal - event.duration) / event.duration;\r\n      }\r\n      this.lastGlobal = event.timestamp;\r\n    }\r\n  }\r\n\r\n  handleEssenceFontEnd(event: EndChannelEvent) {\r\n    if (this.chijiActive && this.selectedCombatant.hasBuff(SPELLS.WEAPONS_OF_ORDER_BUFF_AND_HEAL.id)) {\r\n      if (event.duration > this.efGcd) {\r\n        this.lastGlobal = event.timestamp - this.efGcd;\r\n      } else {\r\n        this.lastGlobal = event.start + this.efGcd;\r\n      }\r\n    }\r\n  }\r\n\r\n  //healing management\r\n  handleGust(event: HealEvent) {\r\n    this.gustHealing += (event.amount || 0) + (event.absorbed || 0);\r\n  }\r\n\r\n  handleEnvelopingBreath(event: HealEvent) {\r\n    this.envelopHealing += (event.amount || 0) + (event.absorbed || 0);\r\n  }\r\n\r\n  //stackbreakown management\r\n  handleStackGenerator(event: DamageEvent) {\r\n    if (this.chijiActive) {\r\n      if (event.ability.guid === SPELLS.SPINNING_CRANE_KICK_DAMAGE.id) {\r\n        if (this.checkForSckDamage > event.timestamp) {\r\n          this.stackCount();\r\n          this.checkForSckDamage = -1;\r\n        }\r\n      } else {\r\n        this.stackCount();\r\n      }\r\n    }\r\n  }\r\n\r\n  handleSpinningCraneKick(event: GlobalCooldownEvent) {\r\n    if (this.chijiActive) {\r\n      this.checkForSckDamage = event.duration + this.lastGlobal;\r\n    }\r\n  }\r\n\r\n  handleEnvelopCast(event: CastEvent) {\r\n    //in some cases the last envelop is cast after chiji has expired but the buff can still be consumed\r\n    if (this.chijiActive || this.selectedCombatant.hasBuff(SPELLS.INVOKE_CHIJI_THE_RED_CRANE_BUFF.id)) {\r\n      if (this.chijiStackCount === MAX_STACKS) {\r\n        this.freeCasts += 1;\r\n      } else if (this.chijiStackCount < MAX_STACKS) {\r\n        this.castsBelowMaxStacks += 1;\r\n      }\r\n      this.chijiStackCount = 0;\r\n    }\r\n  }\r\n\r\n  stackCount() {\r\n    if (this.chijiStackCount === MAX_STACKS) {\r\n      this.wastedStacks += 1;\r\n    } else {\r\n      this.chijiStackCount += 1;\r\n    }\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(50)}\r\n        category={STATISTIC_CATEGORY.TALENTS}\r\n        size=\"flexible\"\r\n        tooltip={\r\n          <Trans id=\"monk.mistweaver.modules.talents.invokeChiJi.breakdown\">\r\n            Healing Breakdown:\r\n            <ul>\r\n              <li>{formatNumber(this.gustHealing)} healing from Chi-Ji Gust of Mist.</li>\r\n              <li>{formatNumber(this.envelopHealing)} healing from Enveloping Breath.</li>\r\n            </ul>\r\n            Stack Breakdown:\r\n            <ul>\r\n              <li>{formatNumber(this.freeCasts)} free Enveloping Mist cast(s).</li>\r\n              <li>{formatNumber(this.castsBelowMaxStacks)} Enveloping Mist cast(s) below max ({MAX_STACKS}) Chi-Ji stacks.</li>\r\n              <li>{formatNumber(this.wastedStacks)} stack(s) wasted from overcapping Chi-Ji stacks.</li>\r\n            </ul>\r\n            Activity:\r\n            <ul>\r\n              <li>{(this.chijiGlobals / this.chijiUses).toFixed(2)} average gcds inside Chi-Ji window</li>\r\n            </ul>\r\n          </Trans>\r\n        }\r\n      >\r\n        <BoringValueText\r\n          label={<><SpellLink id={SPELLS.INVOKE_CHIJI_THE_RED_CRANE_TALENT.id} /></>}\r\n        >\r\n          <>\r\n            <ItemHealingDone amount={this.gustHealing + this.envelopHealing} /><br />\r\n            <Trans id=\"monk.mistweaver.modules.talents.invokeChiJi.missedGCDs\">\r\n              {formatNumber(this.missedGlobals)} missed GCDs\r\n            </Trans>\r\n          </>\r\n        </BoringValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default InvokeChiJi;\r\n","import React from 'react';\r\nimport { formatNumber, formatPercentage } from 'common/format';\r\nimport SPELLS from 'common/SPELLS';\r\nimport Analyzer, { SELECTED_PLAYER } from 'parser/core/Analyzer';\r\nimport calculateEffectiveHealing from 'parser/core/calculateEffectiveHealing';\r\nimport Events from 'parser/core/Events';\r\nimport AbilityTracker from 'parser/shared/modules/AbilityTracker';\r\nimport SpellUsable from 'parser/shared/modules/SpellUsable';\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport BoringValueText from 'interface/statistics/components/BoringValueText';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport SpellIcon from 'common/SpellIcon';\r\n\r\nimport HotTrackerMW from '../core/HotTrackerMW';\r\n\r\nconst debug = false;\r\n\r\nconst RISING_MIST_EXTENSION = 4000;\r\n\r\nconst UNAFFECTED_SPELLS = [\r\n  SPELLS.ENVELOPING_MIST.id,\r\n];\r\n\r\nclass RisingMist extends Analyzer {\r\n  get averageExtension() {\r\n    return this.risingMistCount === 0 ? 0 : (this.risingMists.reduce((acc, risingMist) => acc + risingMist.duration, 0) / this.risingMistCount) / 1000;\r\n  }\r\n\r\n  get hotHealing() {\r\n    const array = this.hotTracker.hotHistory;\r\n    let value = 0;\r\n    for (let i = 0; i < array.length; i += 1) {\r\n      value += (array[i].healingAfterOriginalEnd || 0);\r\n    }\r\n    return value;\r\n  }\r\n\r\n  get directHealing() {\r\n    return this.abilityTracker.getAbility(SPELLS.RISING_MIST_HEAL.id).healingEffective;\r\n  }\r\n\r\n  get totalHealing() {\r\n    return this.hotHealing + this.directHealing + this.extraMasteryhealing + this.extraVivHealing + this.extraEnvBonusHealing;\r\n  }\r\n\r\n  get averageHealing() {\r\n    return this.risingMistCount === 0 ? 0 : this.totalHealing / this.risingMistCount;\r\n  }\r\n\r\n  get averageTargetsPerRM() {\r\n    return this.targetCount / this.risingMistCount || 0;\r\n  }\r\n\r\n  get calculateVivOverHealing() {\r\n    return formatPercentage(this.extraVivOverhealing / (this.extraVivHealing + this.extraVivOverhealing));\r\n  }\r\n\r\n  get calculateMasteryOverHealing() {\r\n    return formatPercentage(this.extraMasteryOverhealing / (this.extraMasteryhealing + this.extraMasteryOverhealing));\r\n  }\r\n\r\n  get calculateEFOverHealing() {\r\n    return formatPercentage(this.extraEFOverhealing / (this.extraEFhealing + this.extraEFOverhealing));\r\n  }\r\n\r\n  static dependencies = {\r\n    hotTracker: HotTrackerMW,\r\n    abilityTracker: AbilityTracker,\r\n    spellUsable: SpellUsable,\r\n  };\r\n  risingMistCount = 0;\r\n  risingMists = [];\r\n  efsExtended = 0;\r\n  remCount = 0;\r\n  efCount = 0;\r\n  evmCount = 0;\r\n  targetCount = 0;\r\n  trackUplift = false;\r\n  extraVivCleaves = 0;\r\n  extraVivHealing = 0;\r\n  extraVivOverhealing = 0;\r\n  extraVivAbsorbed = 0;\r\n  extraEnvHits = 0;\r\n  extraEnvBonusHealing = 0;\r\n  extraMasteryHits = 0;\r\n  extraMasteryhealing = 0;\r\n  extraMasteryOverhealing = 0;\r\n  extraMasteryAbsorbed = 0;\r\n  masteryTickTock = false;\r\n  extraEFhealing = 0;\r\n  extraEFOverhealing = 0;\r\n  extraEFAbsorbed = 0;\r\n\r\n  constructor(...options) {\r\n    super(...options);\r\n    this.active = this.selectedCombatant.hasTalent(SPELLS.RISING_MIST_TALENT.id);\r\n    this.evmHealingIncrease = this.selectedCombatant.hasTalent(SPELLS.MIST_WRAP_TALENT.id) ? .4 : .3;\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.RISING_SUN_KICK), this.extendHots);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.VIVIFY), this.handleVivify);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER), this.calculateEvn);//gotta just look at all heals tbh\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.GUSTS_OF_MISTS), this.handleMastery);\r\n  }\r\n\r\n  handleMastery(event) {\r\n    const targetId = event.targetID;\r\n    if (!this.hotTracker.hots[targetId] || !this.hotTracker.hots[targetId][SPELLS.ESSENCE_FONT_BUFF.id]) {\r\n      return;\r\n    }\r\n\r\n    const object = this.hotTracker.hots[targetId][SPELLS.ESSENCE_FONT_BUFF.id];\r\n\r\n    if (object.originalEnd < event.timestamp) {\r\n      if (!this.masteryTickTock) {\r\n        this.extraMasteryHits += 1;\r\n        this.extraMasteryhealing += event.amount || 0;\r\n        this.extraMasteryOverhealing += event.overheal || 0;\r\n        this.extraMasteryAbsorbed += event.absorbed || 0;\r\n      }\r\n      this.masteryTickTock = !this.masteryTickTock;\r\n    }\r\n  }\r\n\r\n  calculateEvn(event) {\r\n    const targetId = event.targetID;\r\n    const spellId = event.ability.guid;\r\n    if (!this.hotTracker.hots[targetId] || !this.hotTracker.hots[targetId][SPELLS.ENVELOPING_MIST.id]) {\r\n      return;\r\n    }\r\n    const object = this.hotTracker.hots[targetId][SPELLS.ENVELOPING_MIST.id];\r\n\r\n    if (UNAFFECTED_SPELLS.includes(spellId)) {\r\n      return;\r\n    }\r\n\r\n    if (object.originalEnd < event.timestamp) {\r\n      this.extraEnvHits += 1;\r\n      this.extraEnvBonusHealing += calculateEffectiveHealing(event, this.evmHealingIncrease);\r\n    }\r\n\r\n  }\r\n\r\n  handleVivify(event) {\r\n    const targetId = event.targetID;\r\n    if (!this.hotTracker.hots[targetId] || !this.hotTracker.hots[targetId][SPELLS.RENEWING_MIST_HEAL.id]) {\r\n      return;\r\n    }\r\n    const hot = this.hotTracker.hots[targetId][SPELLS.RENEWING_MIST_HEAL.id];\r\n    if (hot.originalEnd < event.timestamp && event.timestamp < hot.end) {\r\n      this.extraVivCleaves += 1;\r\n      this.extraVivHealing += event.amount || 0;\r\n      this.extraVivOverhealing += event.overheal || 0;\r\n      this.extraVivAbsorbed += event.absorbed || 0;\r\n    }\r\n  }\r\n\r\n  extendHots(event) {\r\n    const spellId = event.ability.guid;\r\n    if (SPELLS.RISING_SUN_KICK.id !== spellId) {\r\n      return;\r\n    }\r\n\r\n    this.risingMistCount += 1;\r\n    debug && console.log(`risingMist cast #: ${this.risingMistCount}`);\r\n\r\n    const newRisingMist = {\r\n      name: `RisingMist #${this.risingMistCount}`,\r\n      healing: 0,\r\n      procs: 0,\r\n      duration: 0,\r\n    };\r\n    this.risingMists.push(newRisingMist);\r\n\r\n    let foundEf = false;\r\n    let foundTarget = false;\r\n\r\n    Object.keys(this.hotTracker.hots).forEach(playerId => {\r\n      Object.keys(this.hotTracker.hots[playerId]).forEach(spellIdString => {\r\n        const spellId = Number(spellIdString);\r\n\r\n        const attribution = newRisingMist;\r\n        this.hotTracker.addExtension(attribution, RISING_MIST_EXTENSION, playerId, spellId, event.timestamp);\r\n\r\n        if (spellId === SPELLS.ESSENCE_FONT_BUFF.id) {\r\n          foundEf = true;\r\n          foundTarget = true;\r\n          this.efCount += 1;\r\n        } else if (spellId === SPELLS.RENEWING_MIST_HEAL.id) {\r\n          foundTarget = true;\r\n          this.remCount += 1;\r\n        } else if (spellId === SPELLS.ENVELOPING_MIST.id) {\r\n          foundTarget = true;\r\n          this.evmCount += 1;\r\n        }\r\n      });\r\n    });\r\n\r\n    if (foundEf) {\r\n      this.efsExtended += 1;\r\n    }\r\n    if (foundTarget) {\r\n      this.targetCount += 1;\r\n    }\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(10)}\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.TALENTS}\r\n        tooltip={(\r\n          <>\r\n            Your {this.risingMistCount} Rising Sun Kick casts contributed the following healing:\r\n            <ul>\r\n              <li>HoT Extension Healing: {formatNumber(this.hotHealing)}</li>\r\n              <li>Rising Mist Direct Healing: {formatNumber(this.directHealing)}</li>\r\n              <li>Average HoT Extension Seconds per cast: {this.averageExtension.toFixed(2)}</li>\r\n              <ul>\r\n                <li>Essense Font HoTs Extended: {this.efCount}</li>\r\n                <li>Renewing Mist HoTs Extended: {this.remCount}</li>\r\n                <li>Enveloping Mist HoTs Extended: {this.evmCount}</li>\r\n              </ul>\r\n              Vivify\r\n              <ul>\r\n                <li>Extra Cleaves: {this.extraVivCleaves}</li>\r\n                <li>Extra Healing: {formatNumber(this.extraVivHealing)} ({this.calculateVivOverHealing}% Overhealing)</li>\r\n              </ul>\r\n              Enveloping Mist\r\n              <ul>\r\n                <li>Extra Hits: {this.extraEnvHits}</li>\r\n                <li>Extra Healing: {formatNumber(this.extraEnvBonusHealing)}</li>\r\n              </ul>\r\n              Mastery\r\n              <ul>\r\n                <li>Extra Hits: {this.extraMasteryHits}</li>\r\n                <li>Extra Healing: {formatNumber(this.extraMasteryhealing)} ({this.calculateMasteryOverHealing}% Overhealing)</li>\r\n              </ul>\r\n            </ul>\r\n          </>\r\n        )}\r\n      >\r\n        <BoringValueText\r\n          label={<><SpellIcon id={SPELLS.RISING_MIST_TALENT.id} /> Healing Contributed</>}\r\n        >\r\n          <>\r\n            {formatPercentage(this.owner.getPercentageOfTotalHealingDone(this.totalHealing))}% total healing\r\n          </>\r\n        </BoringValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default RisingMist;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport SpellIcon from 'common/SpellIcon';\r\n\r\nimport Analyzer, { Options, SELECTED_PLAYER } from 'parser/core/Analyzer';\r\n\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport BoringValueText from 'interface/statistics/components/BoringValueText';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport Events, { CastEvent } from 'parser/core/Events';\r\n\r\n/*\r\n * Add in Statistic box to show average time between RSK casts when Rising Mist is talented.\r\n */\r\nclass TimeBetweenRSKs extends Analyzer {\r\n\r\n  totalRSKCasts: number = 0;\r\n  firstRSKTimestamp: number = 0;\r\n  lastRSKTimestamp: number = 0;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.active = this.selectedCombatant.hasTalent(SPELLS.RISING_MIST_TALENT.id);\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.RISING_SUN_KICK), this.onRSK);\r\n  }\r\n\r\n  get rskWindow() {\r\n    return this.lastRSKTimestamp - this.firstRSKTimestamp;\r\n  }\r\n\r\n  get averageTimeBetweenRSKSeconds() {\r\n    if (this.totalRSKCasts === 0) {\r\n      return 'Rising Sun Kick was not cast';\r\n    } else if (this.totalRSKCasts === 1) {\r\n      return 'Rising Sun Kick was only cast once';\r\n    } else {\r\n      return ((this.rskWindow / 1000) / (this.totalRSKCasts - 1)).toFixed(2) + `s`;\r\n    }\r\n  }\r\n\r\n  onRSK(event: CastEvent) {\r\n    if (this.totalRSKCasts === 0) {\r\n      this.firstRSKTimestamp = event.timestamp;\r\n    } else {\r\n      this.lastRSKTimestamp = event.timestamp;\r\n    }\r\n    this.totalRSKCasts += 1;\r\n  }\r\n\r\n  statistic() {\r\n\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(13)}\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.TALENTS}\r\n      >\r\n        <BoringValueText label={<><SpellIcon id={SPELLS.RISING_SUN_KICK.id} /> Average Time Between Rising Sun Kick casts</>}>\r\n          <>\r\n            {this.averageTimeBetweenRSKSeconds} <small>Average Time Between</small>\r\n          </>\r\n        </BoringValueText>\r\n      </Statistic>\r\n\r\n    );\r\n  }\r\n}\r\n\r\nexport default TimeBetweenRSKs;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport { formatNumber, formatPercentage } from 'common/format';\r\nimport Combatants from 'parser/shared/modules/Combatants';\r\n\r\nimport Analyzer, { Options, SELECTED_PLAYER } from 'parser/core/Analyzer';\r\nimport Events, { ApplyBuffEvent, CastEvent, HealEvent, RemoveBuffEvent } from 'parser/core/Events';\r\n\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport BoringValueText from 'interface/statistics/components/BoringValueText';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport SpellIcon from 'common/SpellIcon';\r\n\r\nconst BASE_HOT_TIME = 8000;//ef's hot base time\r\nconst BASE_BOLTS = 17;//18 base but we start counting at 0 so 18th on bolt count = 19th bolt\r\n\r\n/**\r\n * Upwelling is a talent that increases essence font's hot by 4 seconds and for every second off cooldown up to 18 seconds it provides an extra bolt for the next ef cast\r\n * NOTE the buff this provides for extra bolts is invisible so we get to do some ugly coding\r\n * Things to Track\r\n * Extra bolts from Upwelling\r\n * Extra hot time from NON-upwelling bolts\r\n * Total hot time from upwelling bolts\r\n */\r\nclass Upwelling extends Analyzer {\r\n  static dependencies = {\r\n    combatants: Combatants,\r\n  };\r\n  totalHealing: number = 0;\r\n  totalOverhealing: number = 0;\r\n  totalAbsorbs: number = 0;\r\n  castEF: number = 0;//casts of ef\r\n  extraHots: number = 0;//number of extra hots\r\n  extraBolts: number = 0;//number of extra bolts\r\n  efHotHeal: number = 0;//healing from hots\r\n  efHotOverheal: number = 0;//overhealing from hots\r\n  boltCount: number = 0;\r\n  totalBolts: number = 0;\r\n  hotMap: Map<number, { fullCount: boolean; applicationTime: number; }> = new Map();//tracking on who has what and how it is\r\n  masteryTickTock: boolean = false;\r\n  masteryHit: number = 0;\r\n  masteryHealing: number = 0;\r\n  masteryOverhealing: number = 0;\r\n  masteryAbsorbed: number = 0;\r\n  protected combatants!: Combatants;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.active = this.selectedCombatant.hasTalent(SPELLS.UPWELLING_TALENT);\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.ESSENCE_FONT_BUFF), this.efHeal);\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.ESSENCE_FONT), this.efcast);\r\n    this.addEventListener(Events.applybuff.by(SELECTED_PLAYER).spell(SPELLS.ESSENCE_FONT_BUFF), this.applyBuff);\r\n    this.addEventListener(Events.removebuff.by(SELECTED_PLAYER).spell(SPELLS.ESSENCE_FONT_BUFF), this.removeBuff);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.GUSTS_OF_MISTS), this.handleMastery);\r\n  }\r\n\r\n  get totalHealingAll() {\r\n    return this.totalHealing + this.totalAbsorbs + this.efHotHeal + this.masteryHealing + this.masteryAbsorbed;\r\n  }\r\n\r\n  get overhealingBolt() {\r\n    return this.totalOverhealing / (this.totalOverhealing + this.totalHealing);\r\n  }\r\n\r\n  get overhealingHot() {\r\n    return this.efHotOverheal / (this.efHotHeal + this.efHotOverheal);\r\n  }\r\n\r\n  get overhealingMastery() {\r\n    return this.masteryOverhealing / (this.masteryHealing + this.masteryOverhealing + this.masteryAbsorbed);\r\n  }\r\n\r\n  efHeal(event: HealEvent) {\r\n    if (event.tick) {\r\n      this.hotHeal(event);\r\n    } else {\r\n      this.boltHeal(event);\r\n    }\r\n  }\r\n\r\n  hotHeal(event: HealEvent) {\r\n    const targetID = event.targetID;//short hand\r\n\r\n    const hot = this.hotMap.get(targetID);\r\n    if (hot === undefined) {\r\n      return;\r\n    }\r\n\r\n    if (this.hotMap.has(targetID)) {//check if hot heals before bolt hits (should never happen but logs)\r\n      if (hot.fullCount || event.timestamp - BASE_HOT_TIME > hot.applicationTime) {//check if its an extra bolt from ef or was part of the core 18\r\n        this.efHotHeal += (event.amount || 0) + (event.absorbed || 0);\r\n        this.efHotOverheal += event.overheal || 0;\r\n      }\r\n    }\r\n  }\r\n\r\n  boltHeal(event: HealEvent) {\r\n    const targetID = event.targetID;//short hand\r\n\r\n    this.totalBolts += 1;//told number of bolts\r\n    if (this.boltCount > BASE_BOLTS) {//only get bolts that are from upwelling\r\n      this.totalHealing += event.amount || 0;\r\n      this.totalOverhealing += event.overheal || 0;\r\n      this.totalAbsorbs += event.absorbed || 0;\r\n      this.extraBolts += 1;\r\n    }\r\n    const holder = {\r\n      fullCount: this.boltCount > BASE_BOLTS,//if its an extra bolt or not\r\n      applicationTime: event.timestamp,//time when casted for nonextra damage\r\n    };\r\n    this.hotMap.set(targetID, holder);//overriding is okay and actually desired if it want to\r\n    this.boltCount += 1;//increase current bolt\r\n  }\r\n\r\n  efcast(event: CastEvent) {\r\n    this.castEF += 1;\r\n    this.boltCount = 0;\r\n    this.hotMap.clear();\r\n  }\r\n\r\n  applyBuff(event: ApplyBuffEvent) {\r\n    if (this.boltCount > BASE_BOLTS) {//Hots from extra bolts\r\n      this.extraHots += 1;\r\n    }\r\n  }\r\n\r\n  removeBuff(event: RemoveBuffEvent) {\r\n    this.hotMap.delete(event.targetID);\r\n  }\r\n\r\n  handleMastery(event: HealEvent) {\r\n    const targetID = event.targetID;//short hand\r\n\r\n    if (!this.combatants.players[targetID]) {//fixes weird bug where if the target fails to load we break the module... might want to add this to core\r\n      return;\r\n    }\r\n\r\n    const hot = this.hotMap.get(targetID);\r\n    if (hot === undefined) {\r\n      return;\r\n    }\r\n\r\n    if (this.combatants.players[targetID].hasBuff(SPELLS.ESSENCE_FONT_BUFF.id, event.timestamp, 0, 0, event.sourceID)) {//do they have the hot\r\n      if (hot.fullCount || event.timestamp - BASE_HOT_TIME > hot.applicationTime) {\r\n        if (!this.masteryTickTock) {\r\n          this.masteryHit += 1;\r\n          this.masteryHealing += event.amount || 0;\r\n          this.masteryOverhealing += event.overheal || 0;\r\n          this.masteryAbsorbed += event.absorbed || 0;\r\n        }\r\n        this.masteryTickTock = !this.masteryTickTock;\r\n      }\r\n    }\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(10)}\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.TALENTS}\r\n        tooltip={(\r\n          <>\r\n            <div>\r\n              Counts healing from extra bolts, healing from the extra 4 second of a hot on a normal bolt (first 18), healing from the full hot on upwelling bolts (post 18), and any mastery event from the hot under the same idea as hot counting\r\n            </div>\r\n            <ul>\r\n              <li>Extra Bolts: {formatNumber(this.extraBolts)}</li>\r\n              <li>Extra Bolts Healing: {formatNumber(this.totalHealing)} ({formatPercentage(this.overhealingBolt)}% overhealing)</li>\r\n              <li>Extra Hots: {formatNumber(this.extraHots)}</li>\r\n              <li>Hots Healing: {formatNumber(this.efHotHeal)} ({formatPercentage(this.overhealingHot)}% overhealing)</li>\r\n              <li>Extra Mastery Hits: {formatNumber(this.masteryHit)}</li>\r\n              <li>Extra Mastery Healing: {formatNumber(this.masteryHealing)} ({formatPercentage(this.overhealingMastery)}% overhealing)</li>\r\n            </ul>\r\n          </>\r\n        )}\r\n      >\r\n        <BoringValueText\r\n          label={<><SpellIcon id={SPELLS.UPWELLING_TALENT.id} /> Upwelling Healing</>}\r\n        >\r\n          <>\r\n            {formatPercentage(this.owner.getPercentageOfTotalHealingDone(this.totalHealingAll))}% Total Healing\r\n          </>\r\n        </BoringValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Upwelling;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport SpellLink from 'common/SpellLink';\r\nimport Panel from 'interface/statistics/Panel';\r\nimport HealingEfficiencyDetails from 'parser/core/healingEfficiency/HealingEfficiencyDetails';\r\nimport HealingEfficiencyTracker from 'parser/core/healingEfficiency/HealingEfficiencyTracker';\r\nimport HealingEfficiencyBreakdown from 'parser/core/healingEfficiency/HealingEfficiencyBreakdown';\r\n\r\nclass MistweaverHealingEfficiencyDetails extends HealingEfficiencyDetails {\r\n  static dependencies = {\r\n    healingEfficiencyTracker: HealingEfficiencyTracker,\r\n  };\r\n\r\n  protected healingEfficiencyTracker!: HealingEfficiencyTracker;\r\n\r\n  statistic() {\r\n    return (\r\n      <Panel\r\n        title=\"Mana efficiency\"\r\n        explanation={(\r\n          <>\r\n            <SpellLink id={SPELLS.GUSTS_OF_MISTS.id} /> healing is added to the appropriate spell that caused the gust. <br /> <SpellLink id={SPELLS.ESSENCE_FONT.id} /> is given the healing from duplicated gusts, since without <SpellLink id={SPELLS.ESSENCE_FONT.id} /> the second gust would not have happened. <br /> <SpellLink id={SPELLS.RENEWING_MIST.id} /> is given the splash healing of <SpellLink id={SPELLS.VIVIFY.id} />'s heal since without <SpellLink id={SPELLS.RENEWING_MIST.id} />, <SpellLink id={SPELLS.VIVIFY.id} /> wouldn't have splashed. <br /> <SpellLink id={SPELLS.ENVELOPING_MIST.id} /> is given the healing of <SpellLink id={SPELLS.ENVELOPING_BREATH.id} /> since without casting <SpellLink id={SPELLS.ENVELOPING_MIST.id} />, <SpellLink id={SPELLS.ENVELOPING_BREATH.id} /> healing would not occur.\r\n          </>\r\n        )}\r\n        pad={false}\r\n        position={120}\r\n      >\r\n        <HealingEfficiencyBreakdown tracker={this.healingEfficiencyTracker} />\r\n      </Panel>\r\n    );\r\n  }\r\n}\r\n\r\nexport default MistweaverHealingEfficiencyDetails;\r\n","import AbilityTracker from 'parser/shared/modules/AbilityTracker';\r\nimport HealingDone from 'parser/shared/modules/throughput/HealingDone';\r\nimport DamageDone from 'parser/shared/modules/throughput/DamageDone';\r\nimport CastEfficiency from 'parser/shared/modules/CastEfficiency';\r\nimport HealingEfficiencyTracker, { SpellInfoDetails } from 'parser/core/healingEfficiency/HealingEfficiencyTracker';\r\nimport SPELLS from 'common/SPELLS/index';\r\nimport ManaTracker from 'parser/core/healingEfficiency/ManaTracker';\r\n\r\nimport Abilities from 'parser/core/modules/Abilities';\r\nimport EssenceFont from 'parser/monk/mistweaver/modules/spells/EssenceFont';\r\nimport EssenceFontMastery from 'parser/monk/mistweaver/modules/features/EssenceFontMastery';\r\nimport EnvelopingMists from 'parser/monk/mistweaver/modules/spells/EnvelopingMists';\r\nimport SoothingMist from 'parser/monk/mistweaver/modules/spells/SoothingMist';\r\nimport RenewingMist from 'parser/monk/mistweaver/modules/spells/RenewingMist';\r\nimport Vivify from 'parser/monk/mistweaver/modules/spells/Vivify';\r\nimport RefreshingJadeWind from 'parser/monk/mistweaver/modules/talents/RefreshingJadeWind';\r\nimport ExpelHarm from 'parser/monk/mistweaver/modules/spells/ExpelHarm';\r\n\r\nclass MistweaverHealingEfficiencyTracker extends HealingEfficiencyTracker {\r\n  static dependencies = {\r\n    manaTracker: ManaTracker,\r\n    abilityTracker: AbilityTracker,\r\n    healingDone: HealingDone,\r\n    damageDone: DamageDone,\r\n    castEfficiency: CastEfficiency,\r\n\r\n    // Custom dependencies\r\n    abilities: Abilities,\r\n    essenceFont: EssenceFont,\r\n    essenceFontMastery: EssenceFontMastery,\r\n    envelopingMists: EnvelopingMists,\r\n    soothingMist: SoothingMist,\r\n    renewingMist: RenewingMist,\r\n    vivify: Vivify,\r\n    refreshingJadeWind: RefreshingJadeWind,\r\n    expelHarm: ExpelHarm,\r\n  };\r\n\r\n  protected manaTracker!: ManaTracker;\r\n  protected abilityTracker!: AbilityTracker;\r\n  protected healingDone!: HealingDone;\r\n  protected damageDone!: DamageDone;\r\n  protected castEfficiency!: CastEfficiency;\r\n  protected abilities!: Abilities;\r\n  protected essenceFont!: EssenceFont;\r\n  protected essenceFontMastery!: EssenceFontMastery;\r\n  protected envelopingMists!: EnvelopingMists;\r\n  protected soothingMist!: SoothingMist;\r\n  protected renewingMist!: RenewingMist;\r\n  protected vivify!: Vivify;\r\n  protected refreshingJadeWind!: RefreshingJadeWind;\r\n  protected expelHarm!: ExpelHarm;\r\n\r\n  getCustomSpellStats(spellInfo: SpellInfoDetails, spellId: number) {\r\n    if (spellId === SPELLS.ESSENCE_FONT.id) {\r\n      spellInfo = this.getEssenceFontDetails(spellInfo);\r\n    } else if (spellId === SPELLS.ENVELOPING_MIST.id) { //maybe consider adding tft buffed version's spell id too\r\n      spellInfo = this.getEnvelopingMistsDetails(spellInfo);\r\n    } else if (spellId === SPELLS.SOOTHING_MIST.id) {\r\n      spellInfo = this.getSoothingMistDetails(spellInfo);\r\n    } else if (spellId === SPELLS.RENEWING_MIST.id) {\r\n      spellInfo = this.getRenewingMistDetails(spellInfo);\r\n    } else if (spellId === SPELLS.VIVIFY.id) {\r\n      spellInfo = this.getVivifyDetails(spellInfo);\r\n    } else if (spellId === SPELLS.REFRESHING_JADE_WIND_TALENT.id) {\r\n      spellInfo = this.getRefreshingJadeWindDetails(spellInfo);\r\n    } else if (spellId === SPELLS.RISING_SUN_KICK.id) {\r\n      spellInfo = this.getRisingSunKickDetails(spellInfo);\r\n    } else if (spellId === SPELLS.INVOKE_YULON_THE_JADE_SERPENT.id) {\r\n      spellInfo = this.getYulonDetails(spellInfo);\r\n    } else if (spellId === SPELLS.INVOKE_CHIJI_THE_RED_CRANE_TALENT.id) {\r\n      spellInfo = this.getChijiDetails(spellInfo);\r\n    } else if (spellId === SPELLS.EXPEL_HARM.id) {\r\n      spellInfo = this.getExpelHarmDetails(spellInfo);\r\n    }\r\n\r\n    return spellInfo;\r\n  }\r\n\r\n  getSoothingMistDetails(spellInfo: SpellInfoDetails) {\r\n    // the default tracker gets the healing of the soothing mists, but only the mana for the first cast. Every tick costs mana.\r\n    spellInfo.manaSpent = this.soothingMist.soomTicks * SPELLS.SOOTHING_MIST.manaCost;\r\n    spellInfo.healingDone = spellInfo.healingDone + this.soothingMist.gustsHealing;\r\n    return spellInfo;\r\n  }\r\n\r\n  getEnvelopingMistsDetails(spellInfo: SpellInfoDetails) {\r\n    spellInfo.healingDone = spellInfo.healingDone + this.envelopingMists.gustsHealing + this.envelopingMists.healingIncrease;\r\n    // Enveloping breath part\r\n    spellInfo.healingDone += this.healingDone.byAbility(SPELLS.ENVELOPING_BREATH.id).effective;\r\n    spellInfo.overhealingDone += this.healingDone.byAbility(SPELLS.ENVELOPING_BREATH.id).overheal;\r\n    return spellInfo;\r\n  }\r\n\r\n  getEssenceFontDetails(spellInfo: SpellInfoDetails) {\r\n    spellInfo.healingDone = this.essenceFont.totalHealing + this.essenceFontMastery.healing + this.essenceFont.totalAbsorbs;\r\n    spellInfo.overhealingDone = this.essenceFont.totalOverhealing;\r\n    spellInfo.healingHits = this.essenceFont.targetsEF;\r\n    return spellInfo;\r\n  }\r\n\r\n  getRenewingMistDetails(spellInfo: SpellInfoDetails) {\r\n    // Vivify splashes due to ReM should be attributed to ReM's value, because without casting ReM, you wouldn't get the splash.\r\n    spellInfo.healingDone = this.renewingMist.totalHealing + this.vivify.remVivifyHealing + this.renewingMist.gustsHealing + this.renewingMist.totalAbsorbs;\r\n    spellInfo.overhealingDone = this.renewingMist.totalOverhealing;\r\n    spellInfo.healingHits = this.renewingMist.healingHits;\r\n    return spellInfo;\r\n  }\r\n\r\n  getVivifyDetails(spellInfo: SpellInfoDetails) {\r\n    // As described in the ReM section, the ReM Vivify splashes need to be removed from the healing done.\r\n    spellInfo.healingDone = spellInfo.healingDone + this.vivify.gustsHealing - this.vivify.remVivifyHealing;\r\n    return spellInfo;\r\n  }\r\n\r\n  getRefreshingJadeWindDetails(spellInfo: SpellInfoDetails) {\r\n    spellInfo.healingDone = this.refreshingJadeWind.healingRJW;\r\n    spellInfo.overhealingDone = this.refreshingJadeWind.overhealingRJW;\r\n    return spellInfo;\r\n  }\r\n\r\n  getRisingSunKickDetails(spellInfo: SpellInfoDetails) {\r\n    // Since I don't want messy code right now it will only give the rising mist healing not any of the other fun stuff it gives indirectly\r\n    spellInfo.healingDone = this.healingDone.byAbility(SPELLS.RISING_MIST_HEAL.id).effective;\r\n    spellInfo.overhealingDone = this.healingDone.byAbility(SPELLS.RISING_MIST_HEAL.id).overheal;\r\n    return spellInfo;\r\n  }\r\n\r\n  getYulonDetails(spellInfo: SpellInfoDetails) {\r\n    // Get all soothing breath and enveloping breath healing since its all bc of yu'lon\r\n    spellInfo.healingDone = this.healingDone.byAbility(SPELLS.SOOTHING_BREATH.id).effective;\r\n    spellInfo.overhealingDone = this.healingDone.byAbility(SPELLS.SOOTHING_BREATH.id).overheal;\r\n    return spellInfo;\r\n  }\r\n\r\n  getChijiDetails(spellInfo: SpellInfoDetails) {\r\n    spellInfo.healingDone = this.healingDone.byAbility(SPELLS.GUST_OF_MISTS_CHIJI.id).effective;\r\n    spellInfo.overhealingDone = this.healingDone.byAbility(SPELLS.GUST_OF_MISTS_CHIJI.id).overheal;\r\n    return spellInfo;\r\n  }\r\n\r\n  getExpelHarmDetails(spellInfo: SpellInfoDetails) {\r\n    spellInfo.healingDone = spellInfo.healingDone + this.expelHarm.gustsHealing + this.expelHarm.selfHealing + this.expelHarm.targetHealing;\r\n    spellInfo.overhealingDone = spellInfo.overhealingDone + this.expelHarm.selfOverheal + this.expelHarm.targetOverheal;\r\n    return spellInfo;\r\n  }\r\n\r\n}\r\n\r\nexport default MistweaverHealingEfficiencyTracker;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\n\r\nimport SpellLink from 'common/SpellLink';\r\nimport { formatThousands } from 'common/format';\r\n\r\nimport Analyzer from 'parser/core/Analyzer';\r\nimport EssenceFontMastery from 'parser/monk/mistweaver/modules/features/EssenceFontMastery';\r\n\r\nimport { STATISTIC_ORDER } from 'interface/others/StatisticsListBox';\r\nimport DonutChart from 'interface/statistics/components/DonutChart';\r\nimport Statistic from 'interface/statistics/Statistic';\r\n\r\nimport EssenceFont from '../spells/EssenceFont';\r\n\r\nclass EssenceFontHealingBreakdown extends Analyzer {\r\n  static dependencies = {\r\n    essenceFontMastery: EssenceFontMastery,\r\n    essenceFont: EssenceFont,\r\n  };\r\n\r\n  protected essenceFontMastery!: EssenceFontMastery;\r\n  protected essenceFont!: EssenceFont;\r\n\r\n  renderEssenceFontChart() {\r\n    const items = [\r\n      {\r\n        color: '#00bbcc',\r\n        label: 'Bolt',\r\n        spellId: SPELLS.ESSENCE_FONT.id,\r\n        value: (this.essenceFont.totalHealing + this.essenceFont.totalAbsorbs),\r\n        valueTooltip: formatThousands((this.essenceFont.totalHealing + this.essenceFont.totalAbsorbs)),\r\n      },\r\n      {\r\n        color: '#f37735',\r\n        label: 'Hot',\r\n        spellId: SPELLS.ESSENCE_FONT_BUFF.id,\r\n        value: this.essenceFont.efHotHeal,\r\n        valueTooltip: formatThousands(this.essenceFont.efHotHeal),\r\n      },\r\n      {\r\n        color: '#00b159',\r\n        label: 'Mastery',\r\n        spellId: SPELLS.GUSTS_OF_MISTS.id,\r\n        value: this.essenceFontMastery.healing,\r\n        valueTooltip: formatThousands(this.essenceFontMastery.healing),\r\n      },\r\n    ];\r\n\r\n    return (\r\n      <DonutChart\r\n        items={items}\r\n      />\r\n    );\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.CORE(20)}\r\n        size=\"flexible\"\r\n      >\r\n        <div className=\"pad\">\r\n          <label><SpellLink id={SPELLS.ESSENCE_FONT.id}>Essence Font</SpellLink> breakdown</label>\r\n          {this.renderEssenceFontChart()}\r\n        </div>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default EssenceFontHealingBreakdown;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport Analyzer, { SELECTED_PLAYER } from 'parser/core/Analyzer';\r\nimport calculateEffectiveHealing from 'parser/core/calculateEffectiveHealing';\r\nimport Events from 'parser/core/Events';\r\n\r\nimport BoringSpellValueText from 'interface/statistics/components/BoringSpellValueText';\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport ItemManaGained from 'interface/ItemManaGained';\r\nimport ItemHealingDone from 'interface/ItemHealingDone';\r\n\r\nclass GroundingBreath extends Analyzer {\r\n\r\n  healing = 0;\r\n  resourceReturned = 0;\r\n\r\n  healingBoost = 0;\r\n\r\n  /**\r\n   * Increase vivify healing on yourself by x% and has a 30% chance to refund any vivify.\r\n   */\r\n  constructor(...args) {\r\n    super(...args);\r\n    this.active = false;//FIXME actually check if they have the conduit\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n\r\n    this.healingBoost = .1;\r\n\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.VIVIFY), this.vivifyBoost);\r\n    this.addEventListener(Events.energize.by(SELECTED_PLAYER).spell([SPELLS.GROUNDING_BREATH_MANA_RETURN, SPELLS.GROUNDING_BREATH_ENERGY_RETURN]), this.onResourceRefund);\r\n  }\r\n\r\n  vivifyBoost(event) {\r\n    if (event.targetID !== event.sourceID) {\r\n      return;\r\n    }\r\n    this.healing += (calculateEffectiveHealing(event, this.healingBoost) || 0);\r\n  }\r\n\r\n  onResourceRefund(event) {\r\n    this.resourceReturned += event.resourceChange;\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(13)}\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.COVENANTS}\r\n      >\r\n        <BoringSpellValueText spell={SPELLS.GROUNDING_BREATH}>\r\n          <ItemManaGained amount={this.resourceReturned} />\r\n          <ItemHealingDone amount={this.healing} /><br />\r\n        </BoringSpellValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default GroundingBreath;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport calculateEffectiveHealing from 'parser/core/calculateEffectiveHealing';\r\nimport Analyzer, { SELECTED_PLAYER } from 'parser/core/Analyzer';\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport ItemDamageDone from 'interface/ItemDamageDone';\r\nimport ItemHealingDone from 'interface/ItemHealingDone';\r\nimport Events from 'parser/core/Events';\r\n\r\nimport BoringSpellValueText from 'interface/statistics/components/BoringSpellValueText';\r\n\r\nclass HarmDenial extends Analyzer {\r\n\r\n  healingIncrease = 0;\r\n\r\n  healingBoost = 0;\r\n  bonusDamage = 0;\r\n\r\n  /**\r\n   * Expel harm healing is boosted by x%\r\n   */\r\n  constructor(...args) {\r\n    super(...args);\r\n    this.active = false;//FIXME actually check if they have the conduit\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n\r\n    this.healingBoost = .2;\r\n\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell([SPELLS.EXPEL_HARM, SPELLS.EXPEL_HARM_TARGET_HEAL]), this.extraHealing);\r\n  }\r\n\r\n  extraHealing(event) {\r\n    const bonusHealing = calculateEffectiveHealing(event, this.healingBoost) || 0;\r\n    this.healingIncrease += bonusHealing;\r\n    this.bonusDamage += bonusHealing * .1;\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(13)}\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.COVENANTS}\r\n      >\r\n        <BoringSpellValueText spell={SPELLS.HARM_DENIAL}>\r\n          <ItemDamageDone amount={this.bonusDamage} /><br />\r\n          <ItemHealingDone amount={this.healingIncrease} />\r\n        </BoringSpellValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default HarmDenial;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport Analyzer from 'parser/core/Analyzer';\r\n\r\nimport BoringSpellValueText from 'interface/statistics/components/BoringSpellValueText';\r\nimport HealingDone from 'parser/shared/modules/throughput/HealingDone';\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport ItemHealingDone from 'interface/ItemHealingDone';\r\n\r\nclass FortifyingIngredients extends Analyzer {\r\n  static dependencies = {\r\n    healingDone: HealingDone,\r\n  };\r\n\r\n  /**\r\n   * Whenever you cast fort brew you gain a shield for x% of your hp\r\n   */\r\n  constructor(...args) {\r\n    super(...args);\r\n    this.active = false;//FIXME actually check if they have the conduit\r\n\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n  }\r\n\r\n  statistic() {\r\n    const shield = this.healingDone.byAbility(SPELLS.FORTIFYING_INGREDIENTS.id).effective;\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(13)}\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.COVENANTS}\r\n      >\r\n        <BoringSpellValueText spell={SPELLS.FORTIFYING_INGREDIENTS}>\r\n          <ItemHealingDone amount={shield} />\r\n        </BoringSpellValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default FortifyingIngredients;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport Events, { CastEvent, HealEvent } from 'parser/core/Events';\r\nimport Analyzer, { Options, SELECTED_PLAYER, SELECTED_PLAYER_PET } from 'parser/core/Analyzer';\r\n\r\nimport SpellUsable from 'parser/shared/modules/SpellUsable';\r\nimport HealingDone from 'parser/shared/modules/throughput/HealingDone';\r\n\r\nimport calculateEffectiveHealing from 'parser/core/calculateEffectiveHealing';\r\n\r\nimport BoringSpellValueText from 'interface/statistics/components/BoringSpellValueText';\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport ItemHealingDone from 'interface/ItemHealingDone';\r\nimport { formatNumber } from 'common/format';\r\nimport Spell from 'common/SPELLS/Spell';\r\n\r\nimport { conduitScaling, JADE_BOND_RANK_ONE } from '../../../constants';\r\n\r\nconst JADE_BOND_REDUCTION = 300;\r\n\r\nclass JadeBond extends Analyzer {\r\n  static dependencies = {\r\n    spellUsable: SpellUsable,\r\n    healingDone: HealingDone,\r\n  };\r\n  cooldownReductionUsed: number = 0;\r\n  cooldownReductionWasted: number = 0;\r\n  spellToReduce: Spell = SPELLS.INVOKE_YULON_THE_JADE_SERPENT;\r\n  healingBoost: number = 0;\r\n  healing: number = 0;\r\n  conduitRank: number = 0;\r\n  protected spellUsable!: SpellUsable;\r\n  protected healingDone!: HealingDone;\r\n\r\n  /**\r\n   * Whenever you cast a Gust of Mist procing ability it reduces the cooldown of Yu'lon or Chi-ji by .5 seconds as well as increasing their healing by x%\r\n   */\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.conduitRank = this.selectedCombatant.conduitRankBySpellID(SPELLS.JADE_BOND.id);\r\n    if (!this.conduitRank) {\r\n      this.active = false;\r\n      return;\r\n    }\r\n\r\n    this.healingBoost = conduitScaling(JADE_BOND_RANK_ONE, this.conduitRank);\r\n\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell([SPELLS.EXPEL_HARM, SPELLS.VIVIFY, SPELLS.RENEWING_MIST, SPELLS.ENVELOPING_MIST]), this.gustProcingSpell);\r\n\r\n    if (this.selectedCombatant.hasTalent(SPELLS.INVOKE_CHIJI_THE_RED_CRANE_TALENT.id)) {\r\n      this.spellToReduce = SPELLS.INVOKE_CHIJI_THE_RED_CRANE_TALENT;\r\n      this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.GUST_OF_MISTS_CHIJI), this.normalizeBoost);\r\n    } else {\r\n      this.addEventListener(Events.heal.by(SELECTED_PLAYER_PET).spell(SPELLS.SOOTHING_BREATH), this.normalizeBoost);\r\n    }\r\n\r\n  }\r\n\r\n  gustProcingSpell(event: CastEvent) {\r\n    if (this.spellUsable.isOnCooldown(this.spellToReduce.id)) {\r\n      this.cooldownReductionUsed += this.spellUsable.reduceCooldown(this.spellToReduce.id, JADE_BOND_REDUCTION);\r\n    } else {\r\n      this.cooldownReductionWasted += JADE_BOND_REDUCTION;\r\n    }\r\n  }\r\n\r\n  normalizeBoost(event: HealEvent) {\r\n    this.healing += calculateEffectiveHealing(event, this.healingBoost);\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(13)}\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.COVENANTS}\r\n        tooltip={(\r\n          <>\r\n            Effective Cooldown Reduction: {formatNumber(this.cooldownReductionUsed / 1000)} Seconds<br />\r\n            Wasted Cooldown Reduction: {formatNumber(this.cooldownReductionWasted / 1000)} Seconds\r\n          </>\r\n        )}\r\n      >\r\n        <BoringSpellValueText spell={SPELLS.JADE_BOND}>\r\n          <ItemHealingDone amount={this.healing} /><br />\r\n        </BoringSpellValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default JadeBond;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport Events, { HealEvent } from 'parser/core/Events';\r\nimport Analyzer, { Options } from 'parser/core/Analyzer';\r\nimport Combatants from 'parser/shared/modules/Combatants';\r\n\r\nimport ItemHealingDone from 'interface/ItemHealingDone';\r\nimport calculateEffectiveHealing from 'parser/core/calculateEffectiveHealing';\r\n\r\nimport BoringSpellValueText from 'interface/statistics/components/BoringSpellValueText';\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\n\r\nimport { conduitScaling, LIFE_COCOON_HEALING_BOOST, NOURISHING_CHI_RANK_ONE } from '../../../constants';\r\n\r\n/**\r\n * HoT Healing during Life cocoon is buffed by x% and this boost lasts for an extra 6 second after cocoon breaks or ends.\r\n * As an FYI from what it looks like is the boost directly effects the Life cocoon buff so we have to reverse math it for while life coocon is up\r\n * Then after cocoon fades/breaks the normal buff goes on them\r\n */\r\nclass NourishingChi extends Analyzer {\r\n  static dependencies = {\r\n    combatants: Combatants,\r\n  };\r\n  healing: number = 0;\r\n  boost: number = 0;\r\n  conduitRank: number = 0;\r\n  protected combatants!: Combatants;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n\r\n    this.conduitRank = this.selectedCombatant.conduitRankBySpellID(SPELLS.NOURISHING_CHI.id);\r\n    if (!this.conduitRank) {\r\n      this.active = false;\r\n      return;\r\n    }\r\n\r\n    this.boost = conduitScaling(NOURISHING_CHI_RANK_ONE, this.conduitRank);\r\n    this.addEventListener(Events.heal, this.heal);\r\n  }\r\n\r\n  heal(event: HealEvent) {\r\n    //Life Cocoon works on any HoT that has this flag checked even if they don't come from the mistweaver themselves\r\n    if (!event.tick) {\r\n      return;\r\n    }\r\n\r\n    const target = this.combatants.players[event.targetID];\r\n\r\n    if (!target) {\r\n      return;\r\n    }\r\n\r\n    if (target.hasBuff(SPELLS.LIFE_COCOON.id, event.timestamp, 0, 0)) {\r\n      // idea\r\n      // heal = boostedHeal / (1.5 + x)\r\n      // bonusHeal = heal * x\r\n      const boostedHeal = (event.amount || 0) + (event.absorbed || 0) + (event.overheal || 0);\r\n      const heal = boostedHeal / (1 + LIFE_COCOON_HEALING_BOOST + this.boost);\r\n      const bonusHeal = heal * this.boost;\r\n      const effectiveHealing = Math.max(0, (bonusHeal - (event.overheal || 0)));\r\n      this.healing += effectiveHealing;\r\n    }\r\n\r\n    if (target.hasBuff(SPELLS.NOURISHING_CHI_BUFF.id, event.timestamp, 0, 0)) {\r\n      this.healing += calculateEffectiveHealing(event, this.boost);\r\n    }\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(13)}\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.COVENANTS}\r\n      >\r\n        <BoringSpellValueText spell={SPELLS.NOURISHING_CHI}>\r\n          <ItemHealingDone amount={this.healing} /><br />\r\n        </BoringSpellValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default NourishingChi;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport Events, { CastEvent } from 'parser/core/Events';\r\nimport Analyzer, { Options, SELECTED_PLAYER } from 'parser/core/Analyzer';\r\n\r\nimport SpellUsable from 'parser/shared/modules/SpellUsable';\r\nimport HealingDone from 'parser/shared/modules/throughput/HealingDone';\r\n\r\nimport BoringSpellValueText from 'interface/statistics/components/BoringSpellValueText';\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport ItemHealingDone from 'interface/ItemHealingDone';\r\nimport { formatNumber } from 'common/format';\r\n\r\nconst RISING_SUN_REDUCTION = 1000;\r\n\r\n/**\r\n * Every time you cast rising sun kick it reduces revival's cooldown by 1 second and whenever you cast revival x% of that healing is done again as a hot over 10 seconds\r\n */\r\nclass RisingSunRevival extends Analyzer {\r\n  static dependencies = {\r\n    spellUsable: SpellUsable,\r\n    healingDone: HealingDone,\r\n  };\r\n  cooldownReductionUsed: number = 0;\r\n  cooldownReductionWasted: number = 0;\r\n  protected spellUsable!: SpellUsable;\r\n  protected healingDone!: HealingDone;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    const conduitRank = this.selectedCombatant.conduitRankBySpellID(SPELLS.RISING_SUN_REVIVAL.id);\r\n\r\n    if (!conduitRank) {\r\n      this.active = false;\r\n      return;\r\n    }\r\n\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell(SPELLS.RISING_SUN_KICK), this.rskCast);\r\n  }\r\n\r\n  rskCast(event: CastEvent) {\r\n    // Cooldown Reduction on Revival\r\n    if (this.spellUsable.isOnCooldown(SPELLS.REVIVAL.id)) {\r\n      this.cooldownReductionUsed += this.spellUsable.reduceCooldown(SPELLS.REVIVAL.id, RISING_SUN_REDUCTION);\r\n    } else {\r\n      this.cooldownReductionWasted += RISING_SUN_REDUCTION;\r\n    }\r\n  }\r\n\r\n  statistic() {\r\n    const healing = this.healingDone.byAbility(SPELLS.RISING_SUN_REVIVAL_HEAL.id).effective;\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(13)}\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.COVENANTS}\r\n        tooltip={(\r\n          <>\r\n            Effective Cooldown Reduction: {formatNumber(this.cooldownReductionUsed / 1000)} Seconds<br />\r\n            Wasted Cooldown Reduction: {formatNumber(this.cooldownReductionWasted / 1000)} Seconds\r\n          </>\r\n        )}\r\n      >\r\n        <BoringSpellValueText spell={SPELLS.RISING_SUN_REVIVAL}>\r\n          <ItemHealingDone amount={healing} /><br />\r\n        </BoringSpellValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default RisingSunRevival;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport Events from 'parser/core/Events';\r\nimport Analyzer, { SELECTED_PLAYER, SELECTED_PLAYER_PET } from 'parser/core/Analyzer';\r\n\r\nimport calculateEffectiveHealing from 'parser/core/calculateEffectiveHealing';\r\n\r\nimport BoringSpellValueText from 'interface/statistics/components/BoringSpellValueText';\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport ItemHealingDone from 'interface/ItemHealingDone';\r\nimport ItemDamageDone from 'interface/ItemDamageDone';\r\n\r\nclass ImbuedReflections extends Analyzer {\r\n  boost = 0;\r\n\r\n  healing = 0;\r\n  damage = 0;\r\n\r\n  cloneIDs = new Set();\r\n\r\n  /**\r\n   * Increase damage and healing by fallen order by x%\r\n   */\r\n  constructor(...args) {\r\n    super(...args);\r\n    this.active = false;\r\n\r\n    this.boost = .29;//TODO Get from combat data when they EXPORT IT >:c\r\n\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n\r\n    //summon events (need to track this to get melees)\r\n    this.addEventListener(Events.summon.by(SELECTED_PLAYER).spell([SPELLS.FALLEN_ORDER_OX_CLONE, SPELLS.FALLEN_ORDER_TIGER_CLONE, SPELLS.FALLEN_ORDER_CRANE_CLONE]), this.trackSummons);\r\n\r\n    //mistweaver spells\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER_PET).spell([SPELLS.FALLEN_ORDER_ENVELOPING_MIST, SPELLS.FALLEN_ORDER_SOOTHING_MIST]), this.normalizeHealingBoost);\r\n    //brewmaster spells\r\n    this.addEventListener(Events.damage.by(SELECTED_PLAYER_PET).spell([SPELLS.FALLEN_ORDER_KEG_SMASH, SPELLS.FALLEN_ORDER_BREATH_OF_FIRE, SPELLS.BREATH_OF_FIRE_DEBUFF]), this.normalizeDamageBoost);\r\n    //windwalker spells\r\n    this.addEventListener(Events.damage.by(SELECTED_PLAYER_PET).spell([SPELLS.FALLEN_ORDER_SPINNING_CRANE_KICK, SPELLS.FISTS_OF_FURY_DAMAGE]), this.normalizeDamageBoost);\r\n    //shared\r\n    this.addEventListener(Events.damage.by(SELECTED_PLAYER_PET).spell(SPELLS.MELEE), this.handleMelee);\r\n  }\r\n\r\n  trackSummons(event) {\r\n    this.cloneIDs.add(event.targetID);\r\n  }\r\n\r\n  normalizeHealingBoost(event) {\r\n    this.healing += calculateEffectiveHealing(event, this.boost);\r\n  }\r\n\r\n  normalizeDamageBoost(event) {\r\n    const damage = event.amount;\r\n    const amount = (damage - damage / (1 + this.boost)) || 0;\r\n    this.damage += amount;\r\n  }\r\n\r\n  handleMelee(event) {\r\n    if (this.cloneIDs.has(event.sourceID)) {\r\n      this.normalizeDamageBoost(event);\r\n    }\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(13)}\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.COVENANTS}\r\n      >\r\n        <BoringSpellValueText spell={SPELLS.IMBUED_REFLECTIONS}>\r\n          <ItemHealingDone amount={this.healing} /><br />\r\n          <ItemDamageDone amount={this.damage} />\r\n        </BoringSpellValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ImbuedReflections;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport Events, { ApplyBuffEvent, HealEvent, RemoveBuffEvent } from 'parser/core/Events';\r\nimport Analyzer, { Options, SELECTED_PLAYER } from 'parser/core/Analyzer';\r\n\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport SpellLink from 'common/SpellLink';\r\n\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport { formatThousands } from 'common/format';\r\nimport DonutChart from 'interface/statistics/components/DonutChart';\r\n\r\nconst POWER_TRANSFER = .25;\r\n\r\nclass TearofMorning extends Analyzer {\r\n\r\n  vivHealing: number = 0;\r\n  envHealing: number = 0;\r\n  envbHealing: number = 0;\r\n\r\n  numberOExtendLifes: number = 0;\r\n\r\n  /**\r\n   * When you cast renewing mist on a target you grant them extend life, Extend life makes it so all vivify and eveloping mist/breath is replicated on the target by 25%\r\n   */\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.active = false;\r\n\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n\r\n    this.addEventListener(Events.applybuff.by(SELECTED_PLAYER).spell(SPELLS.TEAR_OF_MORNING_BUFF), this.manageBuffApplied);\r\n    this.addEventListener(Events.removebuff.by(SELECTED_PLAYER).spell(SPELLS.TEAR_OF_MORNING_BUFF), this.manageBuffRemoved);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.ENVELOPING_MIST), this.envelopingMistHealing);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.ENVELOPING_BREATH), this.envelopingBreathHealing);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.VIVIFY), this.vivifyHealing);\r\n  }\r\n\r\n  manageBuffApplied(event: ApplyBuffEvent) {\r\n    this.numberOExtendLifes += 1;\r\n  }\r\n\r\n  manageBuffRemoved(event: RemoveBuffEvent) {\r\n    this.numberOExtendLifes -= 1;\r\n  }\r\n\r\n  envelopingMistHealing(event: HealEvent) {\r\n    this.envHealing += ((event.amount || 0) + (event.absorbed || 0) + (event.overheal || 0)) * POWER_TRANSFER * this.numberOExtendLifes;\r\n  }\r\n\r\n  envelopingBreathHealing(event: HealEvent) {\r\n    this.envbHealing += ((event.amount || 0) + (event.absorbed || 0) + (event.overheal || 0)) * POWER_TRANSFER * this.numberOExtendLifes;\r\n  }\r\n\r\n  vivifyHealing(event: HealEvent) {\r\n    this.vivHealing += ((event.amount || 0) + (event.absorbed || 0) + (event.overheal || 0)) * POWER_TRANSFER * this.numberOExtendLifes;\r\n  }\r\n\r\n  renderDonutChart() {\r\n    const totalHealing = this.vivHealing + this.envHealing + this.envbHealing;\r\n    const vivRatio = this.vivHealing / totalHealing;\r\n    const envRatio = this.envHealing / totalHealing;\r\n    const envbRatio = this.envbHealing / totalHealing;\r\n    const items = [\r\n      {\r\n        color: '#00b159',\r\n        label: 'Vivify',\r\n        spellId: SPELLS.VIVIFY.id,\r\n        value: vivRatio,\r\n        valueTooltip: formatThousands(this.vivHealing),\r\n      },\r\n      {\r\n        color: '#f37735',\r\n        label: 'Enveloping Mist',\r\n        spellId: SPELLS.ENVELOPING_MIST.id,\r\n        value: envRatio,\r\n        valueTooltip: formatThousands(this.envHealing),\r\n      },\r\n      {\r\n        color: '#db00db',\r\n        label: 'Enveloping Breath',\r\n        spellId: SPELLS.ENVELOPING_BREATH.id,\r\n        value: envbRatio,\r\n        valueTooltip: formatThousands(this.envbHealing),\r\n      },\r\n    ];\r\n\r\n    return (\r\n      <DonutChart\r\n        items={items}\r\n      />\r\n    );\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(13)}\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.COVENANTS}\r\n      >\r\n        <div className=\"pad\">\r\n          <label><SpellLink id={SPELLS.TEAR_OF_MORNING_BUFF.id}>Tear of Morning</SpellLink> breakdown</label>\r\n          {this.renderDonutChart()}\r\n        </div>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default TearofMorning;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport Events, { DamageEvent, HealEvent } from 'parser/core/Events';\r\nimport Analyzer, { Options, SELECTED_PLAYER } from 'parser/core/Analyzer';\r\n\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport SpellLink from 'common/SpellLink';\r\n\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport { formatThousands } from 'common/format';\r\nimport DonutChart from 'interface/statistics/components/DonutChart';\r\n\r\nclass AncientTeachingsoftheMonastery extends Analyzer {\r\n\r\n  damageSpellToHealing: Map<number, number> = new Map();\r\n\r\n  lastDamageSpellID: number = 0;\r\n\r\n  /**\r\n   * After you cast Essence Font, Tiger Palm, Blackout Kick, and Rising Sun Kick heal an injured ally within 20 yards for 250% of the damage done. Lasts 15s.\r\n   */\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.active = false;\r\n\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n\r\n    this.addEventListener(Events.damage.by(SELECTED_PLAYER).spell([SPELLS.RISING_SUN_KICK_SECOND, SPELLS.BLACKOUT_KICK, SPELLS.BLACKOUT_KICK_TOTM, SPELLS.TIGER_PALM]), this.lastDamageEvent);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.ANCIENT_TEACHINGS_OF_THE_MONASTERY_HEAL), this.calculateEffectiveHealing);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(SPELLS.ANCIENT_TEACHINGS_OF_THE_MONASTERY_CRIT_HEAL), this.calculateEffectiveHealing);\r\n  }\r\n\r\n  lastDamageEvent(event: DamageEvent) {\r\n    if (!this.selectedCombatant.hasBuff(SPELLS.ANCIENT_TEACHINGS_OF_THE_MONASTERY_BUFF.id)) {\r\n      return;\r\n    }\r\n    this.lastDamageSpellID = event.ability.guid;\r\n    if (!this.damageSpellToHealing.has(this.lastDamageSpellID)) {\r\n      this.damageSpellToHealing.set(this.lastDamageSpellID, 0);\r\n    }\r\n  }\r\n\r\n  calculateEffectiveHealing(event: HealEvent) {\r\n    const heal = (event.amount || 0) + (event.absorbed || 0);\r\n    const oldHealingTotal = this.damageSpellToHealing.get(this.lastDamageSpellID) || 0;\r\n    this.damageSpellToHealing.set(this.lastDamageSpellID, heal + oldHealingTotal);\r\n  }\r\n\r\n  renderDonutChart() {\r\n    const rskHealing = (this.damageSpellToHealing.get(SPELLS.RISING_SUN_KICK_SECOND.id) || 0);\r\n    const bokHealing = (this.damageSpellToHealing.get(SPELLS.BLACKOUT_KICK.id) || 0);\r\n    const totmHealing = (this.damageSpellToHealing.get(SPELLS.BLACKOUT_KICK_TOTM.id) || 0);\r\n    const tpHealing = (this.damageSpellToHealing.get(SPELLS.TIGER_PALM.id) || 0);\r\n    const totalHealing = rskHealing + bokHealing + totmHealing + tpHealing;\r\n\r\n    const items = [\r\n      {\r\n        color: '#ffc425',\r\n        label: 'Rising Sun Kick',\r\n        spellId: SPELLS.RISING_SUN_KICK.id,\r\n        value: rskHealing / totalHealing,\r\n        valueTooltip: formatThousands(rskHealing),\r\n      },\r\n      {\r\n        color: '#7500db',\r\n        label: 'Blackout Kick',\r\n        spellId: SPELLS.BLACKOUT_KICK.id,\r\n        value: bokHealing / totalHealing,\r\n        valueTooltip: formatThousands(bokHealing),\r\n      },\r\n      {\r\n        color: '#db00db',\r\n        label: 'Teachings of the Monastery',\r\n        spellId: SPELLS.BLACKOUT_KICK_TOTM.id,\r\n        value: totmHealing / totalHealing,\r\n        valueTooltip: formatThousands(totmHealing),\r\n      },\r\n      {\r\n        color: '#00b159',\r\n        label: 'Tiger Palm',\r\n        spellId: SPELLS.TIGER_PALM.id,\r\n        value: tpHealing / totalHealing,\r\n        valueTooltip: formatThousands(tpHealing),\r\n      },\r\n    ];\r\n\r\n    return (\r\n      <DonutChart\r\n        items={items}\r\n      />\r\n    );\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(13)}\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.COVENANTS}\r\n      >\r\n        <div className=\"pad\">\r\n          <label><SpellLink id={SPELLS.ANCIENT_TEACHINGS_OF_THE_MONASTERY_HEAL.id}>Ancient Teachings of the Monastery</SpellLink> breakdown</label>\r\n          {this.renderDonutChart()}\r\n        </div>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default AncientTeachingsoftheMonastery;\r\n","import React from 'react';\r\n\r\nimport SPELLS from 'common/SPELLS';\r\nimport Events, { ApplyBuffEvent, ApplyBuffStackEvent, CastEvent, HealEvent, RemoveBuffEvent } from 'parser/core/Events';\r\nimport Analyzer, { Options, SELECTED_PLAYER } from 'parser/core/Analyzer';\r\n\r\nimport calculateEffectiveHealing from 'parser/core/calculateEffectiveHealing';\r\n\r\nimport BoringSpellValueText from 'interface/statistics/components/BoringSpellValueText';\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport ItemHealingDone from 'interface/ItemHealingDone';\r\nimport ItemManaGained from 'interface/ItemManaGained';\r\n\r\nconst BUFF_AMOUNT_PER_STACK = .15;\r\n\r\n/**\r\n * Whenever you cast a vivify or enveloping mist during soothing mist's channel you gain a stack of clouded focus which increases their healing by 15% and descreases their\r\n * mana cost by 15% as well. You can have up to 3 stack but you lose all the stacks when you stop channeling soothing mist.\r\n */\r\nclass CloudedFocus extends Analyzer {\r\n\r\n  manaSaved: number = 0;\r\n  healingDone: number = 0;\r\n\r\n  stacks: number = 0;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.active = false;\r\n\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n\r\n    this.addEventListener(Events.applybuff.by(SELECTED_PLAYER).spell(SPELLS.CLOUDED_FOCUS_BUFF), this.applybuff);\r\n    this.addEventListener(Events.applybuffstack.by(SELECTED_PLAYER).spell(SPELLS.CLOUDED_FOCUS_BUFF), this.applyBuffStack);\r\n    this.addEventListener(Events.removebuff.by(SELECTED_PLAYER).spell(SPELLS.CLOUDED_FOCUS_BUFF), this.removeBuff);\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER).spell([SPELLS.VIVIFY, SPELLS.ENVELOPING_MIST]), this.calculateManaEffect);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell([SPELLS.VIVIFY, SPELLS.ENVELOPING_MIST]), this.calculateHealingEffect);\r\n  }\r\n\r\n  calculateManaEffect(event: CastEvent) {\r\n    if (this.selectedCombatant.hasBuff(SPELLS.INNERVATE.id)) {\r\n      return;\r\n    }\r\n\r\n    let cost = event.rawResourceCost ? event.rawResourceCost[0] : 0;\r\n    if (this.selectedCombatant.hasBuff(SPELLS.MANA_TEA_TALENT.id)) {\r\n      cost /= 2;\r\n    }\r\n\r\n    this.manaSaved += cost - cost / (1 + this.stacks * BUFF_AMOUNT_PER_STACK);\r\n  }\r\n\r\n  calculateHealingEffect(event: HealEvent) {\r\n    this.healingDone += calculateEffectiveHealing(event, this.stacks * BUFF_AMOUNT_PER_STACK);\r\n  }\r\n\r\n  applybuff(event: ApplyBuffEvent) {\r\n    this.stacks = 1;\r\n  }\r\n\r\n  applyBuffStack(event: ApplyBuffStackEvent) {\r\n    this.stacks = event.stack;\r\n  }\r\n\r\n  removeBuff(event: RemoveBuffEvent) {\r\n    this.stacks = 0;\r\n  }\r\n\r\n  statistic() {\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.OPTIONAL(13)}\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.COVENANTS}\r\n      >\r\n        <BoringSpellValueText spell={SPELLS.CLOUDED_FOCUS_BUFF}>\r\n          <ItemHealingDone amount={this.healingDone} /><br />\r\n          <ItemManaGained amount={this.manaSaved} />\r\n        </BoringSpellValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default CloudedFocus;\r\n","import CoreCombatLogParser from 'parser/core/CombatLogParser';\r\n\r\nimport LowHealthHealing from 'parser/shared/modules/features/LowHealthHealing';\r\nimport ManaLevelChart from 'parser/shared/modules/resources/mana/ManaLevelChart';\r\nimport ManaUsageChart from 'parser/shared/modules/resources/mana/ManaUsageChart';\r\n\r\nimport GlobalCooldown from './modules/core/GlobalCooldown';\r\nimport CoreChanneling from './modules/core/Channeling';\r\nimport HotTrackerMW from './modules/core/HotTrackerMW';\r\n\r\n// Normalizers\r\nimport HotApplicationNormalizer from './normalizers/HotApplicationNormalizer';\r\nimport HotRemovalNormalizer from './normalizers/HotRemovalNormalizer';\r\n\r\n// Features\r\nimport Abilities from './modules/features/Abilities';\r\nimport CooldownThroughputTracker from './modules/features/CooldownThroughputTracker';\r\nimport AlwaysBeCasting from './modules/features/AlwaysBeCasting';\r\nimport EssenceFontMastery from './modules/features/EssenceFontMastery';\r\nimport Checklist from './modules/features/Checklist/Module';\r\nimport StatValues from './modules/features/StatValues';\r\nimport EvmVivCastRatio from './modules/features/EvmVivCastRatio';\r\nimport MasteryStats from './modules/features/MasteryStats';\r\nimport Buffs from './modules/features/Buffs';\r\n\r\n// Spells\r\nimport ThunderFocusTea from './modules/spells/ThunderFocusTea';\r\nimport EssenceFont from './modules/spells/EssenceFont';\r\nimport EnvelopingMists from './modules/spells/EnvelopingMists';\r\nimport SoothingMist from './modules/spells/SoothingMist';\r\nimport Vivify from './modules/spells/Vivify';\r\nimport LifeCocoon from './modules/spells/LifeCocoon';\r\nimport SpinningCraneKick from './modules/spells/SpinningCraneKick';\r\nimport RenewingMist from './modules/spells/RenewingMist';\r\nimport TouchOfDeath from '../shared/modules/spells/TouchOfDeath';\r\nimport InvokeYulon from './modules/spells/InvokeYulon';\r\nimport InvokeChiJi from './modules/talents/InvokeChiJi';\r\nimport ExpelHarm from './modules/spells/ExpelHarm';\r\nimport EnvelopingBreath from './modules/spells/EnvelopingBreath';\r\n\r\n// Talents\r\nimport JadeSerpentStatue from './modules/talents/JadeSerpentStatue';\r\nimport ChiBurst from './modules/talents/ChiBurst';\r\nimport ManaTea from './modules/talents/ManaTea';\r\nimport RefreshingJadeWind from './modules/talents/RefreshingJadeWind';\r\nimport Lifecycles from './modules/talents/Lifecycles';\r\nimport SpiritOfTheCrane from './modules/talents/SpiritOfTheCrane';\r\nimport RisingMist from './modules/talents/RisingMist';\r\nimport AverageTimeBetweenRSKSs from './modules/talents/AverageTimeBetweenRSKs';\r\nimport RenewingMistDuringManaTea from './modules/talents/RenewingMistDuringManaTea';\r\nimport Tier45Comparison from './modules/talents/Tier45Comparison';\r\nimport Upwelling from './modules/talents/Upwelling';\r\n\r\n// Mana Tracker\r\nimport MistweaverHealingEfficiencyDetails from './modules/features/MistweaverHealingEfficiencyDetails';\r\nimport HealingEfficiencyTracker from './modules/features/MistweaverHealingEfficiencyTracker';\r\nimport ManaTracker from '../../core/healingEfficiency/ManaTracker';\r\n\r\nimport { ABILITIES_AFFECTED_BY_HEALING_INCREASES } from './constants';\r\nimport EssenceFontHealingBreakdown from './modules/features/EssenceFontHealingBreakdown';\r\n\r\n// Covenants\r\nimport FallenOrder from '../shared/modules/covenants/FallenOrder';\r\n\r\n// Conduits\r\n// Endurance\r\nimport GroundingBreath from '../shared/modules/conduits/GroundingBreath';\r\nimport HarmDenial from '../shared/modules/conduits/HarmDenial';\r\nimport FortifyingIngredients from '../shared/modules/conduits/FortifyingIngredients';\r\n\r\n// Potency\r\nimport JadeBond from './modules/shadowlands/conduits/JadeBond';\r\nimport NourishingChi from './modules/shadowlands/conduits/NourishingChi';\r\nimport RisingSunRevival from './modules/shadowlands/conduits/RisingSunRevival';\r\nimport ImbuedReflections from '../shared/modules/conduits/ImbuedReflections';\r\n\r\n// Legendaries\r\nimport TearofMorning from './modules/shadowlands/legendaries/TearofMorning';\r\nimport AncientTeachingsoftheMonastery from './modules/shadowlands/legendaries/AncientTeachingsoftheMonastery';\r\nimport CloudedFocus from './modules/shadowlands/legendaries/CloudedFocus';\r\n\r\nclass CombatLogParser extends CoreCombatLogParser {\r\n  static abilitiesAffectedByHealingIncreases = ABILITIES_AFFECTED_BY_HEALING_INCREASES;\r\n\r\n  static specModules = {\r\n    // Normalizer\r\n    hotApplicationNormalizer: HotApplicationNormalizer,\r\n    hotRemovalNormalizer: HotRemovalNormalizer,\r\n\r\n    // Core\r\n    lowHealthHealing: LowHealthHealing,\r\n    channeling: CoreChanneling,\r\n    globalCooldown: GlobalCooldown,\r\n    hotTrackerMW: HotTrackerMW,\r\n\r\n    // Generic healer things\r\n    manaLevelChart: ManaLevelChart,\r\n    manaUsageChart: ManaUsageChart,\r\n\r\n    // Features\r\n    alwaysBeCasting: AlwaysBeCasting,\r\n    abilities: Abilities,\r\n    cooldownThroughputTracker: CooldownThroughputTracker,\r\n    essenceFontMastery: EssenceFontMastery,\r\n    checklist: Checklist,\r\n    statValues: StatValues,\r\n    evmVivCastRatio: EvmVivCastRatio,\r\n    masteryStats: MasteryStats,\r\n    buffs: Buffs,\r\n    essenceFontHealingBreakDown: EssenceFontHealingBreakdown,\r\n    averageTimeBetweenRSKSs: AverageTimeBetweenRSKSs,\r\n\r\n    // Spells\r\n    essenceFont: EssenceFont,\r\n    thunderFocusTea: ThunderFocusTea,\r\n    envelopingMists: EnvelopingMists,\r\n    soothingMist: SoothingMist, // Removed as this needs to be reworked with updated Soothing Mist Spell in BfA\r\n    spinningCraneKick: SpinningCraneKick,\r\n    vivify: Vivify,\r\n    renewingMist: RenewingMist,\r\n    lifeCocoon: LifeCocoon,\r\n    touchOfDeath: TouchOfDeath,\r\n    invokeYulon: InvokeYulon,\r\n    expelHarm: ExpelHarm,\r\n    envelopingBreath: EnvelopingBreath,\r\n\r\n    // Talents\r\n    chiBurst: ChiBurst,\r\n    manaTea: ManaTea,\r\n    refreshingJadeWind: RefreshingJadeWind,\r\n    lifecycles: Lifecycles,\r\n    spiritOfTheCrane: SpiritOfTheCrane,\r\n    risingMist: RisingMist,\r\n    jadeSerpentStatue: JadeSerpentStatue,\r\n    renewingMistDuringManaTea: RenewingMistDuringManaTea,\r\n    tier45Comparison: Tier45Comparison,\r\n    upwelling: Upwelling,\r\n    invokeChiJi: InvokeChiJi,\r\n\r\n    // Mana Tab\r\n    manaTracker: ManaTracker,\r\n    hpmDetails: MistweaverHealingEfficiencyDetails,\r\n    hpmTracker: HealingEfficiencyTracker,\r\n\r\n    // Covenants\r\n    fallenOrder: FallenOrder,\r\n\r\n    // Conduits\r\n    // Endurance\r\n    groundingBreath: GroundingBreath,\r\n    harmDenial: HarmDenial,\r\n    fortifyingIngredients: FortifyingIngredients,\r\n\r\n    // Potency\r\n    jadeBond: JadeBond,\r\n    nourishingChi: NourishingChi,\r\n    risingSunRevival: RisingSunRevival,\r\n    imbuedReflections: ImbuedReflections,\r\n\r\n    // Legendaries\r\n    tearofMorning: TearofMorning,\r\n    ancientTeachingsoftheMonastery: AncientTeachingsoftheMonastery,\r\n    cloudedFocus: CloudedFocus,\r\n  };\r\n}\r\n\r\nexport default CombatLogParser;\r\n","/**\r\n * A simple component that shows the spell value in the most plain way possible.\r\n * Use this only as the very last resort.\r\n */\r\nimport React from 'react';\r\n\r\nimport SpellIcon from 'common/SpellIcon';\r\nimport SpellLink from 'common/SpellLink';\r\nimport Spell from 'common/SPELLS/Spell';\r\n\r\ntype Props = {\r\n  spell: Spell;\r\n  children: React.ReactNode;\r\n  className?: string;\r\n}\r\n\r\nconst BoringSpellValueText = ({ spell, children, className }: Props) => (\r\n  <div className={`pad boring-text ${className || ''}`}>\r\n    <label>\r\n      <SpellIcon id={spell.id} /> <SpellLink id={spell.id} icon={false} />\r\n    </label>\r\n    <div className=\"value\">\r\n      {children}\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport default BoringSpellValueText;\r\n","export default function calculateEffectiveDamage(event, increase) {\r\n  const raw = (event.amount || 0) + (event.absorbed || 0);\r\n  return raw - (raw / (1 + increase));\r\n}\r\n","/**\r\n * A simple component that shows a value in the most plain way possible.\r\n * Use this only as the very last resort.\r\n */\r\nimport React from 'react';\r\n\r\ntype Props = {\r\n  label: React.ReactNode;\r\n  children: React.ReactNode;\r\n  className?: string;\r\n}\r\n\r\nconst BoringValue = ({ label, children, className }: Props) => (\r\n  <div className={`pad boring-text ${className || ''}`}>\r\n    <label>\r\n      {label}\r\n    </label>\r\n    <div className=\"value\">\r\n      {children}\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport default BoringValue;\r\n","/**\r\n * Velen's is a static 15% healing increase to the raw healing going out. If that increase turns out to be overhealing it is worthless, so my approach of reducing the healing gain by the overhealing really only gives you the gain in healing that actually did something. An implementation that ignores overhealing and acts like Velen's contributed 15% of the effective healing will be inaccurate if there was any overhealing.\r\n *\r\n * I'll try to explain this PoV with an example:\r\n * Normal spell heals for 1,000 raw\r\n * With Velen's this is 1,150 raw. So Velen's increased the heal by 150 raw healing, that healing is on top of the original 1,000 raw healing the spell normally does.\r\n * Then comes overhealing;\r\n * If the spell overheals for 50, then the spell will have healed for 1,100. At this point Velen's effectively contributes 100 healing.\r\n * If the spell overheals for 100, then the spell will have healed for 1,050. So velen's effectiveness is 50;\r\n * If the spell overheals for 150, then the spell will have healed for the original 1,000 and Velen's increase was completely wasted.\r\n * If the spell overheals for 200, then 50 healing of the original spell was already overhealing, and the increased healing from Velen's did nothing (0).\r\n *\r\n * If you ignore raw healing and look at the actual healing done you may see the last 950 healing and think 15% of that was contributed by Velen's, while in fact it was 0.\r\n */\r\n\r\nexport default function calculateEffectiveHealing(event, relativeHealIncrease) {\r\n  const amount = event.amount;\r\n  const absorbed = event.absorbed || 0;\r\n  const overheal = event.overheal || 0;\r\n  const raw = amount + absorbed + overheal;\r\n  const relativeHealingIncreaseFactor = 1 + relativeHealIncrease;\r\n  const healingIncrease = raw - raw / relativeHealingIncreaseFactor;\r\n  const effectiveHealing = healingIncrease - overheal;\r\n\r\n  return Math.max(0, effectiveHealing);\r\n}\r\n","import Analyzer, { SELECTED_PLAYER, Options } from 'parser/core/Analyzer';\r\nimport EventEmitter from 'parser/core/modules/EventEmitter';\r\nimport Events, { EventType, ClassResources, EnergizeEvent, CastEvent, HealEvent, SpendResourceEvent } from 'parser/core/Events';\r\nimport { Resource } from 'game/RESOURCE_TYPES';\r\n\r\nexport type BuilderObj = {\r\n  generated: number,\r\n  wasted: number,\r\n  casts: number,\r\n}\r\n\r\nexport type SpenderObj = {\r\n  spent: number,\r\n  spentByCast: number[],\r\n  casts: number,\r\n}\r\n\r\ntype ResourceUpdate = {\r\n  timestamp: number | undefined,\r\n  current: number,\r\n  waste: number,\r\n  generated: number,\r\n  used: number,\r\n}\r\n\r\n/**\r\n * This is an 'abstract' implementation of a framework for tracking resource generating/spending.\r\n * Extend it by following the instructions in the TODO comments below\r\n */\r\nclass ResourceTracker extends Analyzer {\r\n  static dependencies = {\r\n    eventEmitter: EventEmitter,\r\n    // Optional dependency for the `resourceCost` prop of events\r\n    // spellResourceCost: SpellResourceCost,\r\n  };\r\n\r\n  protected eventEmitter!: EventEmitter;\r\n\r\n  current = 0;\r\n  resourceUpdates: ResourceUpdate[] = [];\r\n\r\n  // stores resource gained/spent/wasted by ability ID\r\n  buildersObj: {[index: number]: BuilderObj} = {};\r\n  spendersObj: {[index: number]: SpenderObj} = {};\r\n\r\n  // TODO set this to the resource you wish to track constructor.. see the appropriate objects in game/RESOURCE_TYPES\r\n  resource!: Resource;\r\n\r\n  // TODO a classes 'main' resource passes the max along with events, but for other resources this may need to be defined\r\n  maxResource!: number;\r\n\r\n  constructor(options: Options){\r\n    super(options);\r\n    this.addEventListener(Events.energize.to(SELECTED_PLAYER), this.onEnergize);\r\n    this.addEventListener(Events.cast.by(SELECTED_PLAYER), this.onCast);\r\n  }\r\n\r\n  // FIXME implement natural regen\r\n  // TODO if the tracked resource naturally regenerates (like Energy), set this to true and set the parameters of the regeneration in the below fields\r\n  // naturallyRegenerates = false;\r\n  // baseRegenRate; // TODO resource's base regeneration rate in points per second\r\n  // isRegenHasted; // TODO iff true, regeneration rate will be scaled with haste\r\n\r\n  // TODO if you wish an ability to show in results even if it wasn't used, add it using these functions constructor\r\n  initBuilderAbility(spellId: number) {\r\n    this.buildersObj[spellId] = { generated: 0, wasted: 0, casts: 0 };\r\n  }\r\n  initSpenderAbility(spellId: number) {\r\n    this.spendersObj[spellId] = { spent: 0, spentByCast: [], casts: 0 };\r\n  }\r\n\r\n  // BUILDERS - Handled on energize, using the 'resourceChange' field\r\n  onEnergize(event: EnergizeEvent) {\r\n    const spellId = event.ability.guid;\r\n\r\n    if(event.resourceChangeType !== this.resource.id) {\r\n        return;\r\n    }\r\n\r\n    const waste = event.waste;\r\n    const gain = event.resourceChange - waste;\r\n    this._applyBuilder(spellId, gain, waste, this.getResource(event), event.timestamp);\r\n  }\r\n\r\n  // FIXME Track resource drains too, so that the 'current' value can be more accurate\r\n\r\n  // TODO if a resource gain isn't showing as an energize in events, handle it manually by calling this\r\n  /**\r\n   * FIXME solve with a normalizer instead?\r\n   * Applies an energize of the tracked resource type.\r\n   * @param {number} spellId - The spellId to attribute the resource gain to\r\n   * @param {number} amount - The raw amount of resources to gain\r\n   */\r\n  processInvisibleEnergize(spellId: number, amount: number) {\r\n    const maxGain = this.maxResource !== undefined ? this.maxResource - this.current : amount;\r\n    const gain = Math.min(amount, maxGain);\r\n    const waste = Math.max(amount - maxGain, 0);\r\n    this._applyBuilder(spellId, gain, waste);\r\n  }\r\n\r\n  _applyBuilder(spellId: number, gain: number, waste: number,  resource?: ClassResources, timestamp?: number) {\r\n    if (!this.buildersObj[spellId]) {\r\n        this.initBuilderAbility(spellId);\r\n    }\r\n\r\n    this.buildersObj[spellId].wasted += waste;\r\n    this.buildersObj[spellId].generated += gain;\r\n    this.buildersObj[spellId].casts += 1;\r\n\r\n    // resource.amount for an energize is the amount AFTER the energize\r\n    if (resource !== null && resource !== undefined && resource.amount !== undefined) {\r\n      this.current = resource.amount;\r\n      if (resource.max !== undefined) {\r\n        this.maxResource = resource.max; // track changes in max resource, which can happen due to procs / casts\r\n      }\r\n    } else {\r\n      this.current += gain;\r\n    }\r\n\r\n    this.resourceUpdates.push({\r\n      timestamp: timestamp,\r\n      current: this.current,\r\n      waste: waste,\r\n      generated: gain,\r\n      used: 0,\r\n    });\r\n  }\r\n\r\n  // SPENDERS - Handled on cast, using the 'classResources' field\r\n  onCast(event: CastEvent) {\r\n    const spellId = event.ability.guid;\r\n\r\n    if(!this.shouldProcessCastEvent(event)) {\r\n        return;\r\n    }\r\n    const eventResource = this.getResource(event);\r\n\r\n    if(!eventResource){\r\n      return;\r\n    }\r\n\r\n    if (eventResource.max) {\r\n      this.maxResource = eventResource.max; // track changes in max resource, which can happen due to procs / casts\r\n    }\r\n    const cost = this.getReducedCost(event);\r\n\r\n    if (!this.spendersObj[spellId]) {\r\n      this.initSpenderAbility(spellId);\r\n    }\r\n\r\n    if (!cost || cost === 0) {\r\n      return;\r\n    }\r\n\r\n    this.spendersObj[spellId].casts += 1;\r\n    this.spendersObj[spellId].spentByCast.push(cost);\r\n    if(cost > 0) {\r\n      this.spendersObj[spellId].spent += cost;\r\n    }\r\n\r\n    //Re-sync current amount, to update not-tracked gains.\r\n    this.current = eventResource.amount - cost;\r\n\r\n    this.resourceUpdates.push({\r\n      timestamp: event.timestamp,\r\n      current: this.current,\r\n      waste: 0,\r\n      generated: 0,\r\n      used: eventResource.amount,\r\n    });\r\n\r\n    this.triggerSpendEvent(cost, event);\r\n  }\r\n\r\n  // TODO if your spec has an ability cost reduction that doesn't show in events, handle it manually by overriding here. Or extend SpellResourceCost and apply the discount there.\r\n  getReducedCost(event: CastEvent) {\r\n    if (event.resourceCost && event.resourceCost[this.resource.id] !== undefined) {\r\n      return event.resourceCost[this.resource.id];\r\n    }\r\n    return this.getResource(event)?.cost;\r\n  }\r\n\r\n  getResource(event: CastEvent | HealEvent | EnergizeEvent ) {\r\n    if(!event.classResources) {\r\n      return undefined;\r\n    } else {\r\n      return event.classResources.find(r => r.type === this.resource.id);\r\n    }\r\n  }  \r\n\r\n  triggerSpendEvent(spent: number, event: CastEvent) {\r\n\r\n    const fabricatedEvent: SpendResourceEvent = {\r\n      type: EventType.SpendResource,\r\n      timestamp: event.timestamp,\r\n      sourceID: event.sourceID,\r\n      targetID: event.targetID,\r\n      resourceChange: spent,\r\n      resourceChangeType: this.resource.id,\r\n      ability: event.ability,\r\n      __fabricated: true,\r\n    };\r\n\r\n    this.eventEmitter.fabricateEvent(fabricatedEvent, event);\r\n  }\r\n\r\n  shouldProcessCastEvent(event: CastEvent) {\r\n    return Boolean(this.getResource(event));\r\n  }\r\n\r\n  getGeneratedBySpell(spellId: number) {\r\n    return (this.buildersObj[spellId] && this.buildersObj[spellId].generated) || 0;\r\n  }\r\n\r\n  getWastedBySpell(spellId: number) {\r\n    return (this.buildersObj[spellId] && this.buildersObj[spellId].wasted) || 0;\r\n  }\r\n\r\n  getBuilderCastsBySpell(spellId: number) {\r\n    return (this.buildersObj[spellId] && this.buildersObj[spellId].casts) || 0;\r\n  }\r\n\r\n  get generated() {\r\n    return Object.values(this.buildersObj).reduce((acc, spell) => acc + spell.generated, 0);\r\n  }\r\n\r\n  get wasted() {\r\n    return Object.values(this.buildersObj).reduce((acc, spell) => acc + spell.wasted, 0);\r\n  }\r\n\r\n  get spent() {\r\n    return Object.values(this.spendersObj).reduce((acc, spell) => acc + spell.spent, 0);\r\n  }\r\n\r\n  get spendersCasts() {\r\n    return Object.values(this.spendersObj).reduce((acc, spell) => acc + spell.casts, 0);\r\n  }\r\n}\r\n\r\nexport default ResourceTracker;\r\n","import React from 'react';\r\nimport RESOURCE_TYPES from 'game/RESOURCE_TYPES';\r\n\r\nimport ResourceLink from './ResourceLink';\r\nimport Icon from './Icon';\r\n\r\ninterface Props extends Omit<React.ComponentProps<typeof Icon>, 'id' | 'icon'> {\r\n  id: number;\r\n  noLink?: boolean;\r\n}\r\n\r\nconst ResourceIcon = ({ id, noLink, ...others }: Props) => {\r\n  if (process.env.NODE_ENV === 'development' && !RESOURCE_TYPES[id]) {\r\n    throw new Error(`Unknown spell: ${id}`);\r\n  }\r\n\r\n  const spell = RESOURCE_TYPES[id] || {\r\n    name: 'Spell not recognized',\r\n    icon: 'inv_misc_questionmark',\r\n  };\r\n\r\n  const icon = (\r\n    <Icon\r\n      icon={spell.icon}\r\n      alt={spell.name}\r\n      {...others}\r\n    />\r\n  );\r\n\r\n  if (noLink) {\r\n    return icon;\r\n  }\r\n\r\n  return (\r\n    <ResourceLink id={id} icon={false}>\r\n      {icon}\r\n    </ResourceLink>\r\n  );\r\n};\r\n\r\nexport default ResourceIcon;\r\n","import React, {useEffect, useState} from 'react';\r\n\r\nimport TooltipProvider from 'interface/common/TooltipProvider';\r\n\r\nimport RESOURCE_TYPES from 'game/RESOURCE_TYPES';\r\n\r\nimport ResourceIcon from './ResourceIcon';\r\n\r\ninterface Props {\r\n  id: number;\r\n  children?: React.ReactNode;\r\n  category?: string;\r\n  icon?: boolean,\r\n}\r\n\r\nconst ResourceLink = ({icon = true, ...props}: Props) => {\r\n\r\n  const [elem, setElem] = useState<HTMLAnchorElement | null>(null);\r\n\r\n  useEffect(() => {TooltipProvider.refresh(elem);})\r\n\r\n  const { id, children, category = undefined, ...other } = props;\r\n\r\n  if (process.env.NODE_ENV === 'development' && !children && !RESOURCE_TYPES[id]) {\r\n    throw new Error(`Unknown spell: ${id}`);\r\n  }\r\n\r\n  return (\r\n    <a\r\n      href={TooltipProvider.resource(id)}\r\n      target=\"_blank\"\r\n      rel=\"noopener noreferrer\"\r\n      className={category}\r\n      ref={elem => {setElem(elem);}}\r\n      {...other}\r\n    >\r\n      {icon && <ResourceIcon id={id} noLink />}{' '}\r\n      {children || RESOURCE_TYPES[id].name}\r\n    </a>\r\n  );\r\n}\r\n\r\nexport default ResourceLink;\r\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar ANIMATION_STATE_CLASSES = {\n  animating: 'rah-animating',\n  animatingUp: 'rah-animating--up',\n  animatingDown: 'rah-animating--down',\n  animatingToHeightZero: 'rah-animating--to-height-zero',\n  animatingToHeightAuto: 'rah-animating--to-height-auto',\n  animatingToHeightSpecific: 'rah-animating--to-height-specific',\n  static: 'rah-static',\n  staticHeightZero: 'rah-static--height-zero',\n  staticHeightAuto: 'rah-static--height-auto',\n  staticHeightSpecific: 'rah-static--height-specific'\n};\n\nvar PROPS_TO_OMIT = ['animateOpacity', 'animationStateClasses', 'applyInlineTransitions', 'children', 'contentClassName', 'delay', 'duration', 'easing', 'height', 'onAnimationEnd', 'onAnimationStart'];\n\nfunction omit(obj) {\n  for (var _len = arguments.length, keys = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    keys[_key - 1] = arguments[_key];\n  }\n\n  if (!keys.length) {\n    return obj;\n  }\n\n  var res = {};\n  var objectKeys = Object.keys(obj);\n\n  for (var i = 0; i < objectKeys.length; i++) {\n    var key = objectKeys[i];\n\n    if (keys.indexOf(key) === -1) {\n      res[key] = obj[key];\n    }\n  }\n\n  return res;\n}\n\n// Start animation helper using nested requestAnimationFrames\nfunction startAnimationHelper(callback) {\n  var requestAnimationFrameIDs = [];\n\n  requestAnimationFrameIDs[0] = requestAnimationFrame(function () {\n    requestAnimationFrameIDs[1] = requestAnimationFrame(function () {\n      callback();\n    });\n  });\n\n  return requestAnimationFrameIDs;\n}\n\nfunction cancelAnimationFrames(requestAnimationFrameIDs) {\n  requestAnimationFrameIDs.forEach(function (id) {\n    return cancelAnimationFrame(id);\n  });\n}\n\nfunction isNumber(n) {\n  return !isNaN(parseFloat(n)) && isFinite(n);\n}\n\nfunction isPercentage(height) {\n  // Percentage height\n  return typeof height === 'string' && height.search('%') === height.length - 1 && isNumber(height.substr(0, height.length - 1));\n}\n\nfunction runCallback(callback, params) {\n  if (callback && typeof callback === 'function') {\n    callback(params);\n  }\n}\n\nvar AnimateHeight = function (_React$Component) {\n  _inherits(AnimateHeight, _React$Component);\n\n  function AnimateHeight(props) {\n    _classCallCheck(this, AnimateHeight);\n\n    var _this = _possibleConstructorReturn(this, (AnimateHeight.__proto__ || Object.getPrototypeOf(AnimateHeight)).call(this, props));\n\n    _this.animationFrameIDs = [];\n\n    var height = 'auto';\n    var overflow = 'visible';\n\n    if (isNumber(props.height)) {\n      // If value is string \"0\" make sure we convert it to number 0\n      height = props.height < 0 || props.height === '0' ? 0 : props.height;\n      overflow = 'hidden';\n    } else if (isPercentage(props.height)) {\n      // If value is string \"0%\" make sure we convert it to number 0\n      height = props.height === '0%' ? 0 : props.height;\n      overflow = 'hidden';\n    }\n\n    _this.animationStateClasses = _extends({}, ANIMATION_STATE_CLASSES, props.animationStateClasses);\n\n    var animationStateClasses = _this.getStaticStateClasses(height);\n\n    _this.state = {\n      animationStateClasses: animationStateClasses,\n      height: height,\n      overflow: overflow,\n      shouldUseTransitions: false\n    };\n    return _this;\n  }\n\n  _createClass(AnimateHeight, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var height = this.state.height;\n\n      // Hide content if height is 0 (to prevent tabbing into it)\n      // Check for contentElement is added cause this would fail in tests (react-test-renderer)\n      // Read more here: https://github.com/Stanko/react-animate-height/issues/17\n\n      if (this.contentElement && this.contentElement.style) {\n        this.hideContent(height);\n      }\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      var _this2 = this;\n\n      var _props = this.props,\n          delay = _props.delay,\n          duration = _props.duration,\n          height = _props.height,\n          onAnimationEnd = _props.onAnimationEnd,\n          onAnimationStart = _props.onAnimationStart;\n\n      // Check if 'height' prop has changed\n\n      if (this.contentElement && height !== prevProps.height) {\n        var _cx;\n\n        // Remove display: none from the content div\n        // if it was hidden to prevent tabbing into it\n        this.showContent(prevState.height);\n\n        // Cache content height\n        this.contentElement.style.overflow = 'hidden';\n        var contentHeight = this.contentElement.offsetHeight;\n        this.contentElement.style.overflow = '';\n\n        // set total animation time\n        var totalDuration = duration + delay;\n\n        var newHeight = null;\n        var timeoutState = {\n          height: null, // it will be always set to either 'auto' or specific number\n          overflow: 'hidden'\n        };\n        var isCurrentHeightAuto = prevState.height === 'auto';\n\n        if (isNumber(height)) {\n          // If value is string \"0\" make sure we convert it to number 0\n          newHeight = height < 0 || height === '0' ? 0 : height;\n          timeoutState.height = newHeight;\n        } else if (isPercentage(height)) {\n          // If value is string \"0%\" make sure we convert it to number 0\n          newHeight = height === '0%' ? 0 : height;\n          timeoutState.height = newHeight;\n        } else {\n          // If not, animate to content height\n          // and then reset to auto\n          newHeight = contentHeight; // TODO solve contentHeight = 0\n          timeoutState.height = 'auto';\n          timeoutState.overflow = null;\n        }\n\n        if (isCurrentHeightAuto) {\n          // This is the height to be animated to\n          timeoutState.height = newHeight;\n\n          // If previous height was 'auto'\n          // set starting height explicitly to be able to use transition\n          newHeight = contentHeight;\n        }\n\n        // Animation classes\n        var animationStateClasses = (0, _classnames2.default)((_cx = {}, _defineProperty(_cx, this.animationStateClasses.animating, true), _defineProperty(_cx, this.animationStateClasses.animatingUp, prevProps.height === 'auto' || height < prevProps.height), _defineProperty(_cx, this.animationStateClasses.animatingDown, height === 'auto' || height > prevProps.height), _defineProperty(_cx, this.animationStateClasses.animatingToHeightZero, timeoutState.height === 0), _defineProperty(_cx, this.animationStateClasses.animatingToHeightAuto, timeoutState.height === 'auto'), _defineProperty(_cx, this.animationStateClasses.animatingToHeightSpecific, timeoutState.height > 0), _cx));\n\n        // Animation classes to be put after animation is complete\n        var timeoutAnimationStateClasses = this.getStaticStateClasses(timeoutState.height);\n\n        // Set starting height and animating classes\n        // We are safe to call set state as it will not trigger infinite loop\n        // because of the \"height !== prevProps.height\" check\n        this.setState({ // eslint-disable-line react/no-did-update-set-state\n          animationStateClasses: animationStateClasses,\n          height: newHeight,\n          overflow: 'hidden',\n          // When animating from 'auto' we first need to set fixed height\n          // that change should be animated\n          shouldUseTransitions: !isCurrentHeightAuto\n        });\n\n        // Clear timeouts\n        clearTimeout(this.timeoutID);\n        clearTimeout(this.animationClassesTimeoutID);\n\n        if (isCurrentHeightAuto) {\n          // When animating from 'auto' we use a short timeout to start animation\n          // after setting fixed height above\n          timeoutState.shouldUseTransitions = true;\n\n          cancelAnimationFrames(this.animationFrameIDs);\n          this.animationFrameIDs = startAnimationHelper(function () {\n            _this2.setState(timeoutState);\n\n            // ANIMATION STARTS, run a callback if it exists\n            runCallback(onAnimationStart, { newHeight: timeoutState.height });\n          });\n\n          // Set static classes and remove transitions when animation ends\n          this.animationClassesTimeoutID = setTimeout(function () {\n            _this2.setState({\n              animationStateClasses: timeoutAnimationStateClasses,\n              shouldUseTransitions: false\n            });\n\n            // ANIMATION ENDS\n            // Hide content if height is 0 (to prevent tabbing into it)\n            _this2.hideContent(timeoutState.height);\n            // Run a callback if it exists\n            runCallback(onAnimationEnd, { newHeight: timeoutState.height });\n          }, totalDuration);\n        } else {\n          // ANIMATION STARTS, run a callback if it exists\n          runCallback(onAnimationStart, { newHeight: newHeight });\n\n          // Set end height, classes and remove transitions when animation is complete\n          this.timeoutID = setTimeout(function () {\n            timeoutState.animationStateClasses = timeoutAnimationStateClasses;\n            timeoutState.shouldUseTransitions = false;\n\n            _this2.setState(timeoutState);\n\n            // ANIMATION ENDS\n            // If height is auto, don't hide the content\n            // (case when element is empty, therefore height is 0)\n            if (height !== 'auto') {\n              // Hide content if height is 0 (to prevent tabbing into it)\n              _this2.hideContent(newHeight); // TODO solve newHeight = 0\n            }\n            // Run a callback if it exists\n            runCallback(onAnimationEnd, { newHeight: newHeight });\n          }, totalDuration);\n        }\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      cancelAnimationFrames(this.animationFrameIDs);\n\n      clearTimeout(this.timeoutID);\n      clearTimeout(this.animationClassesTimeoutID);\n\n      this.timeoutID = null;\n      this.animationClassesTimeoutID = null;\n      this.animationStateClasses = null;\n    }\n  }, {\n    key: 'showContent',\n    value: function showContent(height) {\n      if (height === 0) {\n        this.contentElement.style.display = '';\n      }\n    }\n  }, {\n    key: 'hideContent',\n    value: function hideContent(newHeight) {\n      if (newHeight === 0) {\n        this.contentElement.style.display = 'none';\n      }\n    }\n  }, {\n    key: 'getStaticStateClasses',\n    value: function getStaticStateClasses(height) {\n      var _cx2;\n\n      return (0, _classnames2.default)((_cx2 = {}, _defineProperty(_cx2, this.animationStateClasses.static, true), _defineProperty(_cx2, this.animationStateClasses.staticHeightZero, height === 0), _defineProperty(_cx2, this.animationStateClasses.staticHeightSpecific, height > 0), _defineProperty(_cx2, this.animationStateClasses.staticHeightAuto, height === 'auto'), _cx2));\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _cx3,\n          _this3 = this;\n\n      var _props2 = this.props,\n          animateOpacity = _props2.animateOpacity,\n          applyInlineTransitions = _props2.applyInlineTransitions,\n          children = _props2.children,\n          className = _props2.className,\n          contentClassName = _props2.contentClassName,\n          delay = _props2.delay,\n          duration = _props2.duration,\n          easing = _props2.easing,\n          id = _props2.id,\n          style = _props2.style;\n      var _state = this.state,\n          height = _state.height,\n          overflow = _state.overflow,\n          animationStateClasses = _state.animationStateClasses,\n          shouldUseTransitions = _state.shouldUseTransitions;\n\n\n      var componentStyle = _extends({}, style, {\n        height: height,\n        overflow: overflow || style.overflow\n      });\n\n      if (shouldUseTransitions && applyInlineTransitions) {\n        componentStyle.transition = 'height ' + duration + 'ms ' + easing + ' ' + delay + 'ms';\n\n        // Include transition passed through styles\n        if (style.transition) {\n          componentStyle.transition = style.transition + ', ' + componentStyle.transition;\n        }\n\n        // Add webkit vendor prefix still used by opera, blackberry...\n        componentStyle.WebkitTransition = componentStyle.transition;\n      }\n\n      var contentStyle = {};\n\n      if (animateOpacity) {\n        contentStyle.transition = 'opacity ' + duration + 'ms ' + easing + ' ' + delay + 'ms';\n        // Add webkit vendor prefix still used by opera, blackberry...\n        contentStyle.WebkitTransition = contentStyle.transition;\n\n        if (height === 0) {\n          contentStyle.opacity = 0;\n        }\n      }\n\n      var componentClasses = (0, _classnames2.default)((_cx3 = {}, _defineProperty(_cx3, animationStateClasses, true), _defineProperty(_cx3, className, className), _cx3));\n\n      // Check if user passed aria-hidden prop\n      var hasAriaHiddenProp = typeof this.props['aria-hidden'] !== 'undefined';\n      var ariaHidden = hasAriaHiddenProp ? this.props['aria-hidden'] : height === 0;\n\n      return _react2.default.createElement(\n        'div',\n        _extends({}, omit.apply(undefined, [this.props].concat(PROPS_TO_OMIT)), {\n          'aria-hidden': ariaHidden,\n          className: componentClasses,\n          id: id,\n          style: componentStyle\n        }),\n        _react2.default.createElement(\n          'div',\n          {\n            className: contentClassName,\n            style: contentStyle,\n            ref: function ref(el) {\n              return _this3.contentElement = el;\n            }\n          },\n          children\n        )\n      );\n    }\n  }]);\n\n  return AnimateHeight;\n}(_react2.default.Component);\n\nvar heightPropType = function heightPropType(props, propName, componentName) {\n  var value = props[propName];\n\n  if (typeof value === 'number' && value >= 0 || isPercentage(value) || value === 'auto') {\n    return null;\n  }\n\n  return new TypeError('value \"' + value + '\" of type \"' + (typeof value === 'undefined' ? 'undefined' : _typeof(value)) + '\" is invalid type for ' + propName + ' in ' + componentName + '. ' + 'It needs to be a positive number, string \"auto\" or percentage string (e.g. \"15%\").');\n};\n\nAnimateHeight.propTypes = {\n  'aria-hidden': _propTypes2.default.bool,\n  animateOpacity: _propTypes2.default.bool,\n  animationStateClasses: _propTypes2.default.object,\n  applyInlineTransitions: _propTypes2.default.bool,\n  children: _propTypes2.default.any.isRequired,\n  className: _propTypes2.default.string,\n  contentClassName: _propTypes2.default.string,\n  delay: _propTypes2.default.number,\n  duration: _propTypes2.default.number,\n  easing: _propTypes2.default.string,\n  height: heightPropType,\n  id: _propTypes2.default.string,\n  onAnimationEnd: _propTypes2.default.func,\n  onAnimationStart: _propTypes2.default.func,\n  style: _propTypes2.default.object\n};\n\nAnimateHeight.defaultProps = {\n  animateOpacity: false,\n  animationStateClasses: ANIMATION_STATE_CLASSES,\n  applyInlineTransitions: true,\n  duration: 250,\n  delay: 0,\n  easing: 'ease',\n  style: {}\n};\n\nexports.default = AnimateHeight;","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport BaseChart from 'interface/others/BaseChart';\r\n\r\nimport { formatPercentage } from 'common/format';\r\nimport SpellLink from 'common/SpellLink';\r\nimport { TooltipElement } from 'common/Tooltip';\r\n\r\nimport './style.scss';\r\n\r\nclass DonutChart extends React.PureComponent {\r\n  static propTypes = {\r\n    items: PropTypes.arrayOf(PropTypes.shape({\r\n      value: PropTypes.number.isRequired,\r\n      label: PropTypes.node.isRequired,\r\n      color: PropTypes.string.isRequired,\r\n      tooltip: PropTypes.node,\r\n      spellId: PropTypes.number,\r\n      valueTooltip: PropTypes.node,\r\n    })).isRequired,\r\n    // While you could change the chart size, I strongly recommend you do not for consistency and to avoid breaking whenever this component is modified. Do you really need to adjust the size?\r\n    chartSize: PropTypes.number,\r\n    innerRadiusFactor: PropTypes.number,\r\n  };\r\n  static defaultProps = {\r\n    chartSize: 90,\r\n    innerRadiusFactor: 0.28,\r\n  };\r\n\r\n  renderLegend(items) {\r\n    const total = items.reduce((sum, item) => sum + item.value, 0);\r\n\r\n    return (\r\n      <div className=\"legend\">\r\n        {items.map(({ color, label, tooltip, value, spellId, valueTooltip }, index) => {\r\n          label = tooltip ? (\r\n            <TooltipElement content={tooltip}>{label}</TooltipElement>\r\n          ) : label;\r\n          label = spellId ? (\r\n            <SpellLink id={spellId}>{label}</SpellLink>\r\n          ) : label;\r\n          return (\r\n            <div key={index} className=\"flex\">\r\n              <div className=\"flex-sub\">\r\n                <div className=\"circle\" style={{ background: color }} />\r\n              </div>\r\n              <div className=\"flex-main\">\r\n                {label}\r\n              </div>\r\n              <div className=\"flex-sub\">\r\n                <TooltipElement content={valueTooltip ? valueTooltip : value}>\r\n                  {formatPercentage(value / total, 0)}%\r\n                </TooltipElement>\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  }\r\n  renderChart(items, chartSize, innerRadiusFactor) {\r\n    const innerRadius = chartSize * innerRadiusFactor;\r\n\r\n    const data = {\r\n      items,\r\n    };\r\n    const spec = {\r\n      data: {\r\n        name: 'items',\r\n      },\r\n      mark: {\r\n        type: 'arc',\r\n        innerRadius,\r\n      },\r\n      encoding: {\r\n        theta: {\r\n          field: 'value',\r\n          type: 'quantitative',\r\n        },\r\n        color: {\r\n          field: 'label',\r\n          type: 'nominal',\r\n          legend: null,\r\n          scale: {\r\n            domain: items.map(({label}) => label),\r\n            range: items.map(({color}) => color),\r\n          },\r\n        },\r\n      },\r\n      view: {\r\n        stroke: null,\r\n      },\r\n    };\r\n    return (\r\n      <div className=\"chart\">\r\n        <BaseChart\r\n          width={chartSize}\r\n          height={chartSize}\r\n          spec={spec}\r\n          data={data}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n  render() {\r\n    const { items, chartSize, innerRadiusFactor } = this.props;\r\n\r\n    return (\r\n      <div className=\"donut-chart\">\r\n        {this.renderLegend(items)}\r\n        {this.renderChart(items, chartSize, innerRadiusFactor)}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DonutChart;\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport { TooltipElement } from 'common/Tooltip';\r\n\r\nimport './StatisticBox.css';\r\nimport STATISTIC_CATEGORY from './STATISTIC_CATEGORY';\r\n\r\nexport { default as STATISTIC_ORDER } from './STATISTIC_ORDER';\r\n\r\n/**\r\n * @deprecated Use `interface/statistic/Statistic` instead.\r\n */\r\nconst StatisticsListBox = ({ title, tooltip, children, bodyStyle, ...others }) => {\r\n  delete others.category;\r\n  delete others.position;\r\n  return (\r\n    <div className=\"col-lg-3 col-md-4 col-sm-6 col-xs-12\">\r\n      <div className=\"panel statistic statistic-box statistic-box-list\" {...others}>\r\n        {title && (\r\n          <div className=\"panel-heading\">\r\n            <h2>{tooltip ? <TooltipElement content={tooltip}>{title}</TooltipElement> : title}</h2>\r\n          </div>\r\n        )}\r\n        <div className=\"panel-body items\" style={bodyStyle}>\r\n          {children}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nStatisticsListBox.propTypes = {\r\n  title: PropTypes.node,\r\n  children: PropTypes.node.isRequired,\r\n  tooltip: PropTypes.node,\r\n  bodyStyle: PropTypes.object,\r\n  category: PropTypes.string,\r\n  position: PropTypes.number,\r\n};\r\nStatisticsListBox.defaultProps = {\r\n  category: STATISTIC_CATEGORY.GENERAL,\r\n};\r\n\r\nexport default StatisticsListBox;\r\n","import Events, { ApplyBuffEvent, DamageEvent, FightEndEvent, RemoveBuffEvent } from 'parser/core/Events';\r\nimport Analyzer, { Options } from 'parser/core/Analyzer';\r\nimport { formatDuration } from 'common/format';\r\nimport calculateEffectiveDamage from 'parser/core/calculateEffectiveDamage';\r\nimport Spell from 'common/SPELLS/Spell';\r\nimport SpellUsable from 'parser/shared/modules/SpellUsable';\r\n\r\nconst debug = false;\r\n\r\nconst MS_BUFFER = 500;\r\n\r\nclass ExecuteHelper extends Analyzer {\r\n  static dependencies = {\r\n    spellUsable: SpellUsable,\r\n  };\r\n\r\n  protected spellUsable!: SpellUsable;\r\n\r\n  //region IMPLEMENTME statics\r\n  /**\r\n   * Array of objects from common/SPELLS\r\n   * This should contain any execute spells such as Kill Shot, Execute etc.\r\n   */\r\n  static executeSpells: Spell[] = [];\r\n\r\n  /**\r\n   * SELECTED_PLAYER or SELECTED_PLAYER_PET for usage in the eventfilter\r\n   */\r\n  static executeSources: number;\r\n\r\n  /**\r\n   * Array of objects from common/SPELLS\r\n   * This should contain any SPELLS object that allows execute to be used outside normal execute range\r\n   */\r\n  static executeOutsideRangeEnablers: Spell[] = [];\r\n\r\n  /**\r\n   * The lower threshold where execute is enabled, shown in decimals.\r\n   */\r\n  static lowerThreshold: number;\r\n\r\n  /**\r\n   * The upper threshold where an execute can be enabled immediately at a pull, shown in decimals.\r\n   */\r\n  static upperThreshold: number;\r\n\r\n  /**\r\n   * A boolean representing if the given execute modifies the damage of an existing spell.\r\n   * An execute spell should be labelled as false, whereas a talent that modifies an existing spell should be labelled as true.\r\n   */\r\n  static modifiesDamage: boolean;\r\n\r\n  /**\r\n   * represents the modifier of of a talent (or some other effect) that modifies the damage done by an existing spell\r\n   */\r\n  static damageModifier: number;\r\n  //endregion\r\n\r\n  //region Generic Variables\r\n  /**\r\n   * Is true if we're in an execute window either because of a buff giving access to execute spells or because of health windows\r\n   */\r\n  inExecuteWindow: boolean = false;\r\n\r\n  /**\r\n   * Is true if we're in an execute window due to health on a target, so a buff granting access to execute is pointless at this point\r\n   */\r\n  inHealthExecuteWindow: boolean = false;\r\n\r\n  /**\r\n   * A variable marking the timestamp of the start of the current execute window\r\n   */\r\n  executeWindowStart: number = 0;\r\n\r\n  /**\r\n   * A variable marking the timestamp of the last damage event within the execute window\r\n   */\r\n  lastExecuteHitTimestamp: number = 0;\r\n\r\n  /**\r\n   * The amount of time spent inside executewindows, either caused by health or by buffs giving access to execute\r\n   */\r\n  totalExecuteWindowDuration: number = 0;\r\n\r\n  /**\r\n   * Amount of damage done by the spells defined in executeSpells\r\n   */\r\n  damage: number = 0;\r\n\r\n  /**\r\n   * returns the total amount of casts of the executes listed in executeSpells\r\n   */\r\n  casts: number = 0;\r\n\r\n  /**\r\n   * returns the amount of casts of the executes listed in executeSpells that were cast whilst being in an execute window\r\n   */\r\n  castsWithExecute: number = 0;\r\n  //endregion\r\n\r\n  //region Execute helpers\r\n  /**\r\n   * Returns true if the event has less HP than the threshold.\r\n   * This is useful for any generic execute.\r\n   * @param event\r\n   */\r\n  isTargetInExecuteRange(event: DamageEvent) {\r\n    if (!event.hitPoints || !event.maxHitPoints) {\r\n      return false;\r\n    }\r\n    return (event.hitPoints / event.maxHitPoints) < this.lowerThreshold;\r\n  }\r\n\r\n  /**\r\n   * Returns true if the event has more HP than the threshold.\r\n   * This is useful for things like Firestarter and Flashpoint.\r\n   * @param event\r\n   */\r\n  isTargetInReverseExecuteRange(event: DamageEvent) {\r\n    if (!event.hitPoints || !event.maxHitPoints) {\r\n      return false;\r\n    }\r\n    return (event.hitPoints / event.maxHitPoints) > this.upperThreshold;\r\n  }\r\n\r\n  /**\r\n   * Returns true if either isTargetInExecuteRange() or isTargetInReverseExecuteRange() is true.\r\n   * @param event\r\n   */\r\n  isTargetInHealthExecuteWindow(event: DamageEvent) {\r\n    if (!event.hitPoints || !event.maxHitPoints) {\r\n      return false;\r\n    }\r\n    return (this.isTargetInExecuteRange(event) || this.isTargetInReverseExecuteRange(event));\r\n  }\r\n\r\n  /**\r\n   * Returns true if the combatant has one of the buffs that enable execute to be used outside of the regular execute windows\r\n   */\r\n  get isExecuteUsableOutsideExecuteRange() {\r\n    let usable: boolean = false;\r\n    this.executeOutsideRangeEnablers.forEach(spell => {\r\n      if (this.selectedCombatant.hasBuff(spell.id)) {\r\n        usable = true;\r\n      }\r\n    });\r\n    return usable;\r\n  }\r\n\r\n  /**\r\n   * If all execute spells are on cooldown, then we should count the entire period of cooldown as \"inside execute\" to properly calculate maxCasts\r\n   */\r\n  get areExecuteSpellsOnCD() {\r\n    let allOnCD: boolean = true;\r\n    this.executeSpells.forEach(spell => {\r\n      if (!this.spellUsable.isOnCooldown(spell.id)) {\r\n        allOnCD = false;\r\n      }\r\n    });\r\n    return allOnCD;\r\n  }\r\n\r\n  //endregion\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.addEventListener(Events.damage.by(this.executeSources), this.onGeneralDamage);\r\n    this.addEventListener(Events.cast.by(this.executeSources).spell(this.executeSpells), this.onExecuteCast);\r\n    this.addEventListener(Events.damage.by(this.executeSources).spell(this.executeSpells), this.onExecuteDamage);\r\n    this.addEventListener(Events.applybuff.to(this.executeSources).spell(this.executeOutsideRangeEnablers), this.applyExecuteEnablerBuff);\r\n    this.addEventListener(Events.removebuff.to(this.executeSources).spell(this.executeOutsideRangeEnablers), this.removeExecuteEnablerBuff);\r\n    this.addEventListener(Events.fightend, this.onFightEnd);\r\n  }\r\n\r\n  //region Static Getters\r\n  get executeSources() {\r\n    const ctor = this.constructor as typeof ExecuteHelper;\r\n    return ctor.executeSources;\r\n  }\r\n\r\n  get executeSpells() {\r\n    const ctor = this.constructor as typeof ExecuteHelper;\r\n    return ctor.executeSpells;\r\n  }\r\n\r\n  get executeOutsideRangeEnablers() {\r\n    const ctor = this.constructor as typeof ExecuteHelper;\r\n    return ctor.executeOutsideRangeEnablers;\r\n  }\r\n\r\n  get lowerThreshold() {\r\n    const ctor = this.constructor as typeof ExecuteHelper;\r\n    return ctor.lowerThreshold;\r\n  }\r\n\r\n  get upperThreshold() {\r\n    const ctor = this.constructor as typeof ExecuteHelper;\r\n    return ctor.upperThreshold;\r\n  }\r\n\r\n  get modifiesDamage() {\r\n    const ctor = this.constructor as typeof ExecuteHelper;\r\n    return ctor.modifiesDamage;\r\n  }\r\n\r\n  get damageModifier() {\r\n    const ctor = this.constructor as typeof ExecuteHelper;\r\n    return ctor.damageModifier;\r\n  }\r\n\r\n  //endregion\r\n\r\n  //region Generic Getters\r\n  get executeDamage() {\r\n    return this.damage;\r\n  }\r\n\r\n  get totalExecuteDuration() {\r\n    return this.totalExecuteWindowDuration;\r\n  }\r\n\r\n  get totalCasts() {\r\n    return this.casts;\r\n  }\r\n\r\n  get totalExecuteCasts() {\r\n    return this.castsWithExecute;\r\n  }\r\n\r\n  //endregion\r\n\r\n  //region Event Listener functions\r\n  onGeneralDamage(event: DamageEvent) {\r\n    if (event.targetIsFriendly) {\r\n      return;\r\n    }\r\n    if (this.areExecuteSpellsOnCD || this.isExecuteUsableOutsideExecuteRange || this.isTargetInHealthExecuteWindow(event)) {\r\n      this.lastExecuteHitTimestamp = event.timestamp;\r\n      if (!this.inExecuteWindow) {\r\n        this.inExecuteWindow = true;\r\n        this.inHealthExecuteWindow = true;\r\n        this.executeWindowStart = event.timestamp;\r\n        debug && console.log('Execute window started');\r\n      }\r\n    } else {\r\n      if (this.inExecuteWindow && event.timestamp > this.lastExecuteHitTimestamp + MS_BUFFER) {\r\n        this.inExecuteWindow = false;\r\n        this.inHealthExecuteWindow = false;\r\n        this.totalExecuteWindowDuration += event.timestamp - this.executeWindowStart;\r\n        debug && console.log('Execute window ended, current total: ', this.totalExecuteDuration);\r\n      }\r\n    }\r\n  }\r\n\r\n  onExecuteCast() {\r\n    this.casts += 1;\r\n    if (this.inExecuteWindow || this.inHealthExecuteWindow) {\r\n      this.castsWithExecute += 1;\r\n    }\r\n  }\r\n\r\n  onExecuteDamage(event: DamageEvent) {\r\n    if (this.inExecuteWindow || this.inHealthExecuteWindow) {\r\n      if (this.modifiesDamage) {\r\n        this.damage += calculateEffectiveDamage(event, this.damageModifier);\r\n      } else {\r\n        this.damage += event.amount + (event.absorbed || 0);\r\n      }\r\n    }\r\n  }\r\n\r\n  applyExecuteEnablerBuff(event: ApplyBuffEvent) {\r\n    if (!this.inExecuteWindow && !this.inHealthExecuteWindow) {\r\n      this.executeWindowStart = event.timestamp;\r\n    }\r\n    this.inExecuteWindow = true;\r\n    this.lastExecuteHitTimestamp = event.timestamp;\r\n    debug && console.log(event.ability.name, ' was applied starting the execute window');\r\n  }\r\n\r\n  removeExecuteEnablerBuff(event: RemoveBuffEvent) {\r\n    if (!this.inHealthExecuteWindow) {\r\n      this.inExecuteWindow = false;\r\n      this.totalExecuteWindowDuration += event.timestamp - this.executeWindowStart;\r\n      debug && console.log(event.ability.name, ' was removed ending the execute window, current total: ', this.totalExecuteDuration);\r\n    } else {\r\n      debug && console.log('Execute enabler buff ended, but inside execute health window so window still ongoing.');\r\n    }\r\n  }\r\n\r\n  onFightEnd(event: FightEndEvent) {\r\n    if (this.inExecuteWindow) {\r\n      this.totalExecuteWindowDuration += event.timestamp - this.executeWindowStart;\r\n      this.inExecuteWindow = false;\r\n    }\r\n    debug && console.log('Fight ended, total duration of execute: ' + this.totalExecuteDuration + ' | ' + formatDuration(this.totalExecuteDuration));\r\n  }\r\n\r\n  //endregion\r\n}\r\n\r\nexport default ExecuteHelper;\r\n","import RESOURCE_TYPES from 'game/RESOURCE_TYPES';\r\nimport ResourceTracker from 'parser/shared/modules/resources/resourcetracker/ResourceTracker';\r\nimport { Options } from 'parser/core/Analyzer';\r\n\r\nclass ManaTracker extends ResourceTracker {\r\n  constructor(options: Options) {\r\n    super(options);\r\n    this.resource = RESOURCE_TYPES.MANA;\r\n    this.maxResource = 50000;\r\n  }\r\n\r\n  maxResource: number;\r\n}\r\n\r\nexport default ManaTracker;\r\n","import AbilityTracker from 'parser/shared/modules/AbilityTracker';\r\nimport HealingDone from 'parser/shared/modules/throughput/HealingDone';\r\nimport DamageDone from 'parser/shared/modules/throughput/DamageDone';\r\nimport CastEfficiency from 'parser/shared/modules/CastEfficiency';\r\nimport CoreAbilities from 'parser/core/modules/Abilities';\r\nimport Analyzer from 'parser/core/Analyzer';\r\nimport SPELLS from 'common/SPELLS/index';\r\nimport Spell from 'common/SPELLS/Spell';\r\n\r\nimport ManaTracker from './ManaTracker';\r\nimport { SpellbookAbility } from '../modules/Ability';\r\n\r\nexport interface SpellInfoDetails {\r\n  spell: Spell;\r\n  casts: number;\r\n  healingHits: number;\r\n  healingDone: number;\r\n  overhealingDone: number;\r\n  damageHits: number;\r\n  damageDone: number;\r\n  damageAbsorbed: number;\r\n  manaSpent: number;\r\n  manaGained: ManaTracker;\r\n  percentOverhealingDone: number;\r\n  percentHealingDone: number;\r\n  percentDamageDone: number;\r\n  manaPercentSpent: number;\r\n  hpm: number;\r\n  dpm: number;\r\n  timeSpentCasting: number;\r\n  percentTimeSpentCasting: number;\r\n  hpet: number;\r\n  dpet: number;\r\n}\r\n\r\nclass HealingEfficiencyTracker extends Analyzer {\r\n  static dependencies = {\r\n    manaTracker: ManaTracker,\r\n    abilityTracker: AbilityTracker,\r\n    healingDone: HealingDone,\r\n    damageDone: DamageDone,\r\n    castEfficiency: CastEfficiency,\r\n    abilities: CoreAbilities,\r\n  };\r\n\r\n  protected manaTracker!: ManaTracker;\r\n  protected abilityTracker!: AbilityTracker;\r\n  protected healingDone!: HealingDone;\r\n  protected damageDone!: DamageDone;\r\n  protected castEfficiency!: CastEfficiency;\r\n  protected abilities!: CoreAbilities;\r\n\r\n  getSpellStats(spellId: number, healingSpellIds: number[] | null = null) {\r\n    let spellInfo: SpellInfoDetails = {\r\n      spell: SPELLS[spellId],\r\n      casts: 0,\r\n      healingHits: 0,\r\n      healingDone: 0,\r\n      overhealingDone: 0,\r\n      damageHits: 0,\r\n      damageDone: 0,\r\n      damageAbsorbed: 0,\r\n      manaSpent: 0,\r\n      manaGained: this.manaTracker,\r\n      percentOverhealingDone: 0,\r\n      percentHealingDone: 0,\r\n      percentDamageDone: 0,\r\n      manaPercentSpent: 0,\r\n      hpm: 0,\r\n      dpm: 0,\r\n      timeSpentCasting: 0,\r\n      percentTimeSpentCasting: 0,\r\n      hpet: 0,\r\n      dpet: 0,\r\n    };\r\n\r\n    const ability = this.abilityTracker.getAbility(spellId);\r\n\r\n    spellInfo.casts = ability.casts || 0;\r\n    spellInfo.healingHits = ability.healingHits || 0;\r\n    spellInfo.healingDone = (ability.healingEffective || 0) + (ability.healingAbsorbed || 0);\r\n    spellInfo.overhealingDone = ability.healingOverheal || 0;\r\n\r\n    if (healingSpellIds) {\r\n      for (const healingSpellId in healingSpellIds) {\r\n        const healingAbility = this.abilityTracker.getAbility(healingSpellIds[healingSpellId]);\r\n\r\n        spellInfo.healingHits += healingAbility.healingHits || 0;\r\n        spellInfo.healingDone += (healingAbility.healingEffective || 0) + (healingAbility.healingAbsorbed || 0);\r\n        spellInfo.overhealingDone += healingAbility.healingOverheal || 0;\r\n      }\r\n    }\r\n\r\n    spellInfo.damageHits = ability.damageHits || 0;\r\n    spellInfo.damageDone = ability.damageEffective || 0;\r\n    spellInfo.damageAbsorbed = ability.damageAbsorbed || 0;\r\n\r\n    const spenders = this.manaTracker.spendersObj as {\r\n      [spellId: number]: {\r\n        spent: number;\r\n        spentByCast: number[];\r\n        casts: number\r\n      }\r\n    };\r\n    spellInfo.manaSpent = spenders[spellId] ? spenders[spellId].spent : 0;\r\n\r\n    // All of the following information can be derived from the data in SpellInfo.\r\n    // Now we can add custom logic for spells.\r\n    spellInfo = this.getCustomSpellStats(spellInfo, spellId, healingSpellIds);\r\n\r\n    spellInfo.percentOverhealingDone = spellInfo.overhealingDone / ((spellInfo.healingDone || 0) + spellInfo.overhealingDone) || 0;\r\n    spellInfo.percentHealingDone = spellInfo.healingDone / this.healingDone.total.regular || 0;\r\n    spellInfo.percentDamageDone = spellInfo.damageDone / this.damageDone.total.regular || 0;\r\n    spellInfo.manaPercentSpent = spellInfo.manaSpent / this.manaTracker.spent;\r\n\r\n    spellInfo.hpm = (spellInfo.healingDone / spellInfo.manaSpent) | 0;\r\n    spellInfo.dpm = (spellInfo.damageDone / spellInfo.manaSpent) | 0;\r\n\r\n    spellInfo.timeSpentCasting = this.castEfficiency.getTimeSpentCasting(spellId).timeSpentCasting + this.castEfficiency.getTimeSpentCasting(spellId).gcdSpent;\r\n    spellInfo.percentTimeSpentCasting = spellInfo.timeSpentCasting / this.owner.fightDuration;\r\n\r\n    spellInfo.hpet = (spellInfo.healingDone / spellInfo.timeSpentCasting) | 0;\r\n    spellInfo.dpet = (spellInfo.damageDone / spellInfo.timeSpentCasting) | 0;\r\n\r\n    return spellInfo;\r\n  }\r\n\r\n  getCustomSpellStats(spellInfo: SpellInfoDetails, spellId: number, healingSpellIds: number[] | null) {\r\n    // Overwrite this function to add specific logic for spells.\r\n    return spellInfo;\r\n  }\r\n\r\n  getAllSpellStats(includeCooldowns = false) {\r\n    const spells: { [spellId: number]: SpellInfoDetails } = {};\r\n    let topHpm = 0;\r\n    let topDpm = 0;\r\n    let topHpet = 0;\r\n    let topDpet = 0;\r\n\r\n    for (const index in this.abilities.abilities) {\r\n      const ability = this.abilities.abilities[index] as unknown as SpellbookAbility;\r\n\r\n      if (ability.spell instanceof Array) {\r\n        continue;\r\n      }\r\n      if (ability.spell && ability.spell.manaCost && ability.spell.manaCost > 0) {\r\n        if (includeCooldowns || ability.category !== 'Cooldown') {\r\n          spells[ability.spell.id] = this.getSpellStats(ability.spell.id, ability.healSpellIds);\r\n\r\n          topHpm = Math.max(topHpm, spells[ability.spell.id].hpm);\r\n          topDpm = Math.max(topDpm, spells[ability.spell.id].dpm);\r\n          topHpet = Math.max(topHpet, spells[ability.spell.id].hpet);\r\n          topDpet = Math.max(topDpet, spells[ability.spell.id].dpet);\r\n        }\r\n      }\r\n    }\r\n\r\n    return {\r\n      spells,\r\n      topHpm,\r\n      topDpm,\r\n      topHpet,\r\n      topDpet,\r\n    };\r\n  }\r\n}\r\n\r\nexport default HealingEfficiencyTracker;\r\n","import React from 'react';\r\n\r\nimport colorForPerformance from 'common/colorForPerformance';\r\n\r\ninterface Props {\r\n  percent: number;\r\n}\r\n\r\nconst PerformanceBar = ({ percent }: Props) => (\r\n  <div className=\"performance-bar-container\">\r\n    <div\r\n      className=\"performance-bar\"\r\n      style={{\r\n        width: `${percent * 100}%`,\r\n        transition: 'background-color 800ms',\r\n        backgroundColor: colorForPerformance(percent),\r\n      }}\r\n    />\r\n  </div>\r\n);\r\n\r\nexport default PerformanceBar;\r\n","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEwAAAAuCAYAAACCq/96AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjEuNv1OCegAAAPKSURBVGhD7ZtLSBRxHMcttegQPYhKKCii94PeWVD0Lo+uVFoQRJck9BAF+WAJDS8FXUItzdVMzQ5ejO5B++jhW7e3eggCL+2641p0+Pf9zf5n3V3/7u6sO40j84EPiLM7/vbD/GcWdzaFMXYMZkV4Bm6EC1NMwgmJlDU+VNfs/179UvZbZbvUb20ZfXelxuvIqdRSPko0ymEVrIaP4GNYA2vhE24dtMF62ACfwkb4DDbBZtgCn3Nb4QsVBlBi+YdsjWPuuyxUaeAO83XfYF7XJYYXppkeh6WdjyPCCpnODsEAcqzhBltkLEU5Ws8tzaN57TltfKRQiqDoBfxvJ4KNDzdViUKFStGk3tuIlid+scnSbqFlolAARcPrYWiw+gZRpEiD0ZwXxC82CWJpOvhYRAkUDa+HE8H8n+89nBToY4VES0RTHZb+BIL9grR09TDAqNNS4uu+GR7s0/2vfLNmIE5RAsE6oL5QMBqWlpsZLA6UYF7neSb1lZrBYhEMRuKELkczg01NWDDSmcskd8UXvlkzZk8wGtyZ18U3a8bsCmbP0XwwwwbTCzOYSowcTJfBphGsUCeDGCmYXv6GQcxgsTWDqdQMplLDBvsLR3QyiJGCaT5XPJjBVGIGU4kug3k7rpWZwVQgucsfeF0XzWDx4h+sqR3tyA/7FMoMFgX/UL2N/rs7+v4qYp0zg8WCPm2XBsqY1FvMvG8vm8FiodyeQNGUWxGMHiwjijIjr7MzEnVssLZVDuYuZ1K/lfk6C5jHmeviuyYSmUtLg4gGi6WMcrKOJp2jKErwM0+BgaVZxPBW4wNjLI3vPpG5tHLiVgGgaTCSoolChSrfJdRX3INgi+Ec7H7GBlsOe6DogVMpI4ozlfFEG//RVoRYm+E87D6RubQyLBihdjgZUZho+jqvC0ORf36+siIU3dx3BK6Bc/EnZkq0ScEINcPJiKLE0tdVGC0WeRbugysgLc2ZEE0YTDWeN5b8yCAee46bb54ShNgBlUCRnoZ0lNHSXAQp2uwg0WAEQuyCkbHo6KJgR+EeuBou4E8xPtMJRiCGEo1CkcrPJ+EhuAkugan8KcZmusEIxNgPKdApqESj7wkoR9kqmM4fbmySFCwV7oSH4XFIsSgaLU363Va4FBr/XJaMYARipMMtMBPSkUWxKBoddQfgWmj8b6UkKxiBIGlwHdwN6SpJ0U7Ag5BiroTGvgB4XdmZHrulNFK+WTUIQsszA26HdLRRrL2QgtEVk95mzI7zWbJAkLlwGdwAt0E6h62HdPKnK+Z8qNP5LCXlH/EZJ5PjYeR7AAAAAElFTkSuQmCC\"","import React from 'react';\r\nimport { formatNumber, formatPercentage, formatDuration } from 'common/format';\r\nimport Toggle from 'react-toggle';\r\nimport PerformanceBar from 'interface/PerformanceBar';\r\nimport SpellLink from 'common/SpellLink';\r\nimport { TooltipElement } from 'common/Tooltip';\r\nimport HolyPriestHealingEfficiencyTracker from 'parser/priest/holy/modules/features/HolyPriestHealingEfficiencyTracker';\r\nimport { Trans } from '@lingui/macro';\r\n\r\nimport HealingEfficiencyTracker, { SpellInfoDetails } from './HealingEfficiencyTracker';\r\n\r\nexport interface Props {\r\n  tracker: HealingEfficiencyTracker | HolyPriestHealingEfficiencyTracker;\r\n}\r\nexport interface State {\r\n  showHealing: boolean;\r\n  detailedView: boolean;\r\n  showCooldowns: boolean;\r\n  showEchoOfLight?: boolean;\r\n}\r\n\r\nclass HealingEfficiencyBreakdown extends React.Component<Props, State> {\r\n  constructor(props: Props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      showHealing: true,\r\n      detailedView: false,\r\n      showCooldowns: false,\r\n    };\r\n  }\r\n\r\n  HealingEfficiencyTable = (props: Props) => {\r\n    const { tracker } = props;\r\n    const { spells, topHpm, topDpm, topHpet, topDpet } = tracker.getAllSpellStats(this.state.showCooldowns);\r\n\r\n    const spellArray = Object.values(spells);\r\n\r\n    spellArray.sort((a, b) => {\r\n      if (this.state.showHealing) {\r\n        if (a.hpm < b.hpm) {\r\n          return 1;\r\n        } else if (a.hpm > b.hpm) {\r\n          return -1;\r\n        }\r\n      } else {\r\n        if (a.dpm < b.dpm) {\r\n          return 1;\r\n        } else if (a.dpm > b.dpm) {\r\n          return -1;\r\n        }\r\n      }\r\n\r\n      return 0;\r\n    });\r\n\r\n    const spellRows = spellArray.map((spellDetail => {\r\n      if (spellDetail.casts > 0) {\r\n        return this.HealingEfficiencySpellRow(spellDetail, topHpm, topDpm, topHpet, topDpet);\r\n      }\r\n      return null;\r\n    }));\r\n\r\n    return <>{spellRows}</>;\r\n  };\r\n\r\n  HealingEfficiencySpellRow = (spellDetail: SpellInfoDetails, topHpm: number, topDpm: number, topHpet: number, topDpet: number) => (\r\n    <tr key={spellDetail.spell.id}>\r\n      <td>\r\n        <SpellLink id={spellDetail.spell.id} />\r\n      </td>\r\n      {this.state.detailedView ? this.DetailView(spellDetail) : this.BarView(spellDetail, topHpm, topDpm, topHpet, topDpet)}\r\n    </tr>\r\n  );\r\n\r\n  BarHeader = () => (\r\n    <>\r\n      <Trans render=\"th\" id=\"shared.healingEfficiency.tableHeader.manaSpent\">Mana Spent</Trans>\r\n      {this.state.showHealing && (\r\n        <>\r\n          <th colSpan={2} className=\"text-center\"><Trans id=\"common.stat.healingPerMana\">Healing per mana spent</Trans></th>\r\n          <th colSpan={2} className=\"text-center\">\r\n            <TooltipElement content={<Trans id=\"common.stat.healingPerExecutionTime.long\">Healing per second spent casting the spell, including GCD wait time.</Trans>}>\r\n              <Trans id=\"common.stat.healingPerExecutionTime\">Healing per second spent casting</Trans>\r\n            </TooltipElement>\r\n          </th>\r\n        </>\r\n      )}\r\n      {!this.state.showHealing && (\r\n        <>\r\n          <th colSpan={2} className=\"text-center\"><Trans id=\"common.stat.damagePerMana\">Damage per mana spent</Trans></th>\r\n          <th colSpan={2} className=\"text-center\"><Trans id=\"common.stat.damagePerExecutionTime.long\">Damage per second spent casting the spell</Trans></th>\r\n        </>\r\n      )}\r\n    </>\r\n  );\r\n\r\n\r\n  BarView = (spellDetail: SpellInfoDetails, topHpm: number, topDpm: number, topHpet: number, topDpet: number) => {\r\n    const hasHealing = spellDetail.healingDone;\r\n    const hasDamage = spellDetail.damageDone > 0;\r\n    const barWidth = 20;\r\n\r\n    return (\r\n      <>\r\n        <td>\r\n          {formatNumber(spellDetail.manaSpent)}\r\n          {' (' + formatPercentage(spellDetail.manaPercentSpent) + '%)'}\r\n        </td>\r\n        {this.state.showHealing && (\r\n          <>\r\n            <td className=\"text-right\">{hasHealing ? formatNumber(spellDetail.hpm) : '-'}</td>\r\n            <td width={barWidth + '%'}><PerformanceBar percent={spellDetail.hpm / topHpm} /></td>\r\n\r\n            <td className=\"text-right\">{hasHealing ? formatNumber(spellDetail.hpet * 1000) : '-'}</td>\r\n            <td width={barWidth + '%'}><PerformanceBar percent={(spellDetail.hpet / topHpet)} /></td>\r\n          </>\r\n        )}\r\n        {!this.state.showHealing && (\r\n          <>\r\n            <td className=\"text-right\">{hasDamage ? formatNumber(spellDetail.dpm) : '-'}</td>\r\n            <td width={barWidth + '%'}><PerformanceBar percent={spellDetail.dpm / topDpm} /></td>\r\n\r\n            <td className=\"text-right\">{hasDamage ? formatNumber(spellDetail.dpet * 1000) : '-'}</td>\r\n            <td width={barWidth + '%'}><PerformanceBar percent={(spellDetail.dpet / topDpet)} /></td>\r\n          </>\r\n        )}\r\n      </>\r\n    );\r\n  };\r\n\r\n  DetailHeader = () => (\r\n    <>\r\n      <th>\r\n        <TooltipElement content={<Trans id=\"shared.healingEfficiency.tableHeader.casts.tooltip\">Total Casts (Number of targets hit)</Trans>}><Trans id=\"shared.healingEfficiency.tableHeader.casts\">Casts</Trans></TooltipElement>\r\n      </th>\r\n      <Trans render=\"th\" id=\"shared.healingEfficiency.tableHeader.manaSpent\">Mana Spent</Trans>\r\n      <Trans render=\"th\" id=\"shared.healingEfficiency.tableHeader.timeSpent\">Time Spent</Trans>\r\n      {this.state.showHealing && (\r\n        <>\r\n          <Trans render=\"th\" id=\"shared.healingEfficiency.tableHeader.healingDone\">Healing Done</Trans>\r\n          <Trans render=\"th\" id=\"shared.healingEfficiency.tableHeader.overhealingDone\">Overhealing</Trans>\r\n          <th>\r\n            <TooltipElement content={<Trans id=\"common.stat.healingPerMana.long\">Healing per mana spent casting the spell</Trans>}>\r\n              <Trans id=\"common.stat.healingPerMana.short\">HPM</Trans>\r\n            </TooltipElement>\r\n          </th>\r\n          <th>\r\n            <TooltipElement content={<Trans id=\"common.stat.healingPerExecutionTime.long\">Healing per second spent casting the spell, including GCD wait time.</Trans>}>\r\n              <Trans id=\"common.stat.healingPerExecutionTime.short\">HPET</Trans>\r\n            </TooltipElement>\r\n          </th>\r\n        </>\r\n      )}\r\n      {!this.state.showHealing && (\r\n        <>\r\n          <Trans render=\"th\" id=\"shared.healingEfficiency.tableHeader.damageDone\">Damage Done</Trans>\r\n          <th>\r\n            <TooltipElement content={<Trans id=\"common.stat.damagePerMana.long\">Damage per mana spent casting the spell</Trans>}>\r\n              <Trans id=\"common.stat.damagePerMana.short\">DPM</Trans>\r\n            </TooltipElement>\r\n          </th>\r\n          <th>\r\n            <TooltipElement content={<Trans id=\"common.stat.damagePerExecutionTime.long\">Damage per second spent casting the spell</Trans>}>\r\n              <Trans id=\"common.stat.damagePerExecutionTime.short\">DPET</Trans>\r\n            </TooltipElement>\r\n          </th>\r\n        </>\r\n      )}\r\n    </>\r\n  );\r\n\r\n  DetailView = (spellDetail: SpellInfoDetails) => {\r\n    const hasHealing = spellDetail.healingDone;\r\n    const hasOverhealing = spellDetail.healingDone > 0 || spellDetail.overhealingDone > 0;\r\n    const hasDamage = spellDetail.damageDone > 0;\r\n\r\n    return (\r\n      <>\r\n        <td>{spellDetail.casts} ({this.state.showHealing ? Math.floor(spellDetail.healingHits) : Math.floor(spellDetail.damageHits)})</td>\r\n        <td>\r\n          {formatNumber(spellDetail.manaSpent)}\r\n          {' (' + formatPercentage(spellDetail.manaPercentSpent) + '%)'}\r\n        </td>\r\n        <td>{spellDetail.timeSpentCasting !== 0 ? (formatDuration(spellDetail.timeSpentCasting / 1000) + ' (' + formatPercentage(spellDetail.percentTimeSpentCasting) + '%)') : '-'}</td>\r\n        {this.state.showHealing && (\r\n          <>\r\n            <td>\r\n              {hasHealing ? formatNumber(spellDetail.healingDone) : '-'}\r\n              {hasHealing ? ' (' + formatPercentage(spellDetail.percentHealingDone) + '%)' : ''}\r\n            </td>\r\n            <td>\r\n              {hasOverhealing ? formatNumber(spellDetail.overhealingDone) : '-'}\r\n              {hasOverhealing ? ' (' + formatPercentage(spellDetail.percentOverhealingDone) + '%)' : ''}\r\n            </td>\r\n            <td>{hasHealing ? formatNumber(spellDetail.hpm) : '-'}</td>\r\n            <td>{hasHealing ? formatNumber(spellDetail.hpet * 1000) : '-'}</td>\r\n          </>\r\n        )}\r\n        {!this.state.showHealing && (\r\n          <>\r\n            <td>\r\n              {hasDamage ? formatNumber(spellDetail.damageDone) : '-'}\r\n              {hasDamage ? ' (' + formatPercentage(spellDetail.percentDamageDone) + '%)' : ''}\r\n            </td>\r\n            <td>{hasDamage ? formatNumber(spellDetail.dpm) : '-'}</td>\r\n            <td>{hasDamage ? formatNumber(spellDetail.dpet * 1000) : '-'}</td>\r\n          </>\r\n        )}\r\n      </>\r\n    );\r\n  };\r\n\r\n  render() {\r\n    const { tracker } = this.props;\r\n\r\n    return (\r\n      <>\r\n        <div className=\"pad\">\r\n          <div className=\"pull-left\">\r\n            <div className=\"toggle-control pull-right\" style={{ marginRight: '.5em' }}>\r\n              <Toggle\r\n                defaultChecked={false}\r\n                icons={false}\r\n                onChange={event => this.setState({ detailedView: event.target.checked })}\r\n                id=\"detailed-toggle\"\r\n              />\r\n              <label htmlFor=\"detailed-toggle\" style={{ marginLeft: '0.5em' }}>\r\n                <Trans id=\"shared.healingEfficiency.toggle.detailed\">Detailed View</Trans>\r\n              </label>\r\n            </div>\r\n          </div>\r\n          <div className=\"pull-right\">\r\n            <div className=\"toggle-control pull-left\" style={{ marginLeft: '.5em', marginRight: '.5em' }}>\r\n              <Toggle\r\n                defaultChecked={false}\r\n                icons={false}\r\n                onChange={event => this.setState({ showCooldowns: event.target.checked })}\r\n                id=\"cooldown-toggle\"\r\n              />\r\n              <label htmlFor=\"cooldown-toggle\" style={{ marginLeft: '0.5em' }}>\r\n                <Trans id=\"shared.healingEfficiency.toggle.cooldowns\">Show Cooldowns</Trans>\r\n              </label>\r\n            </div>\r\n            <div className=\"toggle-control pull-left\" style={{ marginLeft: '.5em' }}>\r\n              <label htmlFor=\"healing-toggle\" style={{ marginLeft: '0.5em', marginRight: '1em' }}>\r\n                <Trans id=\"shared.healingEfficiency.toggle.damage\">Show Damage</Trans>\r\n              </label>\r\n              <Toggle\r\n                defaultChecked\r\n                icons={false}\r\n                onChange={event => this.setState({ showHealing: event.target.checked })}\r\n                id=\"healing-toggle\"\r\n              />\r\n              <label htmlFor=\"healing-toggle\" style={{ marginLeft: '0.5em' }}>\r\n                <Trans id=\"shared.healingEfficiency.toggle.healing\">Show Healing</Trans>\r\n              </label>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <table className=\"data-table\">\r\n          <thead>\r\n            <tr>\r\n              <Trans render=\"th\" id=\"common.ability\">Ability</Trans>\r\n              {this.state.detailedView ? <this.DetailHeader /> : <this.BarHeader />}\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <this.HealingEfficiencyTable tracker={tracker} />\r\n          </tbody>\r\n        </table>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default HealingEfficiencyBreakdown;\r\n","/**\r\n * @deprecated Use `interface/statistic/StatisticGroup` instead.\r\n */\r\nconst StatisticWrapper = props => props.children;\r\n\r\nexport default StatisticWrapper;\r\n","import SPELLS from 'common/SPELLS/index';\r\n\r\n/*\r\n * Fields:\r\n * int: spell scales with Intellect\r\n * crit: spell scales with (is able to or procced from) Critical Strike\r\n * hasteHpm: spell does more healing due to Haste, e.g. HoTs that gain more ticks\r\n * hasteHpct: spell can be cast more frequently due to Haste, basically any spell except for non haste scaling CDs\r\n * mastery: spell is boosted by Mastery\r\n * masteryStack: spell's HoT counts as a Mastery Stack\r\n * vers: spell scales with Versatility\r\n * multiplier: spell scales with whatever procs it, should be ignored for purpose of weights and for 'total healing' number\r\n * ignored: spell should be ignored for purpose of stat weights\r\n */\r\n\r\n// This only works with actual healing events; casts are not recognized.\r\nexport default {\r\n  [SPELLS.LEECH.id]: { // procs a percent of all your healing, so we ignore for weights and total healing\r\n    multiplier: true,\r\n  },\r\n  [SPELLS.HEALTHSTONE.id]: {\r\n    int: false,\r\n    crit: false,\r\n    hasteHpct: false,\r\n    mastery: false,\r\n    vers: true, // confirmed\r\n  },\r\n  [SPELLS.MARK_OF_THE_ANCIENT_PRIESTESS.id]: {\r\n    int: false,\r\n    crit: true,\r\n    hasteHpct: false,\r\n    mastery: false,\r\n    vers: true,\r\n  },\r\n};\r\n","import React from 'react';\r\n\r\nimport InformationIcon from 'interface/icons/Information';\r\n\r\nimport SPELLS from 'common/SPELLS/index';\r\nimport Tooltip, { TooltipElement } from 'common/Tooltip';\r\nimport { formatNumber } from 'common/format';\r\nimport { calculatePrimaryStat, calculateSecondaryStatDefault } from 'common/stats';\r\nimport Analyzer, { SELECTED_PLAYER, SELECTED_PLAYER_PET } from 'parser/core/Analyzer';\r\nimport Events, { EventType } from 'parser/core/Events';\r\nimport HIT_TYPES from 'game/HIT_TYPES';\r\nimport HealingValue from 'parser/shared/modules/HealingValue';\r\nimport DamageValue from 'parser/shared/modules/DamageValue';\r\nimport CritEffectBonus from 'parser/shared/modules/helpers/CritEffectBonus';\r\nimport StatTracker from 'parser/shared/modules/StatTracker';\r\nimport { STATISTIC_ORDER } from 'interface/others/StatisticBox';\r\nimport StatisticWrapper from 'interface/others/StatisticWrapper';\r\nimport InfoIcon from 'interface/icons/Info';\r\nimport { Trans } from '@lingui/macro';\r\n\r\nimport CORE_SPELL_INFO from './SpellInfo';\r\nimport STAT, { getClassNameColor, getIcon, getName, getNameTranslated } from './STAT';\r\nimport QELiveLogo from './images/QE-Logo-New-Small.png';\r\n\r\nconst DEBUG = false;\r\n\r\n/**\r\n * This is currently completely focussed on Healer stat weights but it should be relatively easy to modify it to work for a DPS, it just requires some work. The only reason no effort was put towards this is that we currently have no DPS interested in implementing this so it would be wasted time. If you do want to implement stat weights for a DPS this should provide you with a very good basis.\r\n * @property {CritEffectBonus} critEffectBonus\r\n * @property {StatTracker} statTracker\r\n */\r\nclass BaseHealerStatValues extends Analyzer {\r\n  static dependencies = {\r\n    critEffectBonus: CritEffectBonus,\r\n    statTracker: StatTracker,\r\n  };\r\n\r\n  /**\r\n   * QE Live Link Setter\r\n   * As of right now this is only enabled for MW, Resto Druid, and Holy Pally\r\n   * Unless you talk to Voulk, the creator of QElive, Do not flip the switch for other healers\r\n   */\r\n  qeLive = false;\r\n\r\n  // region Spell info\r\n\r\n  // We assume unlisted spells scale with vers only (this will mostly be trinkets)\r\n  fallbackSpellInfo = {\r\n    int: false,\r\n    crit: true,\r\n    hasteHpm: false,\r\n    hasteHpct: false,\r\n    mastery: false,\r\n    vers: true,\r\n  };\r\n  // This will contain shared settings for things like trinkets and Leech\r\n  sharedSpellInfo = CORE_SPELL_INFO;\r\n  // This is for spec specific implementations to override. It gets priority over defaultSpellInfo.\r\n  spellInfo = {};\r\n\r\n  mentioned = [];\r\n  _getSpellInfo(event) {\r\n    const spellId = event.ability.guid;\r\n\r\n    const specSpecific = this.spellInfo[spellId];\r\n    if (specSpecific) {\r\n      return specSpecific;\r\n    }\r\n    const shared = this.sharedSpellInfo[spellId];\r\n    if (shared) {\r\n      return shared;\r\n    }\r\n\r\n    if (process.env.NODE_ENV === 'development') {\r\n      if (!this.mentioned.includes(spellId)) {\r\n        console.warn(`Missing spell definition: ${spellId}: ${event.ability.name}, using fallback:`, this.fallbackSpellInfo);\r\n        this.mentioned.push(spellId);\r\n      }\r\n    }\r\n\r\n    return this.fallbackSpellInfo;\r\n  }\r\n\r\n  // endregion\r\n\r\n  totalAdjustedHealing = 0; // total healing after excluding 'multiplier' spells like Leech / Velens\r\n\r\n  // These are the total healing that would be gained if their respective stats ratings were increased by one.\r\n  totalOneInt = 0;\r\n  totalOneCrit = 0;\r\n  totalOneHasteHpct = 0;\r\n  totalOneHasteHpm = 0;\r\n  totalOneMastery = 0;\r\n  totalOneVers = 0; // from healing increase only\r\n  totalOneVersDr = 0; // from damage reduced only\r\n  totalOneLeech = 0;\r\n\r\n  playerHealthMissing = 0;\r\n\r\n  scaleWeightsWithHealth = false;\r\n\r\n  constructor(options){\r\n    super(options);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER), this.onHeal);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER_PET), this.onHeal);\r\n    this.addEventListener(Events.absorbed.by(SELECTED_PLAYER), this.onAbsorb);\r\n    this.addEventListener(Events.absorbed.by(SELECTED_PLAYER_PET), this.onAbsorb);\r\n    this.addEventListener(Events.removebuff.by(SELECTED_PLAYER), this.onRemoveBuff);\r\n    this.addEventListener(Events.removebuff.by(SELECTED_PLAYER_PET), this.onRemoveBuff);\r\n    this.addEventListener(Events.heal.to(SELECTED_PLAYER), this.onHealTaken);\r\n    this.addEventListener(Events.damage.to(SELECTED_PLAYER), this.onDamageTaken);\r\n    this.addEventListener(Events.fightend, this.onFightend);\r\n  }\r\n\r\n  onHeal(event) {\r\n    const healVal = new HealingValue(event.amount, event.absorbed, event.overheal);\r\n    this._handleHealEvent(event, healVal);\r\n  }\r\n  onAbsorb(event) {\r\n    const healVal = new HealingValue(event.amount, 0, 0);\r\n    this._handleHealEvent(event, healVal);\r\n  }\r\n  onRemoveBuff(event) {\r\n    if (event.absorb) {\r\n      const healVal = new HealingValue(0, 0, event.absorb);\r\n      this._handleHealEvent(event, healVal);\r\n    }\r\n  }\r\n  _handleHealEvent(event, healVal) {\r\n    const spellInfo = this._getSpellInfo(event);\r\n    const targetHealthPercentage = (event.hitPoints - healVal.effective) / event.maxHitPoints; // hitPoints contains HP *after* the heal\r\n    this._handleHeal(spellInfo, event, healVal, targetHealthPercentage);\r\n  }\r\n  /**\r\n   * This actually does that stat weights calculations.\r\n   * @param spellInfo An object containing information about how to treat the spell, like on what stats it scales.\r\n   * @param eventForWeights The event that uses the stats to scale its healing. If we're tracking a multiplier (like Beacons), this should be the source of the multiplier.\r\n   * @param {HealingValue} healVal The actual healing done, all child weight calculators should use this instead of the event data as that might be for another event.\r\n   * @param targetHealthPercentage The percentage of health the target has remaining BEFORE the heal.\r\n   * @private\r\n   */\r\n  _handleHeal(spellInfo, eventForWeights, healVal, targetHealthPercentage) {\r\n    // Most spells are counted in healing total, but some spells scale not on their own but 'second hand' from other spells\r\n    // I adjust them out of total healing to preserve some accuracy in the \"Rating per 1%\" stat.\r\n    // Good examples of multiplier spells are Leech and Velens.\r\n    if (!spellInfo.multiplier) {\r\n      this.totalAdjustedHealing += this._adjustGain(healVal.effective, targetHealthPercentage);\r\n    }\r\n\r\n    if (spellInfo.ignored) {\r\n      return;\r\n    }\r\n\r\n    this.totalOneLeech += this._adjustGain(this._leech(eventForWeights, healVal, spellInfo), targetHealthPercentage);\r\n\r\n    if (spellInfo.multiplier) {\r\n      // Multiplier spells aren't counted for weights because they don't **directly** benefit from stat weights\r\n      return;\r\n    }\r\n\r\n    if (spellInfo.int) {\r\n      this.totalOneInt += this._adjustGain(this._intellect(eventForWeights, healVal), targetHealthPercentage);\r\n    }\r\n    if (spellInfo.crit) {\r\n      this.totalOneCrit += this._adjustGain(this._criticalStrike(eventForWeights, healVal), targetHealthPercentage);\r\n    }\r\n    if (spellInfo.hasteHpct) {\r\n      this.totalOneHasteHpct += this._adjustGain(this._hasteHpct(eventForWeights, healVal), targetHealthPercentage);\r\n    }\r\n    if (spellInfo.hasteHpm) {\r\n      this.totalOneHasteHpm += this._adjustGain(this._hasteHpm(eventForWeights, healVal), targetHealthPercentage);\r\n    }\r\n    if (spellInfo.mastery) {\r\n      this.totalOneMastery += this._adjustGain(this._mastery(eventForWeights, healVal), targetHealthPercentage);\r\n    }\r\n    if (spellInfo.vers) {\r\n      this.totalOneVers += this._adjustGain(this._versatility(eventForWeights, healVal), targetHealthPercentage);\r\n    }\r\n  }\r\n  _adjustGain(gain, targetHealthPercentage) {\r\n    if (gain === 0) {\r\n      return 0;\r\n    }\r\n    // We want 0-20% health to get value gain, and then linearly decay to 100% health\r\n    const maxValueHealthPercentage = 0.3;\r\n    const mult = 1 - Math.max(0, (targetHealthPercentage - maxValueHealthPercentage) / (1 - maxValueHealthPercentage));\r\n    return this.scaleWeightsWithHealth ? gain * mult : gain;\r\n  }\r\n  _leech(event, healVal, spellInfo) {\r\n    if (event.type !== EventType.Heal) {\r\n      return 0; // leech doesn't proc from absorbs\r\n    }\r\n\r\n    // We have to calculate leech weight differently depending on if we already have any leech rating.\r\n    // Leech is marked as a 'multplier' heal, so we have to check it before we do the early return below\r\n    const hasLeech = this.statTracker.currentLeechPercentage > 0;\r\n    if (hasLeech) {\r\n      return this._leechHasLeech(event, healVal, spellInfo);\r\n    } else {\r\n      return this._leechPrediction(event, healVal, spellInfo);\r\n    }\r\n  }\r\n  _leechHasLeech(event, healVal/*, spellInfo*/) {\r\n    // When the user has Leech we can use the actual Leech healing to accuractely calculate its HPS value without having to do any kind of predicting\r\n    const spellId = event.ability.guid;\r\n    if (spellId !== SPELLS.LEECH.id) {\r\n      return 0;\r\n    }\r\n    if (!healVal.overheal) {\r\n      return healVal.effective / this.statTracker.currentLeechRating; // TODO: Make a generic method to account for base percentage\r\n    }\r\n    return 0;\r\n  }\r\n  _leechPrediction(event, healVal, spellInfo) {\r\n    // Without Leech we will have to make an estimation so we can still provide the user with a decent value\r\n    if (this.owner.toPlayer(event)) {\r\n      return 0; // Leech doesn't proc from self-healing\r\n    }\r\n    if (spellInfo.multiplier) {\r\n      return 0; // Leech doesn't proc from multipliers such as Velen's Future Sight\r\n    }\r\n    if (this.playerHealthMissing > 0) { // if the player is full HP this would have overhealed.\r\n      const healIncreaseFromOneLeech = this.statTracker.statMultiplier.leech / this.statTracker.ratingNeededForNextPercentage(this.statTracker.currentLeechRating, this.statTracker.statBaselineRatingPerPercent[STAT.LEECH], 1, false);\r\n      return healVal.raw * healIncreaseFromOneLeech;\r\n    }\r\n    return 0;\r\n  }\r\n  _intellect(event, healVal) {\r\n    if (healVal.overheal) {\r\n      // If a spell overheals, it could not have healed for more. Seeing as Int only adds HP on top of the existing heal we can skip it as increasing the power of this heal would only be more overhealing.\r\n      return 0;\r\n    }\r\n    const healIncreaseFromOneInt = this.statTracker.statMultiplier.intellect / this.statTracker.currentIntellectRating;\r\n    return healVal.effective * healIncreaseFromOneInt;\r\n  }\r\n  _getCritChance(event) {\r\n    const rating = this.statTracker.currentCritRating;\r\n    const baseCritChance = this.statTracker.baseCritPercentage;\r\n    const ratingCritChance = rating / this.statTracker.ratingNeededForNextPercentage(this.statTracker.currentCritRating, this.statTracker.statBaselineRatingPerPercent[STAT.CRITICAL_STRIKE]);\r\n\r\n    return { baseCritChance, ratingCritChance };\r\n  }\r\n  _isCrit(event) {\r\n    return event.hitType === HIT_TYPES.CRIT;\r\n  }\r\n  _criticalStrike(event, healVal) {\r\n    if (this._isCrit(event)) {\r\n      // This collects the total effective healing contributed by the last 1 point of critical strike rating.\r\n      // We don't make any predictions on normal hits based on crit chance since this would be guess work and we are a log analysis system so we prefer to only work with facts. Actual crit heals are undeniable facts, unlike speculating the chance a normal hit might have crit (and accounting for the potential overhealing of that).\r\n\r\n      const { baseCritChance, ratingCritChance } = this._getCritChance(event);\r\n\r\n      const totalCritChance = baseCritChance + ratingCritChance;\r\n      if (totalCritChance > (1 + 1 / this.statTracker.ratingNeededForNextPercentage(this.statTracker.currentCritRating, this.statTracker.statBaselineRatingPerPercent[STAT.CRITICAL_STRIKE]))) {\r\n        // If the crit chance was more than 100%+1 rating, then the last rating was over the cap and worth 0.\r\n        return 0;\r\n      }\r\n      const ratingCritChanceContribution = 1 - baseCritChance / totalCritChance;\r\n\r\n      const critMult = this.critEffectBonus.getBonus(event);\r\n      const rawBaseHealing = healVal.raw / critMult;\r\n      const effectiveCritHealing = Math.max(0, healVal.effective - rawBaseHealing);\r\n      const rating = this.statTracker.currentCritRating;\r\n      const healIncreaseFromOneCrit = this.statTracker.statMultiplier.crit * ratingCritChanceContribution / rating;\r\n\r\n      return effectiveCritHealing * healIncreaseFromOneCrit;\r\n    }\r\n    return 0;\r\n  }\r\n  _hasteHpct(event, healVal) {\r\n    const currHastePerc = this.statTracker.currentHastePercentage;\r\n    const healIncreaseFromOneHaste = this.statTracker.statMultiplier.haste / this.statTracker.ratingNeededForNextPercentage(this.statTracker.currentHasteRating, this.statTracker.statBaselineRatingPerPercent[STAT.HASTE]);\r\n    const baseHeal = healVal.effective / (1 + currHastePerc);\r\n    return baseHeal * healIncreaseFromOneHaste;\r\n  }\r\n  _hasteHpm(event, healVal) {\r\n    const healIncreaseFromOneHaste = this.statTracker.statMultiplier.haste / this.statTracker.ratingNeededForNextPercentage(this.statTracker.currentHasteRating, this.statTracker.statBaselineRatingPerPercent[STAT.HASTE]);\r\n    const noHasteHealing = healVal.effective / (1 + this.statTracker.currentHastePercentage);\r\n    return noHasteHealing * healIncreaseFromOneHaste;\r\n  }\r\n  _mastery(event, healVal) {\r\n    throw new Error('Missing custom Mastery implementation. This is different per spec.');\r\n  }\r\n  _versatility(event, healVal) {\r\n    if (healVal.overheal) {\r\n      // If a spell overheals, it could not have healed for more. Seeing as Versatility only adds HP on top of the existing heal we can skip it as increasing the power of this heal would only be more overhealing.\r\n      return 0;\r\n    }\r\n    const currVersPerc = this.statTracker.currentVersatilityPercentage;\r\n    const healIncreaseFromOneVers = this.statTracker.statMultiplier.versatility / this.statTracker.ratingNeededForNextPercentage(this.statTracker.currentVersatilityRating, this.statTracker.statBaselineRatingPerPercent[STAT.VERSATILITY], 1, false);\r\n    const baseHeal = healVal.effective / (1 + currVersPerc);\r\n    return baseHeal * healIncreaseFromOneVers;\r\n  }\r\n\r\n  onDamageTaken(event) {\r\n    this._updateMissingHealth(event);\r\n\r\n    const damageVal = new DamageValue(event.amount, event.absorbed, event.blocked, event.overkill);\r\n    // const targetHealthPercentage = event.hitPoints / event.maxHitPoints; // hitPoints contains HP *after* the damage taken, which in this case is desirable\r\n    // this.totalOneVersDr += this._adjustGain(this._versatilityDamageReduction(event, damageVal), targetHealthPercentage);\r\n    // TODO: Figure out how to make this account for target health since damage event don't appear to have hitPoints info\r\n    this.totalOneVersDr += this._versatilityDamageReduction(event, damageVal);\r\n  }\r\n  _versatilityDamageReduction(event, damageVal) {\r\n    const amount = damageVal.effective;\r\n    const currentVersDamageReductionPercentage = this.statTracker.currentVersatilityPercentage / 2;\r\n    const damageReductionIncreaseFromOneVers = this.statTracker.statMultiplier.versatility / this.statTracker.ratingNeededForNextPercentage(this.statTracker.currentVersatilityRating, this.statTracker.statBaselineRatingPerPercent[STAT.VERSATILITY], 1, false) / 2; // the DR part is only 50% of the Versa percentage\r\n\r\n    const noVersDamage = amount / (1 - currentVersDamageReductionPercentage);\r\n    return noVersDamage * damageReductionIncreaseFromOneVers;\r\n  }\r\n\r\n  onHealTaken(event) {\r\n    this._updateMissingHealth(event);\r\n  }\r\n  _updateMissingHealth(event) {\r\n    if (event.hitPoints && event.maxHitPoints) { // fields not always populated, don't know why\r\n      // `maxHitPoints` is always the value *after* the effect applied\r\n      this.playerHealthMissing = event.maxHitPoints - event.hitPoints;\r\n    }\r\n  }\r\n\r\n  onFightend() {\r\n    if (DEBUG) {\r\n      console.log('total', formatNumber(this.totalAdjustedHealing));\r\n      console.log(`Int - ${formatNumber(this.totalOneInt)}`);\r\n      console.log(`Crit - ${formatNumber(this.totalOneCrit)}`);\r\n      console.log(`Haste HPCT - ${formatNumber(this.totalOneHasteHpct)}`);\r\n      console.log(`Haste HPM - ${formatNumber(this.totalOneHasteHpm)}`);\r\n      console.log(`Mastery - ${formatNumber(this.totalOneMastery)}`);\r\n      console.log(`Vers - ${formatNumber(this.totalOneVers)}`);\r\n      console.log(`Leech - ${formatNumber(this.totalOneLeech)}`);\r\n    }\r\n  }\r\n\r\n  get hpsPerIntellect() {\r\n    return this._getGain(STAT.INTELLECT) / this.owner.fightDuration * 1000;\r\n  }\r\n  get hpsPerCriticalStrike() {\r\n    return this._getGain(STAT.CRITICAL_STRIKE) / this.owner.fightDuration * 1000;\r\n  }\r\n  get hpsPerHasteHPCT() {\r\n    return this._getGain(STAT.HASTE_HPCT) / this.owner.fightDuration * 1000;\r\n  }\r\n  get hpsPerHasteHPM() {\r\n    return this._getGain(STAT.HASTE_HPM) / this.owner.fightDuration * 1000;\r\n  }\r\n  get hpsPerHaste() {\r\n    return this.hpsPerHasteHPCT + this.hpsPerHasteHPM;\r\n  }\r\n  get hpsPerMastery() {\r\n    return this._getGain(STAT.MASTERY) / this.owner.fightDuration * 1000;\r\n  }\r\n  get hpsPerVersatility() {\r\n    return this._getGain(STAT.VERSATILITY) / this.owner.fightDuration * 1000;\r\n  }\r\n  get hpsPerVersatilityDR() {\r\n    return this._getGain(STAT.VERSATILITY_DR) / this.owner.fightDuration * 1000;\r\n  }\r\n  get hpsPerLeech() {\r\n    return this._getGain(STAT.LEECH) / this.owner.fightDuration * 1000;\r\n  }\r\n\r\n  // region Item values\r\n  calculateItemStatsHps(baseStats, itemLevel) {\r\n    let hps = 0;\r\n    if (baseStats.primary) {\r\n      hps += calculatePrimaryStat(baseStats.itemLevel, baseStats.primary, itemLevel) * this.hpsPerIntellect;\r\n    }\r\n    if (baseStats.criticalStrike) {\r\n      hps += calculateSecondaryStatDefault(baseStats.itemLevel, baseStats.criticalStrike, itemLevel) * this.hpsPerCriticalStrike;\r\n    }\r\n    if (baseStats.haste) {\r\n      hps += calculateSecondaryStatDefault(baseStats.itemLevel, baseStats.haste, itemLevel) * this.hpsPerHaste;\r\n    }\r\n    if (baseStats.mastery) {\r\n      hps += calculateSecondaryStatDefault(baseStats.itemLevel, baseStats.mastery, itemLevel) * this.hpsPerMastery;\r\n    }\r\n    if (baseStats.versatility) {\r\n      hps += calculateSecondaryStatDefault(baseStats.itemLevel, baseStats.versatility, itemLevel) * this.hpsPerVersatility;\r\n    }\r\n    if (baseStats.leech) {\r\n      hps += calculateSecondaryStatDefault(baseStats.itemLevel, baseStats.leech, itemLevel) * this.hpsPerLeech;\r\n    }\r\n    return hps;\r\n  }\r\n  // endregion\r\n\r\n  // region statistic\r\n  _ratingPerOnePercent(oneRatingHealing) {\r\n    const onePercentHealing = this.totalAdjustedHealing / 100;\r\n    return onePercentHealing / oneRatingHealing;\r\n  }\r\n  _getGain(stat) {\r\n    switch (stat) {\r\n      case STAT.INTELLECT:\r\n        return this.totalOneInt;\r\n      case STAT.CRITICAL_STRIKE:\r\n        return this.totalOneCrit;\r\n      case STAT.HASTE_HPCT:\r\n        return this.totalOneHasteHpct;\r\n      case STAT.HASTE_HPM:\r\n        return this.totalOneHasteHpm;\r\n      case STAT.MASTERY:\r\n        return this.totalOneMastery;\r\n      case STAT.VERSATILITY:\r\n        return this.totalOneVers;\r\n      case STAT.VERSATILITY_DR:\r\n        return this.totalOneVers + this.totalOneVersDr;\r\n      case STAT.LEECH:\r\n        return this.totalOneLeech;\r\n      default:\r\n        return 0;\r\n    }\r\n  }\r\n  _getTooltip(stat) {\r\n    switch (stat) {\r\n      case STAT.HASTE_HPCT:\r\n        return <Trans id=\"shared.healerStatValues.stats.hpct\">HPCT stands for \"Healing per Cast Time\". This is the value that Haste would be worth if you would cast everything you are already casting (and that scales with Haste) faster. Mana is not accounted for in any way and you should consider the Haste stat weight 0 if you run out of mana while doing everything else right.</Trans>;\r\n      case STAT.HASTE_HPM:\r\n        return <Trans id=\"shared.healerStatValues.stats.hpm\">HPM stands for \"Healing per Mana\". In valuing Haste, it considers only the faster HoT ticking and not the reduced cast times. Effectively it models haste's bonus to mana efficiency. This is typically the better calculation to use for raid encounters where mana is an issue.</Trans>;\r\n      case STAT.VERSATILITY_DR:\r\n        return <Trans id=\"shared.healerStatValues.stats.versDR\">Weight includes both healing boost and damage reduction, counting the damage reduced as additional throughput.</Trans>;\r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n  moreInformationLink = null;\r\n  static position = STATISTIC_ORDER.CORE(9);\r\n  statistic() {\r\n    const results = this._prepareResults();\r\n    const qeLink = results.reduce((urlParts, stat) => {\r\n      if (stat === 'intellect' || stat === 'versatilitydr') {\r\n        return urlParts;\r\n      }\r\n\r\n      const statValue = typeof stat === 'object' ? stat.stat : stat;\r\n      const gain = this._getGain(statValue);\r\n      const weight = gain / (this.totalOneInt || 1);\r\n      const statName = getName(statValue).replace(/[()\\s+]/g, '');\r\n\r\n      urlParts.push(statName + '=' + weight.toFixed(2));\r\n      return urlParts;\r\n    }, []).join('&');\r\n    return (\r\n      <StatisticWrapper position={this.constructor.position}>\r\n        <div className=\"col-lg-6 col-md-6 col-sm-6 col-xs-12\">\r\n          <div className=\"panel items statistic\">\r\n            {this.moreInformationLink && (\r\n              <a\r\n                href={this.moreInformationLink}\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n              >\r\n                <Tooltip content=\"Click for more information.\">\r\n                  <div\r\n                    className=\"detail-corner\"\r\n                    data-place=\"top\"\r\n                  >\r\n                    <InfoIcon />\r\n                  </div>\r\n                </Tooltip>\r\n              </a>\r\n            )}\r\n            <div className=\"panel-body\" style={{ padding: '10px 0 16px' }}>\r\n              <table className=\"data-table compact\" style={{ margin: 0 }}>\r\n                <thead>\r\n                  <tr className=\"text-muted\">\r\n                    <th style={{ minWidth: 30, fontWeight: 400 }}>\r\n                      <TooltipElement\r\n                        content={(\r\n                          <Trans id=\"shared.healerStatValues.statistic.title.tooltip\">\r\n                            These stat values are calculated using the actual circumstances of this encounter. These values reveal the value of the last 1 rating of each stat, they may not necessarily be the best way to gear. The stat values are likely to differ based on fight, raid size, items used, talents chosen, etc.<br /><br />\r\n                            DPS gains are not included in any of the stat values.\r\n                          </Trans>\r\n                        )}\r\n                      >\r\n                        <Trans id=\"shared.healerStatValues.statistic.title\">Stat Values</Trans>\r\n                      </TooltipElement>\r\n                      {false && this.qeLive && this.selectedCombatant.characterProfile && ( // globally disable the QELive button until QE is updated to accept Shadowlands data\r\n                        <Tooltip content=\"Opens in a new tab. Leverage the QE Live Tool to directly compare gear, azerite traits, and trinkets based on your stat values.\">\r\n                          <a\r\n                            href={`https://www.questionablyepic.com/live?import=WoWA&spec=${this.selectedCombatant.specId}&pname=${this.selectedCombatant.name}&realm=${this.selectedCombatant.characterProfile.realm}&region=${this.selectedCombatant.characterProfile.region}&${qeLink}`}\r\n                            target=\"_blank\"\r\n                            rel=\"noopener noreferrer\"\r\n                          >\r\n                            <Trans id=\"shared.healerStatValues.statistic.qeLink\"><img src={QELiveLogo} alt=\"Questionably Epic Live\" style={{ height: '1.2em', marginLeft: 15 }} /> Open Questionably Epic Live</Trans>\r\n                          </a>\r\n                        </Tooltip>\r\n                      )}\r\n                    </th>\r\n                    <th className=\"text-right\" style={{ minWidth: 30, fontWeight: 400 }} colSpan={2}>\r\n                      <TooltipElement content={<Trans id=\"shared.healerStatValues.statistic.title.value.tooltip\">Normalized so Intellect is always 1.00.</Trans>}>\r\n                        <Trans id=\"shared.healerStatValues.statistic.title.value\">Value</Trans>\r\n                      </TooltipElement>\r\n                    </th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {results.map(row => {\r\n                    const stat = typeof row === 'object' ? row.stat : row;\r\n                    const tooltip = typeof row === 'object' ? row.tooltip : this._getTooltip(stat);\r\n                    const gain = this._getGain(stat);\r\n                    const weight = gain / (this.totalOneInt || 1);\r\n                    const ratingForOne = this._ratingPerOnePercent(gain);\r\n\r\n                    const Icon = getIcon(stat);\r\n\r\n                    const gainPerSecond = (gain / this.owner.fightDuration * 1000).toFixed(2);\r\n                    const rating = gain !== null ? (ratingForOne === Infinity ? '∞' : formatNumber(ratingForOne)) : 'NYI';\r\n                    const informationIconTooltip = <Trans id=\"shared.healerStatValues.statistic.stats.tooltip\">{gainPerSecond} HPS per 1 rating / {rating} rating per 1% throughput</Trans>;\r\n\r\n                    return (\r\n                      <tr key={stat}>\r\n                        <td className={getClassNameColor(stat)}>\r\n                          <Icon\r\n                            style={{\r\n                              height: '1.6em',\r\n                              width: '1.6em',\r\n                              marginRight: 10,\r\n                            }}\r\n                          />{' '}\r\n                          {tooltip ? <TooltipElement content={tooltip}>{getNameTranslated(stat)}</TooltipElement> : getNameTranslated(stat)}\r\n                        </td>\r\n                        <td className=\"text-right\">\r\n                          {stat === STAT.HASTE_HPCT && '0.00 - '}{gain !== null ? weight.toFixed(2) : 'NYI'}\r\n                        </td>\r\n                        <td style={{ padding: 6 }}>\r\n                          <Tooltip content={informationIconTooltip}>\r\n                            <div>\r\n                              <InformationIcon />\r\n                            </div>\r\n                          </Tooltip>\r\n                        </td>\r\n                      </tr>\r\n                    );\r\n                  })}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </StatisticWrapper>\r\n    );\r\n  }\r\n  // endregion\r\n}\r\n\r\nexport default BaseHealerStatValues;\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport { formatThousands } from 'common/format';\r\nimport ManaIcon from 'interface/icons/Mana';\r\nimport CombatLogParser from 'parser/core/CombatLogParser';\r\n\r\ninterface Props {\r\n  amount: number;\r\n  approximate?: boolean;\r\n}\r\ninterface Context {\r\n  parser: CombatLogParser;\r\n}\r\n\r\nconst ItemManaGained = (\r\n  { amount, approximate }: Props,\r\n  { parser }: Context,\r\n) => (\r\n  <>\r\n    <ManaIcon /> {approximate && '≈'}\r\n    {formatThousands((amount / parser.fightDuration) * 1000 * 5)} MP5{' '}\r\n    <small>{formatThousands(amount)} total mana</small>\r\n  </>\r\n);\r\nItemManaGained.contextTypes = {\r\n  parser: PropTypes.object.isRequired,\r\n};\r\n\r\nexport default ItemManaGained;\r\n","import React from 'react';\r\n\r\nimport Panel from 'interface/statistics/Panel';\r\nimport Analyzer from 'parser/core/Analyzer';\r\nimport { Trans } from '@lingui/macro';\r\n\r\nimport HealingEfficiencyTracker from './HealingEfficiencyTracker';\r\nimport HealingEfficiencyBreakdown from './HealingEfficiencyBreakdown';\r\n\r\nclass HealingEfficiencyDetails extends Analyzer {\r\n  static dependencies = {\r\n    healingEfficiencyTracker: HealingEfficiencyTracker,\r\n  };\r\n\r\n  protected healingEfficiencyTracker!: HealingEfficiencyTracker;\r\n\r\n  statistic() {\r\n    return (\r\n      <Panel\r\n        title={<Trans id=\"shared.healingEfficiency.title\">Mana Efficiency</Trans>}\r\n        position={120}\r\n      >\r\n        <HealingEfficiencyBreakdown tracker={this.healingEfficiencyTracker} />\r\n      </Panel>\r\n    );\r\n  }\r\n}\r\n\r\nexport default HealingEfficiencyDetails;\r\n","import { SELECTED_PLAYER } from 'parser/core/Analyzer';\r\nimport Abilities from 'parser/core/modules/Abilities';\r\nimport SPELLS from 'common/SPELLS';\r\nimport Events from 'parser/core/Events';\r\nimport ExecuteHelper from 'parser/shared/ExecuteHelper';\r\n\r\nconst MINUTE = 600000;\r\n\r\nclass TouchOfDeath extends ExecuteHelper {\r\n  static executeSpells = [\r\n    SPELLS.TOUCH_OF_DEATH,\r\n  ];\r\n  static executeSources = SELECTED_PLAYER;\r\n  static lowerThreshold = 0.15;\r\n  static executeOutsideRangeEnablers = [];\r\n  static modifiesDamage = false;\r\n\r\n  static dependencies = {\r\n    ...ExecuteHelper.dependencies,\r\n    abilities: Abilities,\r\n  };\r\n\r\n  maxCasts = 0;\r\n\r\n  cooldown = MINUTE * 3;\r\n\r\n  constructor(options) {\r\n    super(options);\r\n    this.addEventListener(Events.fightend, this.adjustMaxCasts);\r\n\r\n    //FIXME added reduction from legendary when we can get that info\r\n\r\n    //if(hasLego) {\r\n    //  this.cooldown = this.cooldown - MINUTE;\r\n    // }\r\n\r\n    options.abilities.add({\r\n      spell: SPELLS.TOUCH_OF_DEATH,\r\n      category: Abilities.SPELL_CATEGORIES.COOLDOWNS,\r\n      cooldown: 180,\r\n      gcd: {\r\n        static: 1000,\r\n      },\r\n      castEfficiency: {\r\n        suggestion: true,\r\n        recommendedEfficiency: 0.85,\r\n        maxCasts: () => this.maxCasts || 0,\r\n      },\r\n    });\r\n  }\r\n\r\n  adjustMaxCasts(event) {\r\n    super.onFightEnd(event);\r\n    this.maxCasts += Math.ceil(this.totalExecuteDuration / this.cooldown);\r\n  }\r\n}\r\n\r\nexport default TouchOfDeath;\r\n","import Analyzer, { Options, SELECTED_PLAYER, SELECTED_PLAYER_PET } from 'parser/core/Analyzer';\r\nimport Abilities from 'parser/core/modules/Abilities';\r\nimport SPELLS from 'common/SPELLS';\r\nimport Events, { DamageEvent, HealEvent, SummonEvent } from 'parser/core/Events';\r\nimport Statistic from 'interface/statistics/Statistic';\r\nimport STATISTIC_ORDER from 'interface/others/STATISTIC_ORDER';\r\nimport STATISTIC_CATEGORY from 'interface/others/STATISTIC_CATEGORY';\r\nimport ItemDamageDone from 'interface/ItemDamageDone';\r\nimport ItemHealingDone from 'interface/ItemHealingDone';\r\nimport React from 'react';\r\nimport BoringSpellValueText from 'interface/statistics/components/BoringSpellValueText';\r\nimport { formatNumber } from 'common/format';\r\nimport COVENANTS from 'game/shadowlands/COVENANTS';\r\n\r\nclass FallenOrder extends Analyzer {\r\n  static dependencies = {\r\n    abilities: Abilities,\r\n  };\r\n  windDamage: number = 0;\r\n  brewDamage: number = 0;\r\n  mistDamage: number = 0;\r\n  mistHealing: number = 0;\r\n  mistOverhealing: number = 0;\r\n  cloneMap: Map<number, number> = new Map<number, number>();\r\n  protected abilities!: Abilities;\r\n\r\n  constructor(options: Options) {\r\n    super(options);\r\n\r\n    // In my testing this line always returns false but its what putput uses so I have faith\r\n    // it will work in the future. (might just be a bad log too)\r\n    this.active = this.selectedCombatant.hasCovenant(COVENANTS.VENTHYR.id);\r\n\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n\r\n    this.abilities.add({\r\n      spell: SPELLS.FALLEN_ORDER_CAST,\r\n      category: Abilities.SPELL_CATEGORIES.COOLDOWNS,\r\n      cooldown: 180,\r\n      gcd: {\r\n        base: 1500,\r\n      },\r\n      castEfficiency: {\r\n        suggestion: true,\r\n        recommendedEfficiency: 0.8,\r\n      },\r\n    });\r\n\r\n    //summon events (need to track this to get melees)\r\n    this.addEventListener(Events.summon.by(SELECTED_PLAYER).spell([SPELLS.FALLEN_ORDER_OX_CLONE, SPELLS.FALLEN_ORDER_TIGER_CLONE, SPELLS.FALLEN_ORDER_CRANE_CLONE]), this.trackSummons);\r\n\r\n    //mistweaver spells\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER_PET).spell([SPELLS.FALLEN_ORDER_ENVELOPING_MIST, SPELLS.FALLEN_ORDER_SOOTHING_MIST]), this.mistHealingTracker);\r\n    //brewmaster spells\r\n    this.addEventListener(Events.damage.by(SELECTED_PLAYER_PET).spell([SPELLS.FALLEN_ORDER_KEG_SMASH, SPELLS.FALLEN_ORDER_BREATH_OF_FIRE, SPELLS.BREATH_OF_FIRE_DEBUFF]), this.brewDamageTracker);\r\n    //windwalker spells\r\n    this.addEventListener(Events.damage.by(SELECTED_PLAYER_PET).spell([SPELLS.FALLEN_ORDER_SPINNING_CRANE_KICK, SPELLS.FISTS_OF_FURY_DAMAGE]), this.windDamageTracker);\r\n    //shared\r\n    this.addEventListener(Events.damage.by(SELECTED_PLAYER_PET).spell(SPELLS.MELEE), this.handleMelee);\r\n  }\r\n\r\n  trackSummons(event: SummonEvent) {\r\n    this.cloneMap.set(event.targetID, event.ability.guid);\r\n  }\r\n\r\n  mistHealingTracker(event: HealEvent) {\r\n    this.mistHealing += (event.amount || 0) + (event.absorbed || 0);\r\n    this.mistOverhealing += event.overheal || 0;\r\n  }\r\n\r\n  brewDamageTracker(event: DamageEvent) {\r\n    this.brewDamage += event.amount || 0;\r\n  }\r\n\r\n  windDamageTracker(event: DamageEvent) {\r\n    this.windDamage += event.amount || 0;\r\n  }\r\n\r\n  mistDamageTracker(event: DamageEvent) {\r\n    this.mistDamage += event.amount || 0;\r\n  }\r\n\r\n  handleMelee(event: DamageEvent) {\r\n    //if we don't know who its from then we can't add it\r\n    if (!event.sourceID) {\r\n      return;\r\n    }\r\n\r\n    const id: number = event.sourceID;\r\n\r\n    const cloneType: number | undefined = this.cloneMap.get(id);\r\n    //because typescript won't let me just do this.cloneMap.get(id) i might as well add a null check too\r\n    if (cloneType === undefined) {\r\n      return;\r\n    }\r\n\r\n    if (cloneType === SPELLS.FALLEN_ORDER_OX_CLONE.id) {\r\n      this.brewDamageTracker(event);\r\n    } else if (cloneType === SPELLS.FALLEN_ORDER_TIGER_CLONE.id) {\r\n      this.windDamageTracker(event);\r\n    } else {\r\n      this.mistDamageTracker(event);\r\n    }\r\n\r\n  }\r\n\r\n  statistic() {\r\n    const totalDamage: number = this.brewDamage + this.mistDamage + this.windDamage;\r\n\r\n    return (\r\n      <Statistic\r\n        position={STATISTIC_ORDER.CORE()}\r\n        size=\"flexible\"\r\n        category={STATISTIC_CATEGORY.COVENANTS}\r\n        tooltip={(\r\n          <>\r\n            <ul>\r\n              <li>Damage from Brewmaster clones: {formatNumber(this.brewDamage)}</li>\r\n              <li>Damage from Mistweaver clones: {formatNumber(this.mistDamage)}</li>\r\n              <li>Damage from Windwalker clones: {formatNumber(this.windDamage)}</li>\r\n            </ul>\r\n          </>\r\n        )}\r\n      >\r\n        <BoringSpellValueText spell={SPELLS.FALLEN_ORDER_CAST}>\r\n          <ItemHealingDone amount={this.mistHealing} /><br />\r\n          <ItemDamageDone amount={totalDamage} />\r\n        </BoringSpellValueText>\r\n      </Statistic>\r\n    );\r\n  }\r\n}\r\n\r\nexport default FallenOrder;\r\n","import Combatants from 'parser/shared/modules/Combatants';\r\nimport Haste from 'parser/shared/modules/Haste';\r\nimport calculateEffectiveHealing from 'parser/core/calculateEffectiveHealing';\r\nimport Analyzer, { SELECTED_PLAYER } from 'parser/core/Analyzer';\r\nimport Events from 'parser/core/Events';\r\nimport HIT_TYPES from 'game/HIT_TYPES';\r\nimport { EventType } from 'parser/core/Events';\r\n\r\nconst PANDEMIC_FACTOR = 1.3;\r\nconst PANDEMIC_EXTRA = 0.3;\r\n\r\n// tolerated difference between expected and actual HoT fall before a 'mismatch' is logged\r\nconst EXPECTED_REMOVAL_THRESHOLD = 200;\r\n\r\n// this class does a lot, a few different debug areas to cut down on the spam while debugging\r\nconst debug = false;\r\nconst extensionDebug = false; // logs pertaining to extensions\r\nconst applyRemoveDebug = false; // logs tracking HoT apply / refresh / remove\r\nconst healDebug = false; // logs tracking HoT heals\r\n\r\nclass HotTracker extends Analyzer {\r\n  static dependencies = {\r\n    combatants: Combatants,\r\n    haste: Haste,\r\n  };\r\n\r\n  //{\r\n  //  [playerId]:{\r\n  //    [hotId]: {start, end, originalEnd, spellId, guid, name, ticks, attributions, extensions, boosts, healingAfterOriginalEnd, maxDuration},\r\n  //  },\r\n  //}\r\n\r\n  hots = {};\r\n  bouncingHots = [];\r\n\r\n  currentGuid = 0;\r\n\r\n  hotHistory = [];\r\n\r\n  constructor(...args) {\r\n    super(...args);\r\n    this.hotInfo = this._generateHotInfo(); // some HoT info depends on traits and so must be generated dynamically\r\n    this.hotList = this._generateHotList();\r\n    if(!this.hotInfo){\r\n      this.active = false;\r\n    }\r\n\r\n    this.addEventListener(Events.applybuff.by(SELECTED_PLAYER).spell(this.hotList), this.hotApplied);\r\n    this.addEventListener(Events.heal.by(SELECTED_PLAYER).spell(this.hotList), this.hotHeal);\r\n    this.addEventListener(Events.refreshbuff.by(SELECTED_PLAYER).spell(this.hotList), this.hotReapplied);\r\n    this.addEventListener(Events.removebuff.by(SELECTED_PLAYER).spell(this.hotList), this.hotRemoved);\r\n  }\r\n\r\n  hotApplied(event){\r\n    const spellId = event.ability.guid;\r\n    const target = this._getTarget(event);\r\n    if (!target) {\r\n      return;\r\n    }\r\n    const targetId = event.targetID;\r\n    if (!this._validateHot(event)) {\r\n      return;\r\n    }\r\n\r\n    if(this.hotInfo[spellId].bouncy && this.bouncingHots.length !== 0){\r\n      if (!this.hots[targetId]) {\r\n        this.hots[targetId] = {};\r\n      }\r\n      this.hots[targetId][spellId] = this.bouncingHots[0];\r\n      this.bouncingHots.shift();\r\n      return;\r\n    }\r\n\r\n    let hotDuration = this.hotInfo[spellId].duration;\r\n    if(this.hotInfo[spellId].durationConditions){\r\n      event.selectedCombatant = this.selectedCombatant;\r\n      hotDuration = this.hotInfo[spellId].durationConditions(event);\r\n    }\r\n\r\n    let maxDuration = -1;\r\n    if(this.hotInfo[spellId].maxDuration){\r\n      event.selectedCombatant = this.selectedCombatant;\r\n      maxDuration = this.hotInfo[spellId].maxDuration(event);\r\n    }\r\n\r\n    const newHot = {\r\n      start: event.timestamp,\r\n      end: event.timestamp + hotDuration,\r\n      originalEnd: event.timestamp + hotDuration,\r\n      spellId, // stored extra here so I don't have to convert string to number like I would if I used its key in the object.\r\n      guid: this.currentGuid,\r\n      name: event.ability.name, // stored for logging\r\n      ticks: [], // listing of ticks w/ effective heal amount and timestamp, to be used as part of the HoT extension calculations\r\n      attributions: [], // The effect or bonus that procced this HoT application. No attribution implies the spell was hardcast.\r\n      extensions: [], // The effects or bonuses that caused this HoT to have extended duration. Format: { amount, attribution }\r\n      boosts: [], // The effects or bonuses that caused the strength of this HoT to be boosted for its full duration.\r\n      healingAfterOriginalEnd: 0,//healing this hot did after the base duration due to extensions\r\n      maxDuration: maxDuration,//the true max duration that extensions will obey by (looking at rising mist)\r\n    };\r\n\r\n    this.currentGuid += 1;\r\n\r\n    if (!this.hots[targetId]) {\r\n      this.hots[targetId] = {};\r\n    }\r\n    this.hots[targetId][spellId] = newHot;\r\n    this.hotHistory.push(newHot);\r\n  }\r\n\r\n  hotHeal(event) {\r\n    const spellId = event.ability.guid;\r\n    const target = this._getTarget(event);\r\n\r\n    if (!target) {\r\n      return;\r\n    }\r\n    const targetId = event.targetID;\r\n    const healing = event.amount + (event.absorbed || 0);\r\n\r\n    if (!this._validateHot(event)) {\r\n      return;\r\n    }\r\n    const hot = this.hots[targetId][spellId];\r\n    if (event.tick) { // direct healing (say from a PotA procced regrowth) still should be counted for attribution, but not part of tick tracking\r\n      hot.ticks.push({ healing, timestamp: event.timestamp });\r\n    }\r\n\r\n    if(hot.originalEnd < event.timestamp && event.timestamp < (hot.start + hot.maxDuration)){\r\n      hot.healingAfterOriginalEnd += healing;\r\n    }\r\n\r\n    hot.attributions.forEach(att => {\r\n      att.healing += healing;\r\n    });\r\n    hot.boosts.forEach(att => {\r\n      att.healing += calculateEffectiveHealing(event, att.boost);\r\n    });\r\n\r\n    if(event.hitType === HIT_TYPES.CRIT && this.hotInfo[spellId].effectOnCrit){//if the heal crits and it does something fancy on crits do that\r\n      hot.effectOnCrit(event);\r\n    }\r\n    // extensions handled when HoT falls, using ticks list\r\n  }\r\n\r\n  hotReapplied(event) {\r\n    const spellId = event.ability.guid;\r\n    const target = this._getTarget(event);\r\n    if (!target) {\r\n      return;\r\n    }\r\n    const targetId = event.targetID;\r\n    if (!this._validateHot(event)) {\r\n      return;\r\n    }\r\n\r\n    const hot = this.hots[targetId][spellId];\r\n\r\n    const oldEnd = hot.end;\r\n    let freshDuration = this.hotInfo[spellId].duration;\r\n    if(this.hotInfo[spellId].durationConditions){\r\n      event.selectedCombatant = this.selectedCombatant;\r\n      freshDuration = this.hotInfo[spellId].durationConditions(spellId);\r\n    }\r\n    hot.end += this._calculateExtension(freshDuration, hot, spellId, true, true);\r\n\r\n    hot.originalEnd = hot.end;//reframe our info\r\n\r\n    // seperately calculating if refresh was in pandemic, because for display to the player I want to avoid factoring in tick clipping...\r\n    const remaining = oldEnd - event.timestamp;\r\n    const clipped = remaining - (freshDuration * PANDEMIC_EXTRA);\r\n    if (clipped > 0) {\r\n      debug && console.log(`${event.ability.name} on target ID ${targetId} was refreshed early @${this.owner.formatTimestamp(event.timestamp)}, clipping ${(clipped / 1000).toFixed(1)}s`);\r\n      hot.extensions.forEach(ext => {\r\n        ext.amount -= clipped;\r\n        extensionDebug && console.log(`Extension ${ext.attribution.name} on ${event.ability.name} / ${targetId} @${this.owner.formatTimestamp(event.timestamp)} was clipped by ${(clipped / 1000).toFixed(1)}s`);\r\n      });\r\n      // TODO do more stuff about clipped HoT duration (a suggestion?). Only suggest for clipping hardcasts, of course.\r\n    }\r\n\r\n    hot.attributions = []; // new attributions on refresh\r\n\r\n    this._tallyExtensions(hot);\r\n    hot.extensions = [];\r\n\r\n    hot.boosts = [];\r\n  }\r\n\r\n\r\n  hotRemoved(event) {\r\n    const spellId = event.ability.guid;\r\n    const target = this._getTarget(event);\r\n    if (!target) {\r\n      return;\r\n    }\r\n    const targetId = event.targetID;\r\n    if (!this._validateHot(event)) {\r\n      return;\r\n    }\r\n\r\n    if(this.hotInfo[spellId].bouncy && this.hots[targetId][spellId].end > event.timestamp){\r\n      this.bouncingHots.push(this.hots[targetId][spellId]);\r\n    }else{\r\n      this._checkRemovalTime(this.hots[targetId][spellId], event.timestamp, targetId);\r\n      this._tallyExtensions(this.hots[targetId][spellId]);\r\n    }\r\n    //delete hot no matter what\r\n    delete this.hots[targetId][spellId];\r\n  }\r\n\r\n  /*\r\n   * Adds an attribution to the HoT with the given spellId on the given targetId.\r\n   * Attribution object passed in will be modified as the HoT heals, and must have the following fields:\r\n   *    name: String (used only for logging)\r\n   *    healing: Number (tallies the direct healing attributable)\r\n   *    procs: Number (tallies the number of times this attribution was made)\r\n   */\r\n  addAttribution(attribution, targetId, spellId) {\r\n    if (!this.hots[targetId] || !this.hots[targetId][spellId]) {\r\n      debug && console.warn(`Tried to add attribution ${attribution.name} to targetId=${targetId}, spellId=${spellId}, but that HoT isn't recorded as present`);\r\n      return;\r\n    }\r\n    attribution.procs += 1;\r\n    this.hots[targetId][spellId].attributions.push(attribution);\r\n    debug && console.log(`${this.hots[targetId][spellId].name} on ${targetId} @${this.owner.formatTimestamp(this.owner.currentTimestamp, 1)} attributed to ${attribution.name}`);\r\n  }\r\n\r\n  /*\r\n   * Extends the duration of the HoT with the the given spellId on the given targetId, and adds an attribution to that extension.\r\n   * Attribution object passed in will be modified when the HoT expires, and must have the following fields:\r\n   *    name: String (used only for logging)\r\n   *    healing: Number (tallies the direct healing attributable)\r\n   *    procs: Number (tallies the number of times this attribution was made)\r\n   *    duration: Number (tallies the actual amount of extension applied, after clamping)\r\n   * tickClamps and pandemicClamps specify if / how the extension should be clamped\r\n   *\r\n   * NOTE: can pass a null attribution to extend HoT without attributing it\r\n   */\r\n  addExtension(attribution, amount, targetId, spellId, timestamp, tickClamps = true, pandemicClamps = false) {\r\n    if (!this.hots[targetId] || !this.hots[targetId][spellId]) {\r\n      debug && console.warn(`Tried to add extension ${attribution.name || 'NO-ATT'} to targetId=${targetId}, spellId=${spellId}, but that HoT isn't recorded as present`);\r\n      return;\r\n    }\r\n\r\n    const hot = this.hots[targetId][spellId];\r\n\r\n    //double check if we can even extend in the first place\r\n    if(hot.maxDuration !== -1){\r\n      const timeOut = timestamp - hot.start;\r\n      const timeLeft = hot.maxDuration - timeOut;\r\n      const timeToAdd = Math.min(amount, timeLeft);//find the smaller one as this will be added\r\n      amount = Math.max(timeToAdd, 0);//make sure we are not negative\r\n    }\r\n\r\n    const finalAmount = this._calculateExtension(amount, hot, spellId, tickClamps, pandemicClamps);\r\n    hot.end += finalAmount;\r\n\r\n    // TODO log the result\r\n    if (!attribution) {\r\n      return;\r\n    }\r\n\r\n    attribution.procs += 1;\r\n    const existingExtension = hot.extensions.find(extension => extension.attribution.name === attribution.name);\r\n    if (existingExtension) {\r\n      existingExtension.amount += finalAmount;\r\n    } else {\r\n      hot.extensions.push({\r\n        attribution,\r\n        amount: finalAmount,\r\n      });\r\n    }\r\n    debug && console.log(`${hot.name} on ${targetId} @${this.owner.formatTimestamp(this.owner.currentTimestamp, 1)} extended ${(finalAmount / 1000).toFixed(1)}s by ${attribution.name}`);\r\n  }\r\n\r\n  /*\r\n   * For each attributed extension on a HoT, tallies the granted healing\r\n   */\r\n  _tallyExtensions(hot) {\r\n    hot.extensions\r\n      .filter(ext => ext.amount > 0) // early refreshes can wipe out the effect of an extension, filter those ones out\r\n      .forEach(ext => this._tallyExtension(hot.ticks, ext.amount, ext.attribution));\r\n  }\r\n\r\n  _tallyExtension(ticks, amount, attribution) {\r\n    const now = this.owner.currentTimestamp;\r\n\r\n    let foundEarlier = false;\r\n    let latestOutside = now;\r\n    let healing = 0;\r\n    // sums healing of every tick within 'amount',\r\n    // also gets the latest tick outside the range, used to scale the healing amount\r\n    for (let i = ticks.length - 1; i >= 0; i -= 1) {\r\n      const tick = ticks[i];\r\n      latestOutside = tick.timestamp;\r\n      if ((now - tick.timestamp) > amount) {\r\n        foundEarlier = true;\r\n        break;\r\n      }\r\n\r\n      healing += tick.healing;\r\n    }\r\n\r\n    if (foundEarlier) {\r\n      // TODO better explanation of why I need to scale direct healing\r\n      const scale = amount / (now - latestOutside);\r\n      attribution.healing += (healing * scale);\r\n      attribution.duration += amount;\r\n    } else {\r\n      // TODO error log, because this means the extension was almost all the HoT's duration? Check for an early removal of HoT.\r\n    }\r\n  }\r\n\r\n  /*\r\n   * HoT extensions (for whatever reason) do not always extend by exactly the listed amount.\r\n   * Instead, they follow the following formula, which this function implements:\r\n   *\r\n   * Add the raw extension amount to the current time remaining on the HoT, then round to the nearest whole number of ticks (with respect to haste)\r\n   * Note that as most tick periods scale with haste, this rounding effectively works on a snapshot of the player's haste at the moment of the extension.\r\n   *\r\n   * An example:\r\n   * The player casts Flourish (raw extension = 6 seconds), extending a Rejuvenation with 5.4s remaining.\r\n   * The player's current haste is 20%, meaning rejuv's current tick period = 3 / (1 + 0.2) = 2.5\r\n   * Time remaining after raw extension = 5.4 + 6 = 11.6\r\n   * Ticks remaining after extension, before rounding = 11.6 / 2.5 = 4.64\r\n   * Round(4.64) = 5 ticks => 5 * 2.5 = 12.5 seconds remaining after extension and rounding\r\n   * Effective extension amount = 12.6 - 5.4 = 7.2\r\n   * Note that this can round up or down\r\n   *\r\n   * Thanks @tremaho for the detailed explanation of the formula\r\n   */\r\n  _calculateExtension(rawAmount, hot, spellId, tickClamps, pandemicClamps) {\r\n    let amount = rawAmount;\r\n    const currentTimeRemaining = hot.end - this.owner.currentTimestamp;\r\n\r\n    let pandemicLog = '';\r\n    if (pandemicClamps) {\r\n      const newTimeRemaining = currentTimeRemaining + amount;\r\n      const pandemicMax = this.hotInfo[spellId].duration * PANDEMIC_FACTOR;\r\n      if (newTimeRemaining > pandemicMax) {\r\n        amount = pandemicMax - currentTimeRemaining;\r\n        pandemicLog = `PANDEMIC:(remaining=${(pandemicMax / 1000).toFixed(2)}s)`;\r\n      } else {\r\n        pandemicLog = `PANDEMIC:(N/A)`;\r\n      }\r\n    }\r\n\r\n    let tickLog = '';\r\n    if (tickClamps) {\r\n      const currentTickPeriod = this.hotInfo[spellId].tickPeriod / (1 + this.haste.current);\r\n      const newTimeRemaining = currentTimeRemaining + amount;\r\n      const newTicksRemaining = newTimeRemaining / currentTickPeriod;\r\n      const newRoundedTimeRemaining = Math.round(newTicksRemaining) * currentTickPeriod;\r\n      amount = newRoundedTimeRemaining - currentTimeRemaining;\r\n      tickLog = `TICK:(period=${(currentTickPeriod / 1000).toFixed(2)}s)`;\r\n    }\r\n\r\n    // an extension can never reduce HoT's remaining duration, even after clamping\r\n    amount = Math.max(0, amount);\r\n\r\n    extensionDebug && console.log(`${hot.name} w/ ${(currentTimeRemaining / 1000).toFixed(2)}s remaining gets ${(rawAmount / 1000).toFixed(2)}s extension clamped by ${pandemicLog} ${tickLog} => actual: ${(amount / 1000).toFixed(2)}s, new remaining: ${((amount + currentTimeRemaining) / 1000).toFixed(2)}s`);\r\n\r\n    return amount;\r\n  }\r\n\r\n  // Returns the difference between the timestamp and the expected removal time listed in the hot object.\r\n  // Return will be positive if HoT actually ended after expected end (eg HoT lasted longer than expected).\r\n  // Return will be negative if HoT actually ended before expected end (eg HoT lasted shorter than expected).\r\n  // Logs when difference is over a certain threshold.\r\n  _checkRemovalTime(hot, actual, targetId) {\r\n    const expected = hot.end;\r\n    const diff = actual - expected;\r\n    if (diff > EXPECTED_REMOVAL_THRESHOLD) {\r\n      // The only reason HoT could last longer than expected is we are missing an extension, which is a bug -> log a warning\r\n      extensionDebug && console.warn(`${hot.name} on ${targetId} fell @${this.owner.formatTimestamp(actual, 1)}, which is ${(diff / 1000).toFixed(1)}s LATER than expected... Missing an extension?`);\r\n    } else if (diff < (-1 * EXPECTED_REMOVAL_THRESHOLD)) {\r\n      // Several legitimate reasons HoT could last shorter than expected: lifebloom swap, target dies, target was purged, target cancelled the spell -> log only when debug on\r\n      extensionDebug && console.warn(`${hot.name} on ${targetId} fell @${this.owner.formatTimestamp(actual, 1)}, which is ${-(diff / 1000).toFixed(1)}s earlier than expected`);\r\n    }\r\n    return diff;\r\n  }\r\n\r\n\r\n  // gets an event's target ... returns null if for any reason the event should not be further processed\r\n  _getTarget(event) {\r\n    const target = this.combatants.getEntity(event);\r\n    if (!target) {\r\n      return null; // target wasn't important (a pet probably)\r\n    }\r\n\r\n    const targetId = event.targetID;\r\n    if (!targetId) {\r\n      debug && console.log(`${event.ability.name} ${event.type} to target without ID @${this.owner.formatTimestamp(event.timestamp, 1)}... HoT will not be tracked.`);\r\n      return null;\r\n    } else {\r\n      if (event.type === EventType.Heal) {\r\n        healDebug && console.log(`${event.ability.name} ${event.type} to ID ${targetId} @${this.owner.formatTimestamp(event.timestamp, 1)}`);\r\n      } else {\r\n        applyRemoveDebug && console.log(`${event.ability.name} ${event.type} to ID ${targetId} @${this.owner.formatTimestamp(event.timestamp, 1)}`);\r\n      }\r\n    }\r\n\r\n    return target;\r\n  }\r\n\r\n  // validates that event is for one of the tracked hots and that HoT tracking involving it is in the expected state\r\n  _validateHot(event) {\r\n    const spellId = event.ability.guid;\r\n    const targetId = event.targetID;\r\n    if (!(this.hotInfo[spellId])) {\r\n      return false; // we only care about the listed HoTs\r\n    }\r\n\r\n    if ([EventType.RemoveBuff, EventType.RefreshBuff, EventType.Heal].includes(event.type) &&\r\n      (!this.hots[targetId] || !this.hots[targetId][spellId])) {\r\n      debug && console.warn(`${event.ability.name} ${event.type} on target ID ${targetId} @${this.owner.formatTimestamp(event.timestamp)} but there's no record of that HoT being added...`);\r\n      return false;\r\n    } else if (event.type === EventType.ApplyBuff && this.hots[targetId] && this.hots[targetId][spellId]) {\r\n      debug && console.warn(`${event.ability.name} ${event.type} on target ID ${targetId} @${this.owner.formatTimestamp(event.timestamp)} but that HoT is recorded as already added...`);\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  /*{\r\n   *  [SPELLS.NAME.id]:{\r\n   *    duration: xxxx,                 //base duration\r\n   *    tickPeriod: xxxx,               //rate at which it heals\r\n   *    effectOnCrit: function,         //if anything special happens on crit\r\n   *    maxDuration: function,          //how to caculate max non-pandmic duration (return the max duration)\r\n   *    bouncy: boolean,                //if a hot will bounce to another target on any event\r\n   *    durationConditions: functions,  //function that will fire if the duration of the hot depend on event info\r\n   *    id: SPELLS.NAME.id,             //store again for dynamic listeners\r\n   *  },\r\n   * }\r\n   */\r\n  _generateHotInfo() { // must be generated dynamically because it reads from traits\r\n  }\r\n}\r\n\r\nexport default HotTracker;\r\n"],"sourceRoot":""}